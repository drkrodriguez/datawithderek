<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Derek Rodriguez">
<meta name="dcterms.date" content="2024-11-13">

<title>Discovering Impact of COVID-19 on Thai Tourism Economy – data with derek</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<script src="../../site_libs/plotly-binding-4.10.4/plotly.js"></script>

<script src="../../site_libs/typedarray-0.1/typedarray.min.js"></script>

<script src="../../site_libs/jquery-3.5.1/jquery.min.js"></script>

<link href="../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">

<script src="../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

<link href="../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">

<script src="../../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">data with derek</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/drkrodriguez/datawithderek"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/fjsrodriguez/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Discovering Impact of COVID-19 on Thai Tourism Economy</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">R</div>
                <div class="quarto-category">Geospatial Analysis</div>
                <div class="quarto-category">Thailand</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Derek Rodriguez </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">November 13, 2024</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">November 13, 2024</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>This is my second project (take home exercise) for our course Geospatial Analysis. This exercise makes use of techniques in geospatial analysis to discover clustering and hotspots in order to analyze Thai tourism data befor and after Covid.</p>
<section id="a.-getting-started" class="level1">
<h1>A. Getting Started</h1>
<section id="a.1-background" class="level2">
<h2 class="anchored" data-anchor-id="a.1-background">A.1 Background</h2>
<p>Tourism is a major industry in Thailand as it made up to 20% of their gross domestic product pre-pandemic. However, like the rest of the world, the industry has taken a hit with COVID-19 in 2020, and has slowly been recovering since 2021. Recent reports are stating that Thailand is already, but still, at 80% of its peak level in 2019.</p>
<p>While we speak about the industry in general, the state of tourism within Thailand, and their recovery status are not the same. For example, tourism revenues have been focused on Bangkok, Phuket and Chonburi pre-pandemic.</p>
<p>We are interested in understanding the state of tourism across Thailand with regards to its spatial distribution and time and space distribution– both in absolutes and in terms of the trend with respect to the pandemic.</p>
</section>
<section id="a.2-objectives" class="level2">
<h2 class="anchored" data-anchor-id="a.2-objectives">A.2 Objectives</h2>
<p>For this study, we want to understand the state of tourism in Thailand at a provincial level, and answer the following questions:</p>
<ol type="1">
<li><p>Are the key tourism indicators in Thailand (at a province level) independent from space and from space and time?</p></li>
<li><p>If tourism or any tourism indicators are not independent, what are the clusters, outliers and emerging hotspots and coldspots?</p></li>
</ol>
<p>We will use the appropriate packages in R in order to perform the different analysis (spatial and otherwise) to support our answers to the above questions.</p>
</section>
<section id="a.3-data-sources" class="level2">
<h2 class="anchored" data-anchor-id="a.3-data-sources">A.3 Data Sources</h2>
<p>The following data sources are used for this analysis:</p>
<ul>
<li><p><a href="https://www.kaggle.com/datasets/thaweewatboy/thailand-domestic-tourism-statistics">Thailand Domestic Tourism Statistics</a> from Kaggle covering the years 2019-2023 and are at province and month level across 8 indicators:</p>
<ol type="1">
<li><p><code>no_tourist_all</code> - total number of domestic tourists</p></li>
<li><p><code>no_tourist_foreign</code> - number of foreign tourists</p></li>
<li><p><code>no_tourist_occupied</code> - number of hotel rooms occupied</p></li>
<li><p><code>no_tourist_thai</code> - number of Thai tourists</p></li>
<li><p><code>occupancy_rate</code> - the percentage of occupied travel accommodations (hotel rooms)</p></li>
<li><p><code>revenue_all</code> - total tourism revenue, in M-THB (appears as net profit in the raw data)</p></li>
<li><p><code>revenue_foreign</code> - revenue generated by foreign tourists, in M-THB (appears as net profit in the raw data)</p></li>
<li><p><code>revenue_thai</code> - revenue generated by Thai tourists, in M-THB (appears as net profit in the raw data)</p></li>
</ol></li>
<li><p><a href="https://data.humdata.org/dataset/cod-ab-tha?">Thailand-Subnational Administrative Boundaries</a> from Human Data Exchange in shapefile format</p></li>
</ul>
</section>
<section id="a.4-importing-and-launching-r-packages" class="level2">
<h2 class="anchored" data-anchor-id="a.4-importing-and-launching-r-packages">A.4 Importing and Launching R Packages</h2>
<p>For this study, the following R packages will be used. A description of the packages and the code, using <code>p_load()</code> of the <strong>pacman</strong> package, to import them is given below.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Package Description</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Import Code</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>The loaded packages include:</p>
<ul>
<li><p><strong>sf -</strong> package for importing, managing and processing vector-based geospatial data</p></li>
<li><p><strong>tidyverse -</strong> collection of packages for performing data importation, wrangling and visualization</p></li>
<li><p><strong>tmap -</strong> package with functions for plotting cartographic quality maps</p></li>
<li><p><strong>sfdep</strong> - for handling spatial data</p></li>
<li><p><strong>coorplot, ggpubr, heatmaply, factoextra</strong> - packages for multivariate data visualization and analysis</p></li>
<li><p><strong>cluster, ClustGeo, NbClust</strong> - packages for performing cluster analysis</p></li>
</ul>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(sf, tmap, spdep, sfdep, tidyverse,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               ggpubr, heatmaply, factoextra,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               NbClust, cluster, ClustGeo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>As we will be performing simulations in the analysis later, it is good practice to define a random seed to be used so that results are consistent for viewers of this report, and the results can be reproduced.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="b.-data-loading-and-preparation" class="level1">
<h1>B. Data Loading and Preparation</h1>
<section id="b.1.-thailand-subnational-boundary-provincial-level" class="level2">
<h2 class="anchored" data-anchor-id="b.1.-thailand-subnational-boundary-provincial-level">B.1. Thailand Subnational Boundary, Provincial Level</h2>
<p>We load the Thailand subnational administrative boundary shapefile into an R dataframe using <code>st_read()</code> from the sf package. We need to analyze at the provincial level so we will be using the files suffixed by “1”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>thai_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn=</span><span class="st">"data/geospatial"</span>, </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">layer=</span><span class="st">"tha_admbnda_adm1_rtsd_20220121"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `tha_admbnda_adm1_rtsd_20220121' from data source 
  `C:\drkrodriguez\datawithderek\posts\thai-tourism-covid\data\geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 77 features and 16 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 97.34336 ymin: 5.613038 xmax: 105.637 ymax: 20.46507
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
<p>The output states that the object is of multipolygon geometry type containing 77 features (provinces, records) across 16 fields. (columns) We can check the contents of the object using a number of methods. For the code chunk below, we use <code>glimpse()</code> which lists the columns, gives the data type and the first elements.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(thai_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 77
Columns: 17
$ Shape_Leng &lt;dbl&gt; 2.417227, 1.695100, 1.251111, 1.884945, 3.041716, 1.739908,…
$ Shape_Area &lt;dbl&gt; 0.13133873, 0.07926199, 0.05323766, 0.12698345, 0.21393797,…
$ ADM1_EN    &lt;chr&gt; "Bangkok", "Samut Prakan", "Nonthaburi", "Pathum Thani", "P…
$ ADM1_TH    &lt;chr&gt; "กรุงเทพมหานคร", "สมุทรปราการ", "นนทบุรี", "ปทุมธานี", "พระนครศรีอ…
$ ADM1_PCODE &lt;chr&gt; "TH10", "TH11", "TH12", "TH13", "TH14", "TH15", "TH16", "TH…
$ ADM1_REF   &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
$ ADM1ALT1EN &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
$ ADM1ALT2EN &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
$ ADM1ALT1TH &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
$ ADM1ALT2TH &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
$ ADM0_EN    &lt;chr&gt; "Thailand", "Thailand", "Thailand", "Thailand", "Thailand",…
$ ADM0_TH    &lt;chr&gt; "ประเทศไทย", "ประเทศไทย", "ประเทศไทย", "ประเทศไทย", "ประเทศ…
$ ADM0_PCODE &lt;chr&gt; "TH", "TH", "TH", "TH", "TH", "TH", "TH", "TH", "TH", "TH",…
$ date       &lt;date&gt; 2019-02-18, 2019-02-18, 2019-02-18, 2019-02-18, 2019-02-18…
$ validOn    &lt;date&gt; 2022-01-22, 2022-01-22, 2022-01-22, 2022-01-22, 2022-01-22…
$ validTo    &lt;date&gt; -001-11-30, -001-11-30, -001-11-30, -001-11-30, -001-11-30…
$ geometry   &lt;MULTIPOLYGON [°]&gt; MULTIPOLYGON (((100.6139 13..., MULTIPOLYGON (…</code></pre>
</div>
</div>
<p>For clarity, we can clean up this dataframe by:</p>
<ol type="1">
<li>Keeping only relevant columns: The province name and code, geometry</li>
<li>Renaming the columns: change ADM1 to Province</li>
</ol>
<p>The following code chunk executes these steps by using <code>select()</code> for the first step and <code>rename()</code> for the second step. We again use <code>glimpse()</code> to give a preview of the dataset’s columns.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>thai_sf <span class="ot">&lt;-</span> thai_sf <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ADM1_EN, ADM1_PCODE, geometry) <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Province =</span> ADM1_EN, <span class="at">ProvCode =</span> ADM1_PCODE)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(thai_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 77
Columns: 3
$ Province &lt;chr&gt; "Bangkok", "Samut Prakan", "Nonthaburi", "Pathum Thani", "Phr…
$ ProvCode &lt;chr&gt; "TH10", "TH11", "TH12", "TH13", "TH14", "TH15", "TH16", "TH17…
$ geometry &lt;MULTIPOLYGON [°]&gt; MULTIPOLYGON (((100.6139 13..., MULTIPOLYGON (((…</code></pre>
</div>
</div>
<p>We can check if there are any missing values by using <code>is.na()</code> and then check across each column using <code>colSums()</code> from <strong>Base R</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(thai_sf))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Province ProvCode geometry 
       0        0        0 </code></pre>
</div>
</div>
<p>The output shows that there are no missing values for any of the retained columns.</p>
<p>Finally, we can quickly check if the object depicts Thailand properly by producing a quick map using <code>qtm()</code> from <strong>tmap</strong> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qtm</span>(thai_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="b.2.-thailand-tourism-data-by-province-jan-2019---feb-2023" class="level2">
<h2 class="anchored" data-anchor-id="b.2.-thailand-tourism-data-by-province-jan-2019---feb-2023">B.2. Thailand Tourism Data by Province, Jan 2019 - Feb 2023</h2>
<p>The code chunk below loads the tourism statistics data into a dataframe <code>tourism</code>. We use read_csv() to import the data from the file.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>tourism <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/thailand_domestic_tourism_2019_2023.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 30800 Columns: 7
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (5): province_thai, province_eng, region_thai, region_eng, variable
dbl  (1): value
date (1): date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<p>We can check the contents by using the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>tourism</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 30,800 × 7
   date       province_thai province_eng   region_thai region_eng variable value
   &lt;date&gt;     &lt;chr&gt;         &lt;chr&gt;          &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;    &lt;dbl&gt;
 1 2019-01-01 กรุงเทพมหานคร  Bangkok        ภาคกลาง     central    occupan…  93.4
 2 2019-01-01 ลพบุรี          Lopburi        ภาคกลาง     central    occupan…  61.3
 3 2019-01-01 พระนครศรีอยุธยา Phra Nakhon S… ภาคกลาง     central    occupan…  73.4
 4 2019-01-01 สระบุรี         Saraburi       ภาคกลาง     central    occupan…  67.3
 5 2019-01-01 ชัยนาท         Chainat        ภาคกลาง     central    occupan…  79.3
 6 2019-01-01 นครปฐม        Nakhon Pathom  ภาคกลาง     central    occupan…  71.7
 7 2019-01-01 สิงห์บุรี         Sing Buri      ภาคกลาง     central    occupan…  64.6
 8 2019-01-01 อ่างทอง        Ang Thong      ภาคกลาง     central    occupan…  71.2
 9 2019-01-01 นนทบุรี         Nonthaburi     ภาคกลาง     central    occupan…  75.1
10 2019-01-01 ปทุมธานี        Pathum Thani   ภาคกลาง     central    occupan…  60.8
# ℹ 30,790 more rows</code></pre>
</div>
</div>
<p>The imported data contains 7 fields and 30,800 records at a province and month level.</p>
<p>Before we analyze the dataset, let use remove unnecessary columns and rename the column names, similar to the previous dataset, using the code chunk below. (by using <code>select()</code> and <code>rename()</code>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>tourism <span class="ot">&lt;-</span> tourism <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date, province_eng, region_eng, variable, value) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Date =</span> date, <span class="at">Province =</span> province_eng, <span class="at">Region =</span> region_eng, <span class="at">Indicator =</span> variable, <span class="at">Value =</span> value)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tourism)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  Date       Province                 Region  Indicator      Value
  &lt;date&gt;     &lt;chr&gt;                    &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
1 2019-01-01 Bangkok                  central occupancy_rate  93.4
2 2019-01-01 Lopburi                  central occupancy_rate  61.3
3 2019-01-01 Phra Nakhon Si Ayutthaya central occupancy_rate  73.4
4 2019-01-01 Saraburi                 central occupancy_rate  67.3
5 2019-01-01 Chainat                  central occupancy_rate  79.3
6 2019-01-01 Nakhon Pathom            central occupancy_rate  71.7</code></pre>
</div>
</div>
<p>We have kept only five of the columns which provides the date, the English descriptions for the location (province and region) as well as the (potential) tourism indicator and its value.</p>
<p>We can also check for any missing values across these five columns using the code below. (using <code>is.na()</code> and <code>colSums()</code>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(tourism))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Date  Province    Region Indicator     Value 
        0         0         0         0         0 </code></pre>
</div>
</div>
<p>Each province will be repeated across multiple dates and across multiple indicators. Let us first doublecheck the different values in <code>Indicator</code>. We use <code>unique()</code> in the code chunk below to achieve this.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(tourism<span class="sc">$</span>Indicator)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "occupancy_rate"      "no_tourist_occupied" "no_tourist_all"     
[4] "no_tourist_thai"     "no_tourist_foreign"  "net_profit_all"     
[7] "net_profit_thai"     "net_profit_foreign" </code></pre>
</div>
</div>
<p>We are aware that the ‘net_profit’ indicators are actually revenue so it is better to update them now to avoid misunderstanding later. We use <code>recode()</code> from <strong>dplyr</strong> to replace instances with alternative values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>tourism <span class="ot">&lt;-</span> tourism <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Indicator =</span> <span class="fu">recode</span>(Indicator,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"net_profit_all"</span> <span class="ot">=</span> <span class="st">"revenue_all"</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"net_profit_thai"</span> <span class="ot">=</span> <span class="st">"revenue_thai"</span>,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"net_profit_foreign"</span> <span class="ot">=</span> <span class="st">"revenue_foreign"</span>))</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(tourism<span class="sc">$</span>Indicator)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "occupancy_rate"      "no_tourist_occupied" "no_tourist_all"     
[4] "no_tourist_thai"     "no_tourist_foreign"  "revenue_all"        
[7] "revenue_thai"        "revenue_foreign"    </code></pre>
</div>
</div>
<p>We will not define which indicators to use until we perform some EDA (Exploratory Data Analysis) in the next section.</p>
<p>Before we move to the next section, we will also introduce some columns into the dataset to make filtering and other analysis easier. For now, we will do this by adding columns for the months and years based on the <code>Date</code> column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>tourism <span class="ot">&lt;-</span> tourism <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">year</span>(Date)) <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">MonthNum =</span> <span class="fu">month</span>(Date)) <span class="sc">%&gt;%</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">month</span>(Date, <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">abbr =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">MonthYear =</span> <span class="fu">format</span>(<span class="fu">ymd</span>(Date), <span class="st">"%Y-%m"</span>))</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tourism)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 9
  Date       Province      Region Indicator Value  Year MonthNum Month MonthYear
  &lt;date&gt;     &lt;chr&gt;         &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;ord&gt; &lt;chr&gt;    
1 2019-01-01 Bangkok       centr… occupanc…  93.4  2019        1 Jan   2019-01  
2 2019-01-01 Lopburi       centr… occupanc…  61.3  2019        1 Jan   2019-01  
3 2019-01-01 Phra Nakhon … centr… occupanc…  73.4  2019        1 Jan   2019-01  
4 2019-01-01 Saraburi      centr… occupanc…  67.3  2019        1 Jan   2019-01  
5 2019-01-01 Chainat       centr… occupanc…  79.3  2019        1 Jan   2019-01  
6 2019-01-01 Nakhon Pathom centr… occupanc…  71.7  2019        1 Jan   2019-01  </code></pre>
</div>
</div>
</section>
</section>
<section id="c.-exploratory-data-analysis" class="level1">
<h1>C. Exploratory Data Analysis</h1>
<p>We will use data analysis and visualization techniques to investigate the data before we perform the main analyses required. This allows us to get some insights on things like variables to use, provinces to focus on, deep dives to perform etc.</p>
<section id="c.1-tourism-revenue" class="level2">
<h2 class="anchored" data-anchor-id="c.1-tourism-revenue">C.1 Tourism Revenue</h2>
<p>We first look at tourism revenue which is currently reported in million Thai baht. We will use a constant rate of 34.784 THB per USD based on 2023 exchange rates to scale down the numbers and transform it into something more recognizable for most of the readers.</p>
<p>We first create a plot for the monthly tourism revenue in total and by foreign and local tourists. The code below selects the relevant data and prepares the line plot using <code>ggplot()</code>. Finally, we use <code>ggplotly()</code> to render it as an interactive chart so we can easily examine the resulting chart.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset the data to just the required indicators</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>aggregated_data <span class="ot">&lt;-</span> tourism <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"revenue_all"</span>, <span class="st">"revenue_thai"</span>, <span class="st">"revenue_foreign"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(MonthYear, Indicator) <span class="sc">%&gt;%</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TotalValue =</span> <span class="fu">sum</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fl">34.784</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'MonthYear'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the line chart</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(aggregated_data, <span class="fu">aes</span>(<span class="at">x =</span> MonthYear, <span class="at">y =</span> TotalValue, <span class="at">color =</span> Indicator, <span class="at">group =</span> Indicator)) <span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Thai Tourism Revenue by Month"</span>,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Million USD"</span>,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Month-Year"</span>) <span class="sc">+</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"revenue_all"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"revenue_thai"</span> <span class="ot">=</span> <span class="st">"green"</span>, <span class="st">"revenue_foreign"</span> <span class="ot">=</span> <span class="st">"red"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the ggplot chart to an interactive plotly chart</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>interactive_plot <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(p)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the interactive plot</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>interactive_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-1b4ff99564eb6e8884a5" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-1b4ff99564eb6e8884a5">{"x":{"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],"y":[7404.551230450782,6647.8832221711136,6703.2313707451704,6542.9162833486662,5924.8769549218032,5597.7394779208835,5853.1212626494944,5719.1021734130636,5590.7831186752528,6943.156911223552,7034.1904323827048,8462.5459981600743,7768.1741605335783,4298.9020814167434,1371.7907658693653,287.93065777368906,309.05330036798529,534.57940432382713,1057.0221941122354,1167.5252989880405,1224.1723206071758,1412.4350275988961,1728.836246550138,1624.0257014719411,692.0434682612696,885.64799908003681,1073.6260924563019,823.55134544618215,121.80197792088317,108.84717111315548,98.459061637534504,97.671630634774601,211.62431002759891,366.84308877644895,884.24994250229997,1574.175482980681,1646.5139144434224,1634.9675137994479,1748.4636614535418,1941.9123735050598,2073.9104185832566,2326.4224931002759,2804.0196642134315,2887.9240455381787,2882.8449862005523,3114.4181232750689,3764.117985280589,4354.7766214351432,4709.7947332106714,4707.1294273229078],"text":["MonthYear: 2019-01<br />TotalValue: 7404.55123<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2019-02<br />TotalValue: 6647.88322<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2019-03<br />TotalValue: 6703.23137<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2019-04<br />TotalValue: 6542.91628<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2019-05<br />TotalValue: 5924.87695<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2019-06<br />TotalValue: 5597.73948<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2019-07<br />TotalValue: 5853.12126<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2019-08<br />TotalValue: 5719.10217<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2019-09<br />TotalValue: 5590.78312<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2019-10<br />TotalValue: 6943.15691<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2019-11<br />TotalValue: 7034.19043<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2019-12<br />TotalValue: 8462.54600<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2020-01<br />TotalValue: 7768.17416<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2020-02<br />TotalValue: 4298.90208<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2020-03<br />TotalValue: 1371.79077<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2020-04<br />TotalValue:  287.93066<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2020-05<br />TotalValue:  309.05330<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2020-06<br />TotalValue:  534.57940<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2020-07<br />TotalValue: 1057.02219<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2020-08<br />TotalValue: 1167.52530<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2020-09<br />TotalValue: 1224.17232<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2020-10<br />TotalValue: 1412.43503<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2020-11<br />TotalValue: 1728.83625<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2020-12<br />TotalValue: 1624.02570<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2021-01<br />TotalValue:  692.04347<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2021-02<br />TotalValue:  885.64800<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2021-03<br />TotalValue: 1073.62609<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2021-04<br />TotalValue:  823.55135<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2021-05<br />TotalValue:  121.80198<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2021-06<br />TotalValue:  108.84717<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2021-07<br />TotalValue:   98.45906<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2021-08<br />TotalValue:   97.67163<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2021-09<br />TotalValue:  211.62431<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2021-10<br />TotalValue:  366.84309<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2021-11<br />TotalValue:  884.24994<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2021-12<br />TotalValue: 1574.17548<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2022-01<br />TotalValue: 1646.51391<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2022-02<br />TotalValue: 1634.96751<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2022-03<br />TotalValue: 1748.46366<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2022-04<br />TotalValue: 1941.91237<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2022-05<br />TotalValue: 2073.91042<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2022-06<br />TotalValue: 2326.42249<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2022-07<br />TotalValue: 2804.01966<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2022-08<br />TotalValue: 2887.92405<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2022-09<br />TotalValue: 2882.84499<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2022-10<br />TotalValue: 3114.41812<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2022-11<br />TotalValue: 3764.11799<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2022-12<br />TotalValue: 4354.77662<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2023-01<br />TotalValue: 4709.79473<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2023-02<br />TotalValue: 4707.12943<br />Indicator: revenue_all<br />Indicator: revenue_all"],"type":"scatter","mode":"lines","line":{"width":3.7795275590551185,"color":"rgba(0,0,255,1)","dash":"solid"},"hoveron":"points","name":"revenue_all","legendgroup":"revenue_all","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],"y":[4685.9329001839924,4135.6022884084641,4199.4776333946647,3953.8747700091994,3467.407428702852,3359.7820837166514,3187.2038868445261,3208.5867065317389,3013.3710901563941,4274.3468261269554,4290.9047263109478,5548.2782313707448,5069.7171113155482,2400.3360740570379,530.58187672493102,273.56974471021164,247.55031048758053,72.96745630174793,50.979185832566699,39.686350045998161,35.180542778288867,56.119480220791168,76.595273689052433,60.760982060717581,34.322102115915364,36.586649034038643,41.728380864765413,37.670193192272308,13.527771389144435,11.155416283348666,35.797493100275993,34.476483440662378,53.51454691812328,68.854645814167441,109.29766559337627,241.05077046918126,274.12143514259435,269.19129484820604,337.67738040478383,388.30755519779206,641.59067387304515,902.72711591536347,1298.5545078196872,1373.9265179392823,1366.063132474701,1516.3089351425945,2016.1033808647655,2351.7746665133395,2687.9188707451699,2909.1277598896045],"text":["MonthYear: 2019-01<br />TotalValue: 4685.93290<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2019-02<br />TotalValue: 4135.60229<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2019-03<br />TotalValue: 4199.47763<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2019-04<br />TotalValue: 3953.87477<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2019-05<br />TotalValue: 3467.40743<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2019-06<br />TotalValue: 3359.78208<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2019-07<br />TotalValue: 3187.20389<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2019-08<br />TotalValue: 3208.58671<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2019-09<br />TotalValue: 3013.37109<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2019-10<br />TotalValue: 4274.34683<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2019-11<br />TotalValue: 4290.90473<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2019-12<br />TotalValue: 5548.27823<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2020-01<br />TotalValue: 5069.71711<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2020-02<br />TotalValue: 2400.33607<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2020-03<br />TotalValue:  530.58188<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2020-04<br />TotalValue:  273.56974<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2020-05<br />TotalValue:  247.55031<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2020-06<br />TotalValue:   72.96746<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2020-07<br />TotalValue:   50.97919<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2020-08<br />TotalValue:   39.68635<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2020-09<br />TotalValue:   35.18054<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2020-10<br />TotalValue:   56.11948<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2020-11<br />TotalValue:   76.59527<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2020-12<br />TotalValue:   60.76098<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2021-01<br />TotalValue:   34.32210<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2021-02<br />TotalValue:   36.58665<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2021-03<br />TotalValue:   41.72838<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2021-04<br />TotalValue:   37.67019<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2021-05<br />TotalValue:   13.52777<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2021-06<br />TotalValue:   11.15542<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2021-07<br />TotalValue:   35.79749<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2021-08<br />TotalValue:   34.47648<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2021-09<br />TotalValue:   53.51455<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2021-10<br />TotalValue:   68.85465<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2021-11<br />TotalValue:  109.29767<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2021-12<br />TotalValue:  241.05077<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2022-01<br />TotalValue:  274.12144<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2022-02<br />TotalValue:  269.19129<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2022-03<br />TotalValue:  337.67738<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2022-04<br />TotalValue:  388.30756<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2022-05<br />TotalValue:  641.59067<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2022-06<br />TotalValue:  902.72712<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2022-07<br />TotalValue: 1298.55451<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2022-08<br />TotalValue: 1373.92652<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2022-09<br />TotalValue: 1366.06313<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2022-10<br />TotalValue: 1516.30894<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2022-11<br />TotalValue: 2016.10338<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2022-12<br />TotalValue: 2351.77467<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2023-01<br />TotalValue: 2687.91887<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2023-02<br />TotalValue: 2909.12776<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign"],"type":"scatter","mode":"lines","line":{"width":3.7795275590551185,"color":"rgba(255,0,0,1)","dash":"solid"},"hoveron":"points","name":"revenue_foreign","legendgroup":"revenue_foreign","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],"y":[2718.6183302667891,2512.2809337626495,2503.7537373505061,2589.0415133394667,2457.4695262189512,2237.9573942042321,2665.9173758049678,2510.5154668813248,2577.4120285188592,2668.8100850965961,2743.285706071757,2914.2677667893286,2698.4570492180314,1898.5660073597057,841.20888914443424,14.360913063477462,61.50298988040479,461.6119480220791,1006.0430082796688,1127.8389489420424,1188.9917778288868,1356.3155473781051,1652.2409728610858,1563.2647194112235,657.72136614535418,849.06135004599821,1031.8977115915363,785.88115225390982,108.27420653173874,97.691754829806811,62.661568537258511,63.195147194112231,158.10947562097516,297.98815547378103,774.95227690892364,1333.1247125114996,1372.3924793008282,1365.7762189512418,1410.7862810487582,1553.6048183072678,1432.3197447102116,1423.6953771849126,1505.4651563937443,1513.9975275988961,1516.7818537258509,1598.1091881324746,1748.0146044158234,2003.0019549218032,2021.8758624655013,1798.0016674333028],"text":["MonthYear: 2019-01<br />TotalValue: 2718.61833<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2019-02<br />TotalValue: 2512.28093<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2019-03<br />TotalValue: 2503.75374<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2019-04<br />TotalValue: 2589.04151<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2019-05<br />TotalValue: 2457.46953<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2019-06<br />TotalValue: 2237.95739<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2019-07<br />TotalValue: 2665.91738<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2019-08<br />TotalValue: 2510.51547<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2019-09<br />TotalValue: 2577.41203<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2019-10<br />TotalValue: 2668.81009<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2019-11<br />TotalValue: 2743.28571<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2019-12<br />TotalValue: 2914.26777<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2020-01<br />TotalValue: 2698.45705<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2020-02<br />TotalValue: 1898.56601<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2020-03<br />TotalValue:  841.20889<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2020-04<br />TotalValue:   14.36091<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2020-05<br />TotalValue:   61.50299<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2020-06<br />TotalValue:  461.61195<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2020-07<br />TotalValue: 1006.04301<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2020-08<br />TotalValue: 1127.83895<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2020-09<br />TotalValue: 1188.99178<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2020-10<br />TotalValue: 1356.31555<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2020-11<br />TotalValue: 1652.24097<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2020-12<br />TotalValue: 1563.26472<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2021-01<br />TotalValue:  657.72137<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2021-02<br />TotalValue:  849.06135<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2021-03<br />TotalValue: 1031.89771<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2021-04<br />TotalValue:  785.88115<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2021-05<br />TotalValue:  108.27421<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2021-06<br />TotalValue:   97.69175<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2021-07<br />TotalValue:   62.66157<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2021-08<br />TotalValue:   63.19515<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2021-09<br />TotalValue:  158.10948<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2021-10<br />TotalValue:  297.98816<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2021-11<br />TotalValue:  774.95228<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2021-12<br />TotalValue: 1333.12471<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2022-01<br />TotalValue: 1372.39248<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2022-02<br />TotalValue: 1365.77622<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2022-03<br />TotalValue: 1410.78628<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2022-04<br />TotalValue: 1553.60482<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2022-05<br />TotalValue: 1432.31974<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2022-06<br />TotalValue: 1423.69538<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2022-07<br />TotalValue: 1505.46516<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2022-08<br />TotalValue: 1513.99753<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2022-09<br />TotalValue: 1516.78185<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2022-10<br />TotalValue: 1598.10919<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2022-11<br />TotalValue: 1748.01460<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2022-12<br />TotalValue: 2003.00195<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2023-01<br />TotalValue: 2021.87586<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2023-02<br />TotalValue: 1798.00167<br />Indicator: revenue_thai<br />Indicator: revenue_thai"],"type":"scatter","mode":"lines","line":{"width":3.7795275590551185,"color":"rgba(0,255,0,1)","dash":"solid"},"hoveron":"points","name":"revenue_thai","legendgroup":"revenue_thai","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":69.406392694063939,"l":48.949771689497723},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Thai Tourism Revenue by Month","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,50.600000000000001],"tickmode":"array","ticktext":["2019-01","2019-02","2019-03","2019-04","2019-05","2019-06","2019-07","2019-08","2019-09","2019-10","2019-11","2019-12","2020-01","2020-02","2020-03","2020-04","2020-05","2020-06","2020-07","2020-08","2020-09","2020-10","2020-11","2020-12","2021-01","2021-02","2021-03","2021-04","2021-05","2021-06","2021-07","2021-08","2021-09","2021-10","2021-11","2021-12","2022-01","2022-02","2022-03","2022-04","2022-05","2022-06","2022-07","2022-08","2022-09","2022-10","2022-11","2022-12","2023-01","2023-02"],"tickvals":[1,2,3,3.9999999999999996,5,6,7,8,9,10,11,12,13.000000000000002,14,15,16,17,18,19,20,21,22,23,24,25,26,27,27.999999999999996,29.000000000000004,30.000000000000004,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],"categoryorder":"array","categoryarray":["2019-01","2019-02","2019-03","2019-04","2019-05","2019-06","2019-07","2019-08","2019-09","2019-10","2019-11","2019-12","2020-01","2020-02","2020-03","2020-04","2020-05","2020-06","2020-07","2020-08","2020-09","2020-10","2020-11","2020-12","2021-01","2021-02","2021-03","2021-04","2021-05","2021-06","2021-07","2021-08","2021-09","2021-10","2021-11","2021-12","2022-01","2022-02","2022-03","2022-04","2022-05","2022-06","2022-07","2022-08","2022-09","2022-10","2022-11","2022-12","2023-01","2023-02"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-90,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Month-Year","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-411.41411281048767,8885.1155272539108],"tickmode":"array","ticktext":["0","2000","4000","6000","8000"],"tickvals":[0,1999.9999999999993,4000,6000,8000],"categoryorder":"array","categoryarray":["0","2000","4000","6000","8000"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Million USD","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Indicator","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"157984a501c4c":{"x":{},"y":{},"colour":{},"type":"scatter"}},"cur_data":"157984a501c4c","visdat":{"157984a501c4c":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>The resulting chart is consistent with the expectation on the impact and recovery from the pandemic. We can view the above chart as a timeline:</p>
<ol type="1">
<li><p>Up to (mid)January 2020: Pre-covid. No travel restrictions have been set yet. (Jan 2019 - Jan 2020, 13 months)</p></li>
<li><p>Feb 2020 to November 2021: Covid. Various lockdown measures in place. All foreign non-essential travel is banned. There is some local tourist activity, but another set of measures in May 2021 again prevents non-essential movement (Feb 2020 - Oct 2021, 22 months)</p></li>
<li><p>November 2021 onwards: Post-Covid. Travel restrictions have been eased or lifted and tourism revenues have been recovering (Nov 2021 - Feb 2023, 16 months)</p></li>
</ol>
<p>Pre- and post-covid, we see that foreign tourists contribute more to the overall revenue, and their contribution has a large amount of variance. Local tourists during the same period have contributed a more stable amount month-on-month.</p>
<p>We can code the three periods mentioned above into the tourism dataset for convenience. We use the <code>ifelse()</code> function to do this based on the cutoff dates mentioned above.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>tourism<span class="sc">$</span>Period <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(tourism<span class="sc">$</span>Date <span class="sc">&lt;</span> <span class="fu">as.Date</span>(<span class="st">"2020-02-01"</span>), <span class="st">"Pre-Covid"</span>,</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">ifelse</span>(tourism<span class="sc">$</span>Date <span class="sc">&gt;</span> <span class="fu">as.Date</span>(<span class="st">"2021-10-01"</span>), <span class="st">"Post-Covid"</span>, <span class="st">"Covid"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can next check the tourism revenue at the province level. As plotting all 77 provinces across all the periods will not produce readable charts, we will focus on top 20 provinces for the different periods. We will also take the average monthly revenue rather than the total since each period has a different number of months.</p>
<p>We prepare a new dataframe that summarizes the indicators for each province in <code>tourism</code>. Aside from the average revenue per period, we will also compute for the average number of visitors as well as the average spend per visitor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>tourism_period <span class="ot">&lt;-</span> tourism <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Province) <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">PreCovid_Revenue_total =</span> <span class="fu">sum</span>(Value[Period <span class="sc">==</span> <span class="st">"Pre-Covid"</span> <span class="sc">&amp;</span> Indicator <span class="sc">==</span> <span class="st">"revenue_all"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">13</span><span class="sc">/</span><span class="fl">34.784</span>,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Covid_Revenue_total =</span> <span class="fu">sum</span>(Value[Period <span class="sc">==</span> <span class="st">"Covid"</span> <span class="sc">&amp;</span> Indicator <span class="sc">==</span> <span class="st">"revenue_all"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">22</span><span class="sc">/</span><span class="fl">34.784</span>,</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">PostCovid_Revenue_total =</span> <span class="fu">sum</span>(Value[Period <span class="sc">==</span> <span class="st">"Post-Covid"</span> <span class="sc">&amp;</span> Indicator <span class="sc">==</span> <span class="st">"revenue_all"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">16</span><span class="sc">/</span><span class="fl">34.784</span>,</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">PreCovid_Revenue_foreign =</span> <span class="fu">sum</span>(Value[Period <span class="sc">==</span> <span class="st">"Pre-Covid"</span> <span class="sc">&amp;</span> Indicator <span class="sc">==</span> <span class="st">"revenue_foreign"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">13</span><span class="sc">/</span><span class="fl">34.784</span>,</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Covid_Revenue_foreign =</span> <span class="fu">sum</span>(Value[Period <span class="sc">==</span> <span class="st">"Covid"</span> <span class="sc">&amp;</span> Indicator <span class="sc">==</span> <span class="st">"revenue_foreign"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">22</span><span class="sc">/</span><span class="fl">34.784</span>,</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">PostCovid_Revenue_foreign =</span> <span class="fu">sum</span>(Value[Period <span class="sc">==</span> <span class="st">"Post-Covid"</span> <span class="sc">&amp;</span> Indicator <span class="sc">==</span> <span class="st">"revenue_foreign"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">16</span><span class="sc">/</span><span class="fl">34.784</span>,</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">PreCovid_Revenue_thai =</span> <span class="fu">sum</span>(Value[Period <span class="sc">==</span> <span class="st">"Pre-Covid"</span> <span class="sc">&amp;</span> Indicator <span class="sc">==</span> <span class="st">"revenue_thai"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">13</span><span class="sc">/</span><span class="fl">34.784</span>,</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Covid_Revenue_thai =</span> <span class="fu">sum</span>(Value[Period <span class="sc">==</span> <span class="st">"Covid"</span> <span class="sc">&amp;</span> Indicator <span class="sc">==</span> <span class="st">"revenue_thai"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">22</span><span class="sc">/</span><span class="fl">34.784</span>,</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">PostCovid_Revenue_thai =</span> <span class="fu">sum</span>(Value[Period <span class="sc">==</span> <span class="st">"Post-Covid"</span> <span class="sc">&amp;</span> Indicator <span class="sc">==</span> <span class="st">"revenue_thai"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">16</span><span class="sc">/</span><span class="fl">34.784</span>,</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">PreCovid_tourists_total =</span> <span class="fu">sum</span>(Value[Period <span class="sc">==</span> <span class="st">"Pre-Covid"</span> <span class="sc">&amp;</span> Indicator <span class="sc">==</span> <span class="st">"no_tourist_all"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">13</span>,</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">Covid_tourists_total =</span> <span class="fu">sum</span>(Value[Period <span class="sc">==</span> <span class="st">"Covid"</span> <span class="sc">&amp;</span> Indicator <span class="sc">==</span> <span class="st">"no_tourist_all"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">22</span>,</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">PostCovid_tourists_total =</span> <span class="fu">sum</span>(Value[Period <span class="sc">==</span> <span class="st">"Post-Covid"</span> <span class="sc">&amp;</span> Indicator <span class="sc">==</span> <span class="st">"no_tourist_all"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">16</span>,</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">PreCovid_tourists_foreign =</span> <span class="fu">sum</span>(Value[Period <span class="sc">==</span> <span class="st">"Pre-Covid"</span> <span class="sc">&amp;</span> Indicator <span class="sc">==</span> <span class="st">"no_tourist_foreign"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">13</span>,</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">Covid_tourists_foreign =</span> <span class="fu">sum</span>(Value[Period <span class="sc">==</span> <span class="st">"Covid"</span> <span class="sc">&amp;</span> Indicator <span class="sc">==</span> <span class="st">"no_tourist_foreign"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">22</span>,</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">PostCovid_tourists_foreign =</span> <span class="fu">sum</span>(Value[Period <span class="sc">==</span> <span class="st">"Post-Covid"</span> <span class="sc">&amp;</span> Indicator <span class="sc">==</span> <span class="st">"no_tourist_foreign"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">16</span>,</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">PreCovid_tourists_thai =</span> <span class="fu">sum</span>(Value[Period <span class="sc">==</span> <span class="st">"Pre-Covid"</span> <span class="sc">&amp;</span> Indicator <span class="sc">==</span> <span class="st">"no_tourist_thai"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">13</span>,</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">Covid_tourists_thai =</span> <span class="fu">sum</span>(Value[Period <span class="sc">==</span> <span class="st">"Covid"</span> <span class="sc">&amp;</span> Indicator <span class="sc">==</span> <span class="st">"no_tourist_thai"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">22</span>,</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">PostCovid_tourists_thai =</span> <span class="fu">sum</span>(Value[Period <span class="sc">==</span> <span class="st">"Post-Covid"</span> <span class="sc">&amp;</span> Indicator <span class="sc">==</span> <span class="st">"no_tourist_thai"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">16</span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PreCovidSpend_total =</span> PreCovid_Revenue_total <span class="sc">/</span> PreCovid_tourists_total <span class="sc">*</span> <span class="dv">1000000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">CovidSpend_total =</span> Covid_Revenue_total <span class="sc">/</span> Covid_tourists_total <span class="sc">*</span> <span class="dv">1000000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PostCovidSpend_total =</span> PostCovid_Revenue_total <span class="sc">/</span> PostCovid_tourists_total <span class="sc">*</span> <span class="dv">1000000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PreCovidSpend_foreign =</span> PreCovid_Revenue_foreign <span class="sc">/</span> PreCovid_tourists_foreign <span class="sc">*</span> <span class="dv">1000000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">CovidSpend_foreign =</span> Covid_Revenue_foreign <span class="sc">/</span> Covid_tourists_foreign <span class="sc">*</span> <span class="dv">1000000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PostCovidSpend_foreign =</span> PostCovid_Revenue_foreign <span class="sc">/</span> PostCovid_tourists_foreign <span class="sc">*</span> <span class="dv">1000000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PreCovidSpend_thai =</span> PreCovid_Revenue_thai <span class="sc">/</span> PreCovid_tourists_thai <span class="sc">*</span> <span class="dv">1000000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">CovidSpend_thai =</span> Covid_Revenue_thai <span class="sc">/</span> Covid_tourists_thai <span class="sc">*</span> <span class="dv">1000000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PostCovidSpend_thai =</span> PostCovid_Revenue_thai <span class="sc">/</span> PostCovid_tourists_thai <span class="sc">*</span> <span class="dv">1000000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>With the summarized dataframe prepared, we can now prepare a few visualizations to look at the provinces with regards to the average monthly tourism revenue.</p>
<p>First, let us try using a scatterplot to see both the average revenue pre-Covid (x-axis) and post-Covid. (y-axis) Provinces with the highest pre-Covid revenue will appear the rightmost, while those that have the highest post-Covid revenue will appear the rightmost.</p>
<p>The code below uses the <strong>plotly</strong> package to produce an interactive scatterplot of the pre- and post-covid average monthly revenue for all tourists. With the interactive chart, the province names will be visible by hovering over and the user can zoom in by creating a selection in the chart.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> tourism_period,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="sc">~</span>PreCovid_Revenue_total,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="sc">~</span>PostCovid_Revenue_total,</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'scatter'</span>,</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">'markers'</span>,</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">text =</span> <span class="sc">~</span>Province,</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">hoverinfo =</span> <span class="st">'text'</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'Monthly Pre- and Post-Covid Revenue - M-USD'</span>,</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Average PreCovid Revenue'</span>),</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Average PostCovid Revenue'</span>)</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-8f836166d559454ecd73" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-8f836166d559454ecd73">{"x":{"visdat":{"1579871747f1d":["function () ","plotlyVisDat"]},"cur_data":"1579871747f1d","attrs":{"1579871747f1d":{"x":{},"y":{},"mode":"markers","text":{},"hoverinfo":"text","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Monthly Pre- and Post-Covid Revenue - M-USD","xaxis":{"domain":[0,1],"automargin":true,"title":"Average PreCovid Revenue"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Average PostCovid Revenue"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1.044489951171184,2.5197040195315261,2556.4730247328571,2.6724046422758474,11.151103955841768,11.902576781544123,3.1590342155544548,5.2664133819262604,21.48308683037294,269.26214970631946,71.583884721534218,670.93798651900067,17.791822942466915,2.9335990021937586,4.0035206284056333,67.755687849409114,43.709242976434787,275.459981600736,10.34779474205647,4.1098692590757908,11.296949083575118,13.632461432311938,13.053747080885996,2.8713466845941547,8.6995347109192558,18.72797395796476,14.557488854291982,5.2922210034675539,60.2045591253273,9.5790062628264092,37.98855353478168,6.7776298563442081,7.5188857830302176,0.97896468756634358,13.790889710565425,11.334698535135518,8.3651413558842265,2.4849400254759044,127.95832301323333,7.977628971764207,3.4318608024909771,18.914730910763573,73.571889816715029,3.6102584742764137,21.067577489208126,45.59271282994834,4.3052066378883307,1117.5767594296228,12.803521512985634,101.51112801641781,10.68908782110254,10.739464652183145,87.236461503078345,3.459415469535065,16.235448658976718,5.9936929445899096,17.150436097940698,5.8733237208973179,7.5416194890665915,15.773697898237916,24.101244604061989,2.0773476753237565,5.4028377326445405,163.03200852735122,9.3096737668954788,13.680803729389288,230.30038125398065,7.6925951808081523,17.726054419361684,23.879414054207061,47.801155261481853,19.73535577807657,27.015537647724859,3.3044370532870992,5.5109997523175993,7.8912276201259646,1.9771247611633997],"y":[0.58723119825206993,1.6386485165593376,858.20608972516106,2.1284390811867526,13.347156738730451,12.486739592916283,2.3871607635694572,3.4923923355565778,12.764597228610855,153.95663235970562,84.04591550712972,252.66478481485743,7.3711692157313715,1.5597508912143514,3.1448726425942963,52.469598091076357,22.504132647194112,38.613874195032203,10.388900068997241,3.3636513914443422,7.8382661568537264,10.650155243790248,10.388864132934682,1.3875991835326587,5.3983153173873051,8.3257568134774598,8.7321038408463671,5.2909922665593383,24.850110683072678,9.8594540593376276,13.210509860855566,7.8337202449402037,1.9001552437902485,0.48770627299908004,8.1421774379024843,7.7217075379484825,5.0943321642134309,1.2514015064397426,15.858853927092916,1.7753133624655013,4.4658823022079117,16.295207566697332,57.593325954461825,2.5439138684452622,15.010098033578659,28.739273085326587,5.631935660073597,482.14744925827972,6.680064828656854,78.676636528288881,2.7050871090156394,4.9792828599356032,26.574790133394668,1.9619832394204233,8.2059998850045996,4.9440834866605332,8.1585822504599808,1.8567624482520702,10.573270037948483,14.527692329806808,13.754258423413065,1.7665629312327507,2.3747987580496783,36.995044416973322,5.1224521331646731,11.93388123850046,63.938017479300832,3.6437011269549222,11.831104099586016,8.6348967916283357,21.415701184452622,7.6614966651333951,14.651851425942962,2.952884228380865,3.0800080496780131,4.8531113442962281,0.97726325321987118],"mode":"markers","text":["Amnat Charoen","Ang Thong","Bangkok","Bueng Kan","Buriram","Chachoengsao","Chainat","Chaiyaphum","Chanthaburi","Chiang Mai","Chiang Rai","Chonburi","Chumphon","Kalasin","Kamphaeng Phet","Kanchanaburi","Khon Kaen","Krabi","Lampang","Lamphun","Loei","Lopburi","Mae Hong Son","Maha Sarakham","Mukdahan","Nakhon Nayok","Nakhon Pathom","Nakhon Phanom","Nakhon Ratchasima","Nakhon Sawan","Nakhon Si Thammarat","Nan","Narathiwat","Nong Bua Lamphu","Nong Khai","Nonthaburi","Pathum Thani","Pattani","Phang Nga","Phatthalung","Phayao","Phetchabun","Phetchaburi","Phichit","Phitsanulok","Phra Nakhon Si Ayutthaya","Phrae","Phuket","Prachinburi","Prachuap Khiri Khan","Ranong","Ratchaburi","Rayong","Roi Et","Sa Kaeo","Sakon Nakhon","Samut Prakan","Samut Sakhon","Samut Songkhram","Saraburi","Satun","Sing Buri","Sisaket","Songkhla","Sukhothai","Suphan Buri","Surat Thani","Surin","Tak","Trang","Trat","Ubon Ratchathani","Udon Thani","Uthai Thani","Uttaradit","Yala","Yasothon"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Baed on the plot, we see that Bangkok, Phuket and Chonburi have consistently been the top 3 highest revenue generating before and after the pandemic. When we look further down the list, we see some shifts for some of the provinces.</p>
<p>To aid the reader, we recreate the chart with those top 3 provinces excluded using the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">filter</span>(tourism_period, <span class="sc">!</span>(Province <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Bangkok"</span>, <span class="st">"Phuket"</span>, <span class="st">"Chonburi"</span>))),</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="sc">~</span>PreCovid_Revenue_total,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="sc">~</span>PostCovid_Revenue_total,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'scatter'</span>,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">'markers'</span>,</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">text =</span> <span class="sc">~</span>Province,</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">hoverinfo =</span> <span class="st">'text'</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'Monthly Pre- and Post-Covid Revenue - M-USD, exc Top 3 Provinces'</span>,</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Average PreCovid Revenue'</span>),</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Average PostCovid Revenue'</span>)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-0d7db73d03839427d3b7" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-0d7db73d03839427d3b7">{"x":{"visdat":{"1579866ed29ac":["function () ","plotlyVisDat"]},"cur_data":"1579866ed29ac","attrs":{"1579866ed29ac":{"x":{},"y":{},"mode":"markers","text":{},"hoverinfo":"text","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Monthly Pre- and Post-Covid Revenue - M-USD, exc Top 3 Provinces","xaxis":{"domain":[0,1],"automargin":true,"title":"Average PreCovid Revenue"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Average PostCovid Revenue"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1.044489951171184,2.5197040195315261,2.6724046422758474,11.151103955841768,11.902576781544123,3.1590342155544548,5.2664133819262604,21.48308683037294,269.26214970631946,71.583884721534218,17.791822942466915,2.9335990021937586,4.0035206284056333,67.755687849409114,43.709242976434787,275.459981600736,10.34779474205647,4.1098692590757908,11.296949083575118,13.632461432311938,13.053747080885996,2.8713466845941547,8.6995347109192558,18.72797395796476,14.557488854291982,5.2922210034675539,60.2045591253273,9.5790062628264092,37.98855353478168,6.7776298563442081,7.5188857830302176,0.97896468756634358,13.790889710565425,11.334698535135518,8.3651413558842265,2.4849400254759044,127.95832301323333,7.977628971764207,3.4318608024909771,18.914730910763573,73.571889816715029,3.6102584742764137,21.067577489208126,45.59271282994834,4.3052066378883307,12.803521512985634,101.51112801641781,10.68908782110254,10.739464652183145,87.236461503078345,3.459415469535065,16.235448658976718,5.9936929445899096,17.150436097940698,5.8733237208973179,7.5416194890665915,15.773697898237916,24.101244604061989,2.0773476753237565,5.4028377326445405,163.03200852735122,9.3096737668954788,13.680803729389288,230.30038125398065,7.6925951808081523,17.726054419361684,23.879414054207061,47.801155261481853,19.73535577807657,27.015537647724859,3.3044370532870992,5.5109997523175993,7.8912276201259646,1.9771247611633997],"y":[0.58723119825206993,1.6386485165593376,2.1284390811867526,13.347156738730451,12.486739592916283,2.3871607635694572,3.4923923355565778,12.764597228610855,153.95663235970562,84.04591550712972,7.3711692157313715,1.5597508912143514,3.1448726425942963,52.469598091076357,22.504132647194112,38.613874195032203,10.388900068997241,3.3636513914443422,7.8382661568537264,10.650155243790248,10.388864132934682,1.3875991835326587,5.3983153173873051,8.3257568134774598,8.7321038408463671,5.2909922665593383,24.850110683072678,9.8594540593376276,13.210509860855566,7.8337202449402037,1.9001552437902485,0.48770627299908004,8.1421774379024843,7.7217075379484825,5.0943321642134309,1.2514015064397426,15.858853927092916,1.7753133624655013,4.4658823022079117,16.295207566697332,57.593325954461825,2.5439138684452622,15.010098033578659,28.739273085326587,5.631935660073597,6.680064828656854,78.676636528288881,2.7050871090156394,4.9792828599356032,26.574790133394668,1.9619832394204233,8.2059998850045996,4.9440834866605332,8.1585822504599808,1.8567624482520702,10.573270037948483,14.527692329806808,13.754258423413065,1.7665629312327507,2.3747987580496783,36.995044416973322,5.1224521331646731,11.93388123850046,63.938017479300832,3.6437011269549222,11.831104099586016,8.6348967916283357,21.415701184452622,7.6614966651333951,14.651851425942962,2.952884228380865,3.0800080496780131,4.8531113442962281,0.97726325321987118],"mode":"markers","text":["Amnat Charoen","Ang Thong","Bueng Kan","Buriram","Chachoengsao","Chainat","Chaiyaphum","Chanthaburi","Chiang Mai","Chiang Rai","Chumphon","Kalasin","Kamphaeng Phet","Kanchanaburi","Khon Kaen","Krabi","Lampang","Lamphun","Loei","Lopburi","Mae Hong Son","Maha Sarakham","Mukdahan","Nakhon Nayok","Nakhon Pathom","Nakhon Phanom","Nakhon Ratchasima","Nakhon Sawan","Nakhon Si Thammarat","Nan","Narathiwat","Nong Bua Lamphu","Nong Khai","Nonthaburi","Pathum Thani","Pattani","Phang Nga","Phatthalung","Phayao","Phetchabun","Phetchaburi","Phichit","Phitsanulok","Phra Nakhon Si Ayutthaya","Phrae","Prachinburi","Prachuap Khiri Khan","Ranong","Ratchaburi","Rayong","Roi Et","Sa Kaeo","Sakon Nakhon","Samut Prakan","Samut Sakhon","Samut Songkhram","Saraburi","Satun","Sing Buri","Sisaket","Songkhla","Sukhothai","Suphan Buri","Surat Thani","Surin","Tak","Trang","Trat","Ubon Ratchathani","Udon Thani","Uthai Thani","Uttaradit","Yala","Yasothon"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Some key observations from the above charts are:</p>
<ol type="1">
<li><p>Chiang Mai has moved from top 5 to top 4. A large reason for this is a drop from Krabi. Pre-covid, Krabi was top 4, but has dropped to at least top 10.</p></li>
<li><p>Chiang Rai and Prachuap Khiri Khan have risen to top 5 and 6. These provinces were top 9 or lower before.</p></li>
<li><p>Songkhla and Phang Nga were in the top 10 pre-Covid but are also showing a drop in ranking post-Covid</p></li>
</ol>
<p>We can do the same chart for just the revenue from foreign tourists using the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> tourism_period,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="sc">~</span>PreCovid_Revenue_foreign,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="sc">~</span>PostCovid_Revenue_foreign,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'scatter'</span>,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">'markers'</span>,</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">text =</span> <span class="sc">~</span>Province,</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">hoverinfo =</span> <span class="st">'text'</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'Monthly Pre- and Post-Covid Revenue from Foreign Tourists - M-USD'</span>,</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Average PreCovid Revenue'</span>),</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Average PostCovid Revenue'</span>)</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-c2e3fede5c798441fdae" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-c2e3fede5c798441fdae">{"x":{"visdat":{"157983a5e154e":["function () ","plotlyVisDat"]},"cur_data":"157983a5e154e","attrs":{"157983a5e154e":{"x":{},"y":{},"mode":"markers","text":{},"hoverinfo":"text","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Monthly Pre- and Post-Covid Revenue from Foreign Tourists - M-USD","xaxis":{"domain":[0,1],"automargin":true,"title":"Average PreCovid Revenue"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Average PostCovid Revenue"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[0.067913629608661819,0.090448305144717286,1637.080045644328,0.030783384049253414,0.67451436557922306,0.14261641072818626,0.019748248531597196,0.056038143089661034,1.3089572570943317,105.21198959733917,16.250154801500248,539.51772698322839,1.738288160781261,0.024126919538603072,0.1258536197013658,5.6028854999646169,0.7734546387375274,183.90878211025407,1.3336812681338903,0.19757094331611352,0.30447243648715594,0.11077153067723447,5.0192617295308191,0.044295343570872552,0.9131298209610077,0.23978752388366006,0.63320447951312708,0.28839519496143234,2.0591253272946006,0.20232556082372088,0.88230220791168346,0.2463113013940981,5.2460901563937439,0.0054622815087396505,2.1374327719198924,1.5785551270256881,3.2074207416318732,0.024480751539169204,111.79240234236785,0.11103690467765906,0.10537559266860094,0.22222861085556578,11.473776625858044,0.025475904040761443,1.9882262401811621,14.526594897742553,0.48609882527775811,997.76931038143096,1.1632890453612623,33.005073066308114,0.94097197650555531,0.37366870709786992,12.156517585450429,0.033282322553251718,1.7894168848630669,0.039253237562805181,8.5486032481777663,0.018730981529969572,0.20323225532517164,0.47440025475904046,2.2531800651050879,0.012804295520486873,0.13624743471799589,84.752782004104446,2.8830010261128018,0.14642010473427217,190.02479035453968,0.29836883447739021,0.43835361970136583,4.2558691883093909,20.516506262826407,1.5335521194536836,1.7201984997523179,0.039253237562805181,0.038501344561602154,6.6535675111457087,0.096286533154058454],"y":[0.0094511844526218945,0.0040248390064397425,530.12615354760806,0.06781135004599817,0.1289565604875805,0.013871320147194112,0.0038990627874885006,0.020699172033118676,0.059851512189512422,29.94455065547378,8.7938060602575909,80.037139920653175,0.023807641444342227,0.051981514489420427,0.078466392594296233,0.73340113270469187,0.31429680312787495,5.5133466536338549,0.29481945722171116,0.16769563592456302,0.10107017594296229,0.02546070032198712,1.2816956071757131,0.041488184222631098,0.32960556577736894,0.021597573597056118,0.1002616145354186,0.31638109475620979,0.59546055657773689,0.064792720791168365,0.048747268859245629,0.19700149494020239,0.64271647884084637,0.0026233325666973322,1.9033894894204231,0.2804989362925483,0.17495472056117756,0.014949402023919044,8.8717873160073601,0.0049771446642134318,0.22044977575896965,0.32877903633854644,0.54971394894204229,0.0058396101655933761,0.32150198367065319,2.1058532658693654,0.046860625574977006,441.68152023919049,0.024202938132474702,4.2323338316467343,0.048621492640294389,0.22695420308187675,0.92776132704691816,0.031731543238270474,0.053293180772769094,0.052340875114995397,1.5241382532198713,0.0179859993100276,0.13756324747010121,0.049897222861085555,0.37053674103035877,0.017680542778288868,0.014949402023919044,14.144074862005521,0.57188649954001836,0.071207307957681695,24.458982578196874,0.049735510579576821,0.16631209751609938,0.085833285418583261,1.019344382474701,0.041398344066237353,1.5545760982060719,0.0017249310027598896,0.024059193882244711,1.1422277483900645,0.0044920078196872123],"mode":"markers","text":["Amnat Charoen","Ang Thong","Bangkok","Bueng Kan","Buriram","Chachoengsao","Chainat","Chaiyaphum","Chanthaburi","Chiang Mai","Chiang Rai","Chonburi","Chumphon","Kalasin","Kamphaeng Phet","Kanchanaburi","Khon Kaen","Krabi","Lampang","Lamphun","Loei","Lopburi","Mae Hong Son","Maha Sarakham","Mukdahan","Nakhon Nayok","Nakhon Pathom","Nakhon Phanom","Nakhon Ratchasima","Nakhon Sawan","Nakhon Si Thammarat","Nan","Narathiwat","Nong Bua Lamphu","Nong Khai","Nonthaburi","Pathum Thani","Pattani","Phang Nga","Phatthalung","Phayao","Phetchabun","Phetchaburi","Phichit","Phitsanulok","Phra Nakhon Si Ayutthaya","Phrae","Phuket","Prachinburi","Prachuap Khiri Khan","Ranong","Ratchaburi","Rayong","Roi Et","Sa Kaeo","Sakon Nakhon","Samut Prakan","Samut Sakhon","Samut Songkhram","Saraburi","Satun","Sing Buri","Sisaket","Songkhla","Sukhothai","Suphan Buri","Surat Thani","Surin","Tak","Trang","Trat","Ubon Ratchathani","Udon Thani","Uthai Thani","Uttaradit","Yala","Yasothon"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>The top 3 provinces are the same for both, but there are differences further down the list.</p>
<p>We can also show these numbers graphically in a map. Before we do this, let us add one set of measures in tourism_period to indicate the recovery rate. This will be the ratio of the post-covid and pre-covid measures and will indicate how much of the pre-covid level has been achieved. (on average)</p>
<p>We perform this using the code chunk below. We do this for all sets of measures across revenue, number of tourists and the average spending.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>tourism_period <span class="ot">&lt;-</span> tourism_period <span class="sc">%&gt;%</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Revenue_total_recovery =</span> PostCovid_Revenue_total <span class="sc">/</span> PreCovid_Revenue_total) <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Revenue_foreign_recovery =</span> PostCovid_Revenue_foreign <span class="sc">/</span> PreCovid_Revenue_foreign) <span class="sc">%&gt;%</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Revenue_thai_recovery =</span> PostCovid_Revenue_thai <span class="sc">/</span> PreCovid_Revenue_thai) <span class="sc">%&gt;%</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Tourists_total_recovery =</span> PostCovid_tourists_total <span class="sc">/</span> PreCovid_tourists_total) <span class="sc">%&gt;%</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Tourists_foreign_recovery =</span> PostCovid_tourists_foreign <span class="sc">/</span> PreCovid_tourists_foreign) <span class="sc">%&gt;%</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Tourists_thai_recovery =</span> PostCovid_tourists_thai <span class="sc">/</span> PreCovid_tourists_thai) <span class="sc">%&gt;%</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Spend_total_recovery =</span> PostCovidSpend_total <span class="sc">/</span> PreCovidSpend_total) <span class="sc">%&gt;%</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Spend_foreign_recovery =</span> PostCovidSpend_foreign <span class="sc">/</span> PreCovidSpend_foreign) <span class="sc">%&gt;%</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Spend_thai_recovery =</span> PostCovidSpend_thai <span class="sc">/</span> PreCovidSpend_thai)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We need to include all the indicators into the sf dataframe. This means merging the <code>tourism_period</code> and the <code>thai_sf</code> dataframes. Let us first check that the naming is the same for both dataframes by checking which values do not have a match. We use the code below which uses <code>left_join()</code> to match and then <code>filter()</code> to check those that do not have matches.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify mismatched Province names in tourism_period</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>mismatched_values <span class="ot">&lt;-</span> tourism_period <span class="sc">%&gt;%</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(thai_sf, <span class="at">by =</span> <span class="st">"Province"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(ProvCode)) <span class="sc">%&gt;%</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Province)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>mismatched_tourism <span class="ot">&lt;-</span> mismatched_values<span class="sc">$</span>Province</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify mismatched Province names in thai_sf</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>mismatched_values <span class="ot">&lt;-</span> thai_sf <span class="sc">%&gt;%</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(tourism_period, <span class="at">by =</span> <span class="st">"Province"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(Covid_Revenue_total)) <span class="sc">%&gt;%</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Province)</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>mismatched_thai <span class="ot">&lt;-</span> mismatched_values<span class="sc">$</span>Province</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the mismatched values</span></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">mismatched_in_tourism_period =</span> mismatched_tourism,</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">mismatched_in_thai_sf =</span> mismatched_thai</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$mismatched_in_tourism_period
[1] "Buriram"         "Chainat"         "Chonburi"        "Lopburi"        
[5] "Nong Bua Lamphu" "Phang Nga"       "Prachinburi"     "Sisaket"        

$mismatched_in_thai_sf
[1] "Lop Buri"         "Chai Nat"         "Chon Buri"        "Prachin Buri"    
[5] "Buri Ram"         "Si Sa Ket"        "Nong Bua Lam Phu" "Phangnga"        </code></pre>
</div>
</div>
<p>We see that there are 8 mismatched province names for each of the dataframes. We need to standardize these namings to ensure that the indicators are mapped to the correct province. We will opt to keep the descriptions from tourism_period which gives more compact naming. We use <code>recode()</code> in the code chunk below to accomplish this in a new dataframe.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>thaitourism_sf <span class="ot">&lt;-</span> thai_sf <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Province =</span> <span class="fu">recode</span>(Province,</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"Lop Buri"</span> <span class="ot">=</span> <span class="st">"Lopburi"</span>,</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"Chai Nat"</span> <span class="ot">=</span> <span class="st">"Chainat"</span>,</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"Chon Buri"</span> <span class="ot">=</span> <span class="st">"Chonburi"</span>,</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"Prachin Buri"</span> <span class="ot">=</span> <span class="st">"Prachinburi"</span>,</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"Buri Ram"</span> <span class="ot">=</span> <span class="st">"Buriram"</span>,</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"Si Sa Ket"</span> <span class="ot">=</span> <span class="st">"Sisaket"</span>,</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"Nong Bua Lam Phu"</span> <span class="ot">=</span> <span class="st">"Nong Bua Lamphu"</span>,</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"Phangnga"</span> <span class="ot">=</span> <span class="st">"Phang Nga"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can now use <code>leftjoin()</code> in the codechunk below to merge the two datasets.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>thaitourism_sf <span class="ot">&lt;-</span> <span class="fu">left_join</span>(thaitourism_sf, tourism_period,</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">by=</span><span class="fu">c</span>(<span class="st">"Province"</span><span class="ot">=</span><span class="st">"Province"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The code chunk below confirms that the new object is still an sf dataframe.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(thaitourism_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "sf"         "data.frame"</code></pre>
</div>
</div>
<p>We can use the tmap package to produce side-by side maps of Thailand with the average monthly tourism revenue before and after covid using the code chunk below. Given the wide range of values, we will use quantiles for the data classes. We also include the recovery rate of each of the provinces as a third map.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(thaitourism_sf) <span class="sc">+</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="fu">c</span>(<span class="st">"PreCovid_Revenue_total"</span>, <span class="st">"PostCovid_Revenue_total"</span>, <span class="st">"Revenue_total_recovery"</span>),</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"quantile"</span>,</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="fu">list</span>(<span class="st">"viridis"</span>, <span class="st">"viridis"</span>, <span class="st">"RdYlGn"</span>),</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="fu">c</span>(<span class="st">"Monthly Revenue - M-USD"</span>, <span class="st">"Monthly Revenue - M-USD"</span>, <span class="st">"Post vs Pre"</span>)) <span class="sc">+</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">title =</span> <span class="fu">c</span>(<span class="st">"Pre Covid"</span>, <span class="st">"Post Covid"</span>, <span class="st">"Recovery Rate"</span>),</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">title.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"top"</span>),</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>),</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">bg.color =</span> <span class="st">"grey90"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="1440"></p>
</figure>
</div>
</div>
</div>
<p>As also seen in the scatterplot, we also see some change in rankings with the maps. For example, some provinces previously in the top 20% have moved down to the next 20%. (e.g., Khon Kaen and Phang Nga)</p>
<p>If we focus on the third map, we also see what seems like a cluster of provinces in the south which are lagging with regards to their recovery on the average tourism revenue. We will watch out for these once we conduct our cluster analyses.</p>
</section>
<section id="c.2-number-of-tourists" class="level2">
<h2 class="anchored" data-anchor-id="c.2-number-of-tourists">C.2 Number of Tourists</h2>
<p>The next measure we can look at is the number of tourists. We produce a similar line chart as we did for tourism revenue with the code chunk below. We display the number of tourists in thousands.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset the data to just the required indicators</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>aggregated_data <span class="ot">&lt;-</span> tourism <span class="sc">%&gt;%</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"no_tourist_all"</span>, <span class="st">"no_tourist_thai"</span>, <span class="st">"no_tourist_foreign"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(MonthYear, Indicator) <span class="sc">%&gt;%</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TotalValue =</span> <span class="fu">sum</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'MonthYear'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the line chart</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(aggregated_data, <span class="fu">aes</span>(<span class="at">x =</span> MonthYear, <span class="at">y =</span> TotalValue, <span class="at">color =</span> Indicator, <span class="at">group =</span> Indicator)) <span class="sc">+</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Thailand Number of Tourists by Month"</span>,</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Tourists, Thousands"</span>,</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Month-Year"</span>) <span class="sc">+</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"no_tourist_all"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"no_tourist_thai"</span> <span class="ot">=</span> <span class="st">"green"</span>, <span class="st">"no_tourist_foreign"</span> <span class="ot">=</span> <span class="st">"red"</span>))</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the ggplot chart to an interactive plotly chart</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>interactive_plot <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(p)</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the interactive plot</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>interactive_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-a77ad32f6b82562872f5" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-a77ad32f6b82562872f5">{"x":{"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],"y":[28609.150000000001,25658.219000000001,25892.424999999999,26216.826000000001,24572.348000000002,22914.989000000001,24064.028999999999,23045.161,22694.598999999998,26728.810000000001,27194.342000000001,29551.092000000001,27877.866999999998,18051.790000000001,7221.3549999999996,304.12200000000001,735.77599999999995,4536.076,10052.505999999999,11234.164000000001,11436.148999999999,13811.576999999999,16441.773000000001,15326.957,6849.933,8929.9130000000005,10876.096,7052.9089999999997,1411.184,1324.47,912.423,936.04100000000005,2257.4319999999998,4696.7539999999999,11457.055,16332.360000000001,15864.753000000001,15720.389999999999,15929.546,17362.379000000001,16893.646000000001,17123.179,18767.727999999999,18959.299999999999,19107.814999999999,20454.535,22691.134999999998,25967.362000000001,26798.237000000001,25516.021000000001],"text":["MonthYear: 2019-01<br />TotalValue: 28609.150<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2019-02<br />TotalValue: 25658.219<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2019-03<br />TotalValue: 25892.425<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2019-04<br />TotalValue: 26216.826<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2019-05<br />TotalValue: 24572.348<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2019-06<br />TotalValue: 22914.989<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2019-07<br />TotalValue: 24064.029<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2019-08<br />TotalValue: 23045.161<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2019-09<br />TotalValue: 22694.599<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2019-10<br />TotalValue: 26728.810<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2019-11<br />TotalValue: 27194.342<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2019-12<br />TotalValue: 29551.092<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2020-01<br />TotalValue: 27877.867<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2020-02<br />TotalValue: 18051.790<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2020-03<br />TotalValue:  7221.355<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2020-04<br />TotalValue:   304.122<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2020-05<br />TotalValue:   735.776<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2020-06<br />TotalValue:  4536.076<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2020-07<br />TotalValue: 10052.506<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2020-08<br />TotalValue: 11234.164<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2020-09<br />TotalValue: 11436.149<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2020-10<br />TotalValue: 13811.577<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2020-11<br />TotalValue: 16441.773<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2020-12<br />TotalValue: 15326.957<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2021-01<br />TotalValue:  6849.933<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2021-02<br />TotalValue:  8929.913<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2021-03<br />TotalValue: 10876.096<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2021-04<br />TotalValue:  7052.909<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2021-05<br />TotalValue:  1411.184<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2021-06<br />TotalValue:  1324.470<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2021-07<br />TotalValue:   912.423<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2021-08<br />TotalValue:   936.041<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2021-09<br />TotalValue:  2257.432<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2021-10<br />TotalValue:  4696.754<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2021-11<br />TotalValue: 11457.055<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2021-12<br />TotalValue: 16332.360<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2022-01<br />TotalValue: 15864.753<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2022-02<br />TotalValue: 15720.390<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2022-03<br />TotalValue: 15929.546<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2022-04<br />TotalValue: 17362.379<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2022-05<br />TotalValue: 16893.646<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2022-06<br />TotalValue: 17123.179<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2022-07<br />TotalValue: 18767.728<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2022-08<br />TotalValue: 18959.300<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2022-09<br />TotalValue: 19107.815<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2022-10<br />TotalValue: 20454.535<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2022-11<br />TotalValue: 22691.135<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2022-12<br />TotalValue: 25967.362<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2023-01<br />TotalValue: 26798.237<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2023-02<br />TotalValue: 25516.021<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all"],"type":"scatter","mode":"lines","line":{"width":3.7795275590551185,"color":"rgba(0,0,255,1)","dash":"solid"},"hoveron":"points","name":"no_tourist_all","legendgroup":"no_tourist_all","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],"y":[7907.1220000000003,7189.1859999999997,7139.4709999999995,6947.5799999999999,6078.7700000000004,5881.2979999999998,5894.5110000000004,5912.9470000000001,5584.0770000000002,5792.3209999999999,5887.634,7178.1130000000003,7976.1639999999998,3882.7939999999999,936.78099999999995,173.887,163.83000000000001,113.89,85.204999999999998,81.361000000000004,86.134,91.793000000000006,127.98399999999999,95.468000000000004,59.945,63.887,76.543999999999997,70.338999999999999,37.390999999999998,32.435000000000002,43.174999999999997,42.475999999999999,59.094999999999999,100.527,185.73599999999999,382.73899999999998,457.83800000000002,455.709,554.11699999999996,641.21699999999998,1041.7929999999999,1414.232,2030.1300000000001,2244.8119999999999,2279.0650000000001,2758.8029999999999,3637.924,4353.607,4978.6090000000004,5399.116],"text":["MonthYear: 2019-01<br />TotalValue:  7907.122<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2019-02<br />TotalValue:  7189.186<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2019-03<br />TotalValue:  7139.471<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2019-04<br />TotalValue:  6947.580<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2019-05<br />TotalValue:  6078.770<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2019-06<br />TotalValue:  5881.298<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2019-07<br />TotalValue:  5894.511<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2019-08<br />TotalValue:  5912.947<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2019-09<br />TotalValue:  5584.077<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2019-10<br />TotalValue:  5792.321<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2019-11<br />TotalValue:  5887.634<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2019-12<br />TotalValue:  7178.113<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2020-01<br />TotalValue:  7976.164<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2020-02<br />TotalValue:  3882.794<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2020-03<br />TotalValue:   936.781<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2020-04<br />TotalValue:   173.887<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2020-05<br />TotalValue:   163.830<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2020-06<br />TotalValue:   113.890<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2020-07<br />TotalValue:    85.205<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2020-08<br />TotalValue:    81.361<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2020-09<br />TotalValue:    86.134<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2020-10<br />TotalValue:    91.793<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2020-11<br />TotalValue:   127.984<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2020-12<br />TotalValue:    95.468<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2021-01<br />TotalValue:    59.945<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2021-02<br />TotalValue:    63.887<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2021-03<br />TotalValue:    76.544<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2021-04<br />TotalValue:    70.339<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2021-05<br />TotalValue:    37.391<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2021-06<br />TotalValue:    32.435<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2021-07<br />TotalValue:    43.175<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2021-08<br />TotalValue:    42.476<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2021-09<br />TotalValue:    59.095<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2021-10<br />TotalValue:   100.527<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2021-11<br />TotalValue:   185.736<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2021-12<br />TotalValue:   382.739<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2022-01<br />TotalValue:   457.838<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2022-02<br />TotalValue:   455.709<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2022-03<br />TotalValue:   554.117<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2022-04<br />TotalValue:   641.217<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2022-05<br />TotalValue:  1041.793<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2022-06<br />TotalValue:  1414.232<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2022-07<br />TotalValue:  2030.130<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2022-08<br />TotalValue:  2244.812<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2022-09<br />TotalValue:  2279.065<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2022-10<br />TotalValue:  2758.803<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2022-11<br />TotalValue:  3637.924<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2022-12<br />TotalValue:  4353.607<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2023-01<br />TotalValue:  4978.609<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2023-02<br />TotalValue:  5399.116<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign"],"type":"scatter","mode":"lines","line":{"width":3.7795275590551185,"color":"rgba(255,0,0,1)","dash":"solid"},"hoveron":"points","name":"no_tourist_foreign","legendgroup":"no_tourist_foreign","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],"y":[20702.027999999998,18469.032999999999,18752.954000000002,19269.245999999999,18493.578000000001,17033.690999999999,18169.518,17132.214,17110.522000000001,20936.489000000001,21306.707999999999,22372.978999999999,19901.703000000001,14168.995999999999,6284.5739999999996,130.23500000000001,571.94600000000003,4422.1859999999997,9967.3009999999995,11152.803,11350.014999999999,13719.784,16313.789000000001,15231.489,6789.9880000000003,8866.0259999999998,10799.552,6982.5699999999997,1373.7929999999999,1292.0350000000001,869.24800000000005,893.56500000000005,2198.337,4596.2269999999999,11271.319,15949.620999999999,15406.915000000001,15264.681,15375.429,16721.162,15851.852999999999,15708.947,16737.598000000002,16714.488000000001,16828.75,17695.732,19053.210999999999,21613.755000000001,21819.628000000001,20116.904999999999],"text":["MonthYear: 2019-01<br />TotalValue: 20702.028<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2019-02<br />TotalValue: 18469.033<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2019-03<br />TotalValue: 18752.954<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2019-04<br />TotalValue: 19269.246<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2019-05<br />TotalValue: 18493.578<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2019-06<br />TotalValue: 17033.691<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2019-07<br />TotalValue: 18169.518<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2019-08<br />TotalValue: 17132.214<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2019-09<br />TotalValue: 17110.522<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2019-10<br />TotalValue: 20936.489<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2019-11<br />TotalValue: 21306.708<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2019-12<br />TotalValue: 22372.979<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2020-01<br />TotalValue: 19901.703<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2020-02<br />TotalValue: 14168.996<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2020-03<br />TotalValue:  6284.574<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2020-04<br />TotalValue:   130.235<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2020-05<br />TotalValue:   571.946<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2020-06<br />TotalValue:  4422.186<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2020-07<br />TotalValue:  9967.301<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2020-08<br />TotalValue: 11152.803<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2020-09<br />TotalValue: 11350.015<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2020-10<br />TotalValue: 13719.784<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2020-11<br />TotalValue: 16313.789<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2020-12<br />TotalValue: 15231.489<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2021-01<br />TotalValue:  6789.988<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2021-02<br />TotalValue:  8866.026<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2021-03<br />TotalValue: 10799.552<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2021-04<br />TotalValue:  6982.570<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2021-05<br />TotalValue:  1373.793<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2021-06<br />TotalValue:  1292.035<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2021-07<br />TotalValue:   869.248<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2021-08<br />TotalValue:   893.565<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2021-09<br />TotalValue:  2198.337<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2021-10<br />TotalValue:  4596.227<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2021-11<br />TotalValue: 11271.319<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2021-12<br />TotalValue: 15949.621<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2022-01<br />TotalValue: 15406.915<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2022-02<br />TotalValue: 15264.681<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2022-03<br />TotalValue: 15375.429<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2022-04<br />TotalValue: 16721.162<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2022-05<br />TotalValue: 15851.853<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2022-06<br />TotalValue: 15708.947<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2022-07<br />TotalValue: 16737.598<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2022-08<br />TotalValue: 16714.488<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2022-09<br />TotalValue: 16828.750<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2022-10<br />TotalValue: 17695.732<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2022-11<br />TotalValue: 19053.211<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2022-12<br />TotalValue: 21613.755<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2023-01<br />TotalValue: 21819.628<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2023-02<br />TotalValue: 20116.905<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai"],"type":"scatter","mode":"lines","line":{"width":3.7795275590551185,"color":"rgba(0,255,0,1)","dash":"solid"},"hoveron":"points","name":"no_tourist_thai","legendgroup":"no_tourist_thai","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":69.406392694063939,"l":54.794520547945211},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Thailand Number of Tourists by Month","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,50.600000000000001],"tickmode":"array","ticktext":["2019-01","2019-02","2019-03","2019-04","2019-05","2019-06","2019-07","2019-08","2019-09","2019-10","2019-11","2019-12","2020-01","2020-02","2020-03","2020-04","2020-05","2020-06","2020-07","2020-08","2020-09","2020-10","2020-11","2020-12","2021-01","2021-02","2021-03","2021-04","2021-05","2021-06","2021-07","2021-08","2021-09","2021-10","2021-11","2021-12","2022-01","2022-02","2022-03","2022-04","2022-05","2022-06","2022-07","2022-08","2022-09","2022-10","2022-11","2022-12","2023-01","2023-02"],"tickvals":[1,2,3,3.9999999999999996,5,6,7,8,9,10,11,12,13.000000000000002,14,15,16,17,18,19,20,21,22,23,24,25,26,27,27.999999999999996,29.000000000000004,30.000000000000004,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],"categoryorder":"array","categoryarray":["2019-01","2019-02","2019-03","2019-04","2019-05","2019-06","2019-07","2019-08","2019-09","2019-10","2019-11","2019-12","2020-01","2020-02","2020-03","2020-04","2020-05","2020-06","2020-07","2020-08","2020-09","2020-10","2020-11","2020-12","2021-01","2021-02","2021-03","2021-04","2021-05","2021-06","2021-07","2021-08","2021-09","2021-10","2021-11","2021-12","2022-01","2022-02","2022-03","2022-04","2022-05","2022-06","2022-07","2022-08","2022-09","2022-10","2022-11","2022-12","2023-01","2023-02"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-90,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Month-Year","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1443.4978500000002,31027.024850000002],"tickmode":"array","ticktext":["0","10000","20000","30000"],"tickvals":[0,10000,20000,30000],"categoryorder":"array","categoryarray":["0","10000","20000","30000"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Tourists, Thousands","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Indicator","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"15798102c54b8":{"x":{},"y":{},"colour":{},"type":"scatter"}},"cur_data":"15798102c54b8","visdat":{"15798102c54b8":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>The trend for the total follows the same general movement as the chart for revenue, however, it looks like tourist numbers are primarily driven by locals than foreigners.</p>
<p>Similar to the previous section, we can produce an interactive scatterplot to see the number of tourists each province gets on average before and after the pandemic. We do this first for the total number of tourists.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> tourism_period,</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="sc">~</span>PreCovid_tourists_total,</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="sc">~</span>PostCovid_tourists_total,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'scatter'</span>,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">'markers'</span>,</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">text =</span> <span class="sc">~</span>Province,</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">hoverinfo =</span> <span class="st">'text'</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'Monthly Pre- and Post-Covid No of Tourists'</span>,</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'PreCovid Average'</span>),</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'PostCovid Average'</span>)</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-e3479f292a01744eb530" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-e3479f292a01744eb530">{"x":{"visdat":{"157987b107742":["function () ","plotlyVisDat"]},"cur_data":"157987b107742","attrs":{"157987b107742":{"x":{},"y":{},"mode":"markers","text":{},"hoverinfo":"text","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Monthly Pre- and Post-Covid No of Tourists","xaxis":{"domain":[0,1],"automargin":true,"title":"PreCovid Average"},"yaxis":{"domain":[0,1],"automargin":true,"title":"PostCovid Average"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[25210.461538461539,71271.846153846156,5616409.769230769,51713.230769230766,191524,287328.76923076925,71295,148853.61538461538,214229.30769230769,939492.76923076925,320396.38461538462,1552977.076923077,125441.23076923077,63440.692307692305,65758.769230769234,799109.4615384615,469632.92307692306,563658.61538461538,113433.38461538461,101217.61538461539,188930.69230769231,290328.15384615387,93957.230769230766,62324.384615384617,177725.30769230769,256899.46153846153,346280.61538461538,96415.230769230766,837217.76923076925,163506.23076923078,320120.69230769231,82250.153846153844,58833.846153846156,31833.076923076922,234545.84615384616,239608.84615384616,181787.84615384616,23303.461538461539,415761.53846153844,134461.92307692306,56739.923076923078,204738.15384615384,739459.76923076925,73181.692307692312,286351.46153846156,694977.76923076925,73241.076923076922,1253730.7692307692,147794.53846153847,602761.23076923075,85364.538461538468,197717.46153846153,653459.69230769225,77278.846153846156,186018.07692307694,114518.76923076923,298444,124379.23076923077,174194.23076923078,352722.92307692306,134679.61538461538,47771.923076923078,132609.84615384616,640856.07692307688,126321.76923076923,269211,491717.38461538462,118645.30769230769,191806.92307692306,133018.76923076922,190508.46153846153,269780.61538461538,331152.38461538462,65835.61538461539,92820.538461538468,56911.461538461539,51549.153846153844],"y":[19084.1875,56547.9375,3252161.125,56529.125,231170.1875,387234.8125,65266.125,87470.0625,132648.75,778247.8125,430692,1277795.875,89861,53518.4375,64344.4375,987340.75,295133.9375,149648.4375,132391.5625,94692.75,145479.8125,320128.8125,91600.9375,40785.6875,133447.125,134276.4375,238349.5,127747.5,529547.5625,145070.375,170839.625,118261.5,31730.9375,22723.25,179535.375,209564.8125,133492.9375,19732,120560.5,53846.9375,81579.9375,190189.5625,743100.75,55439.8125,218003.0625,658278.3125,99572.375,489591.9375,89476.8125,804419.875,40976.0625,146961.8125,277253.9375,53790.375,92630.4375,129723.5,195386.4375,50326.3125,369839.125,329271.625,128899.25,49068.3125,71363,224817.875,79587.75,341805.375,304515.75,73631.625,140299.4375,82201.625,117306.4375,190251.1875,262580.0625,71315.375,77135.9375,85253.4375,34744.625],"mode":"markers","text":["Amnat Charoen","Ang Thong","Bangkok","Bueng Kan","Buriram","Chachoengsao","Chainat","Chaiyaphum","Chanthaburi","Chiang Mai","Chiang Rai","Chonburi","Chumphon","Kalasin","Kamphaeng Phet","Kanchanaburi","Khon Kaen","Krabi","Lampang","Lamphun","Loei","Lopburi","Mae Hong Son","Maha Sarakham","Mukdahan","Nakhon Nayok","Nakhon Pathom","Nakhon Phanom","Nakhon Ratchasima","Nakhon Sawan","Nakhon Si Thammarat","Nan","Narathiwat","Nong Bua Lamphu","Nong Khai","Nonthaburi","Pathum Thani","Pattani","Phang Nga","Phatthalung","Phayao","Phetchabun","Phetchaburi","Phichit","Phitsanulok","Phra Nakhon Si Ayutthaya","Phrae","Phuket","Prachinburi","Prachuap Khiri Khan","Ranong","Ratchaburi","Rayong","Roi Et","Sa Kaeo","Sakon Nakhon","Samut Prakan","Samut Sakhon","Samut Songkhram","Saraburi","Satun","Sing Buri","Sisaket","Songkhla","Sukhothai","Suphan Buri","Surat Thani","Surin","Tak","Trang","Trat","Ubon Ratchathani","Udon Thani","Uthai Thani","Uttaradit","Yala","Yasothon"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Bangkok, Chonburi and Phuket had the highest number of visitors pre-Covid, but Phuket appears to have dropped off in favor of Kanchanaburi post-covid.</p>
<p>We can also look at the foreign tourists using the code chunk below. We skip local tourists and focus only on foreign ones as they deviate from the overall number.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> tourism_period,</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="sc">~</span>PreCovid_tourists_foreign,</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="sc">~</span>PostCovid_tourists_foreign,</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'scatter'</span>,</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">'markers'</span>,</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">text =</span> <span class="sc">~</span>Province,</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">hoverinfo =</span> <span class="st">'text'</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'Monthly Pre- and Post-Covid No of Foreign Tourists'</span>,</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'PreCovid Average'</span>),</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'PostCovid Average'</span>)</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-65b7328530dcdf303887" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-65b7328530dcdf303887">{"x":{"visdat":{"1579846a1bd5":["function () ","plotlyVisDat"]},"cur_data":"1579846a1bd5","attrs":{"1579846a1bd5":{"x":{},"y":{},"mode":"markers","text":{},"hoverinfo":"text","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Monthly Pre- and Post-Covid No of Foreign Tourists","xaxis":{"domain":[0,1],"automargin":true,"title":"PreCovid Average"},"yaxis":{"domain":[0,1],"automargin":true,"title":"PostCovid Average"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[724.46153846153845,2831.5384615384614,2105110.769230769,538.46153846153845,6360.0769230769229,2754.9230769230771,388.23076923076923,842.69230769230774,7803.2307692307695,291105,53856.769230769234,841259.5384615385,9555.6153846153848,364.53846153846155,1961.4615384615386,41615.076923076922,6818.8461538461543,361435.38461538462,9716.461538461539,4581.6923076923076,3333.3846153846152,1853.2307692307693,22389.461538461539,887.15384615384619,15193.461538461539,2353.2307692307691,10737.153846153846,7357.0769230769229,16775.76923076923,3792.7692307692309,7289.8461538461543,1865.6153846153845,36927.923076923078,158.69230769230768,53891.769230769234,21409.384615384617,51099.615384615383,194.53846153846155,294760.07692307694,1473.2307692307693,2355.3846153846152,2202.5384615384614,47111.461538461539,489.84615384615387,18632.384615384617,176568.69230769231,5973.8461538461543,923446.5384615385,9280.7692307692305,103985.84615384616,4859.1538461538457,5602.0769230769229,48527.461538461539,555.84615384615381,24211.76923076923,469.76923076923077,112878.23076923077,366.84615384615387,4495.0769230769229,8390.3846153846152,15667.153846153846,264,1768.8461538461538,259027.15384615384,33447.846153846156,2382.1538461538462,302017,3722.2307692307691,3844.5384615384614,16837.538461538461,48118.769230769234,13026.384615384615,15331.615384615385,505.69230769230768,743.69230769230774,45060.384615384617,1324],"y":[165.375,106.375,896931.125,1258.625,1735.5625,509.1875,157.0625,323.75,951.875,115284.3125,27107.6875,201621.75,328.1875,564.4375,1410.75,7559,3973.6875,32217.75,2260.5,2875.1875,1060.3125,640.25,8208.1875,538,4870.75,252.75,1385.1875,4600.375,6773.0625,690.9375,585.6875,1379.6875,8203.625,90.6875,28893.9375,7177.8125,4592.8125,1176.375,43355.0625,297.6875,2888.125,3356.0625,4668.625,87.6875,3909.0625,34899.375,696.5,295404.0625,239.625,14908.3125,603.75,3227.5625,11164.6875,447.4375,778.9375,678.9375,37785.3125,312.1875,2952.25,1149.8125,3401,315.5,217.1875,81181.125,6968.4375,1622.375,74760.25,867,1261.0625,941.375,5029.4375,592.125,16019.125,29.9375,357.625,15032.4375,95.75],"mode":"markers","text":["Amnat Charoen","Ang Thong","Bangkok","Bueng Kan","Buriram","Chachoengsao","Chainat","Chaiyaphum","Chanthaburi","Chiang Mai","Chiang Rai","Chonburi","Chumphon","Kalasin","Kamphaeng Phet","Kanchanaburi","Khon Kaen","Krabi","Lampang","Lamphun","Loei","Lopburi","Mae Hong Son","Maha Sarakham","Mukdahan","Nakhon Nayok","Nakhon Pathom","Nakhon Phanom","Nakhon Ratchasima","Nakhon Sawan","Nakhon Si Thammarat","Nan","Narathiwat","Nong Bua Lamphu","Nong Khai","Nonthaburi","Pathum Thani","Pattani","Phang Nga","Phatthalung","Phayao","Phetchabun","Phetchaburi","Phichit","Phitsanulok","Phra Nakhon Si Ayutthaya","Phrae","Phuket","Prachinburi","Prachuap Khiri Khan","Ranong","Ratchaburi","Rayong","Roi Et","Sa Kaeo","Sakon Nakhon","Samut Prakan","Samut Sakhon","Samut Songkhram","Saraburi","Satun","Sing Buri","Sisaket","Songkhla","Sukhothai","Suphan Buri","Surat Thani","Surin","Tak","Trang","Trat","Ubon Ratchathani","Udon Thani","Uthai Thani","Uttaradit","Yala","Yasothon"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Bangkok, Phuket and Chonburi appear as the top 3 destinations for foreign tourists (in terms of number) before and after Covid. We also see that Krabi dropped from the top 3 post covid.</p>
<p>We can also produce side-by-side maps for the number of tourists and their recovery rates using the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(thaitourism_sf) <span class="sc">+</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="fu">c</span>(<span class="st">"PreCovid_tourists_total"</span>, <span class="st">"PostCovid_tourists_total"</span>, <span class="st">"Tourists_total_recovery"</span>),</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"quantile"</span>,</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="fu">list</span>(<span class="st">"viridis"</span>, <span class="st">"viridis"</span>, <span class="st">"RdYlGn"</span>),</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="fu">c</span>(<span class="st">"Monthly Tourists"</span>, <span class="st">"Monthly Tourists"</span>, <span class="st">"Post vs Pre"</span>)) <span class="sc">+</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">title =</span> <span class="fu">c</span>(<span class="st">"Pre Covid"</span>, <span class="st">"Post Covid"</span>, <span class="st">"Recovery Rate"</span>),</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">title.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"top"</span>),</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>),</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">bg.color =</span> <span class="st">"grey90"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="1440"></p>
</figure>
</div>
</div>
</div>
<p>We again see the southern region mostly lagging with regards to their recovery post covid also in terms of the number of visitors.</p>
</section>
<section id="c.3-average-spend-per-visitor" class="level2">
<h2 class="anchored" data-anchor-id="c.3-average-spend-per-visitor">C.3 Average Spend Per Visitor</h2>
<p>We next look at the average per spend per visitor which is the quotient of the tourism revenue and the total number of tourists. This will tell us whether tourists are spending more or less around the pandemic.</p>
<p>First we produce a similar line graph as before to look at the trend at an overall picture using the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset the data to just the required indicators</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>aggregated_data <span class="ot">&lt;&lt;-</span> tourism <span class="sc">%&gt;%</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(MonthYear) <span class="sc">%&gt;%</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Spend_total =</span> <span class="fu">sum</span>(Value[Indicator <span class="sc">==</span> <span class="st">"revenue_all"</span>]) <span class="sc">/</span> <span class="fu">sum</span>(Value[Indicator <span class="sc">==</span> <span class="st">"no_tourist_all"</span>]) <span class="sc">*</span> <span class="dv">1000000</span> <span class="sc">/</span> <span class="fl">34.784</span>,</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Spend_thai =</span> <span class="fu">sum</span>(Value[Indicator <span class="sc">==</span> <span class="st">"revenue_thai"</span>]) <span class="sc">/</span> <span class="fu">sum</span>(Value[Indicator <span class="sc">==</span> <span class="st">"no_tourist_thai"</span>]) <span class="sc">*</span> <span class="dv">1000000</span> <span class="sc">/</span> <span class="fl">34.784</span>,</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Spend_foreign =</span> <span class="fu">sum</span>(Value[Indicator <span class="sc">==</span> <span class="st">"revenue_foreign"</span>]) <span class="sc">/</span> <span class="fu">sum</span>(Value[Indicator <span class="sc">==</span> <span class="st">"no_tourist_foreign"</span>]) <span class="sc">*</span> <span class="dv">1000000</span> <span class="sc">/</span> <span class="fl">34.784</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"Spend"</span>), <span class="at">names_to =</span> <span class="st">"Indicator"</span>, <span class="at">values_to =</span> <span class="st">"TotalValue"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Indicator =</span> <span class="fu">case_when</span>(</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>    Indicator <span class="sc">==</span> <span class="st">"Spend_total"</span> <span class="sc">~</span> <span class="st">"Spend_total"</span>,</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>    Indicator <span class="sc">==</span> <span class="st">"Spend_thai"</span> <span class="sc">~</span> <span class="st">"Spend_thai"</span>,</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>    Indicator <span class="sc">==</span> <span class="st">"Spend_foreign"</span> <span class="sc">~</span> <span class="st">"Spend_foreign"</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the line chart</span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(aggregated_data, <span class="fu">aes</span>(<span class="at">x =</span> MonthYear, <span class="at">y =</span> TotalValue, <span class="at">color =</span> Indicator, <span class="at">group =</span> Indicator)) <span class="sc">+</span></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Thailand Average Spend Per Tourist by Month"</span>,</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Average Spend, USD"</span>,</span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Month-Year"</span>) <span class="sc">+</span></span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Spend_total"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Spend_thai"</span> <span class="ot">=</span> <span class="st">"green"</span>, <span class="st">"Spend_foreign"</span> <span class="ot">=</span> <span class="st">"red"</span>))</span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the ggplot chart to an interactive plotly chart</span></span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>interactive_plot <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(p)</span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the interactive plot</span></span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a>interactive_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-1990be7a07e95fee1522" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-1990be7a07e95fee1522">{"x":{"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],"y":[592.62180350625579,575.2532050789149,588.20571347578334,569.10100639491725,570.41267044202232,571.26540496955806,540.70708950149162,542.63748796188065,539.63637860946289,737.93334763852954,728.79950185608482,772.94384072398202,635.60843424427435,618.19815165497789,566.38838397120685,1573.2616280125117,1511.0194133405391,640.68360963866826,598.31213934119717,487.78100129052206,408.43967281548368,611.3699325742831,598.47538511886205,636.45391189422196,572.55988182359431,572.67752491177623,545.15547743474883,535.55201513061479,361.79217964602265,343.93144083085139,829.12549161032973,811.66972974532382,905.56810082279856,684.93684098965889,588.45708744334036,629.80456778426355,598.73019527124075,590.7087524016556,609.39725798844609,605.57900866288958,615.85235634434582,638.31614326034446,639.64106132104212,612.04524830555181,599.39630176177559,549.62566560301502,554.19062653996218,540.18993136342806,539.89354672061404,538.81556904678564],"text":["MonthYear: 2019-01<br />TotalValue:  592.62180<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2019-02<br />TotalValue:  575.25321<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2019-03<br />TotalValue:  588.20571<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2019-04<br />TotalValue:  569.10101<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2019-05<br />TotalValue:  570.41267<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2019-06<br />TotalValue:  571.26540<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2019-07<br />TotalValue:  540.70709<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2019-08<br />TotalValue:  542.63749<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2019-09<br />TotalValue:  539.63638<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2019-10<br />TotalValue:  737.93335<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2019-11<br />TotalValue:  728.79950<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2019-12<br />TotalValue:  772.94384<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2020-01<br />TotalValue:  635.60843<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2020-02<br />TotalValue:  618.19815<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2020-03<br />TotalValue:  566.38838<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2020-04<br />TotalValue: 1573.26163<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2020-05<br />TotalValue: 1511.01941<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2020-06<br />TotalValue:  640.68361<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2020-07<br />TotalValue:  598.31214<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2020-08<br />TotalValue:  487.78100<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2020-09<br />TotalValue:  408.43967<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2020-10<br />TotalValue:  611.36993<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2020-11<br />TotalValue:  598.47539<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2020-12<br />TotalValue:  636.45391<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2021-01<br />TotalValue:  572.55988<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2021-02<br />TotalValue:  572.67752<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2021-03<br />TotalValue:  545.15548<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2021-04<br />TotalValue:  535.55202<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2021-05<br />TotalValue:  361.79218<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2021-06<br />TotalValue:  343.93144<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2021-07<br />TotalValue:  829.12549<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2021-08<br />TotalValue:  811.66973<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2021-09<br />TotalValue:  905.56810<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2021-10<br />TotalValue:  684.93684<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2021-11<br />TotalValue:  588.45709<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2021-12<br />TotalValue:  629.80457<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2022-01<br />TotalValue:  598.73020<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2022-02<br />TotalValue:  590.70875<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2022-03<br />TotalValue:  609.39726<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2022-04<br />TotalValue:  605.57901<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2022-05<br />TotalValue:  615.85236<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2022-06<br />TotalValue:  638.31614<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2022-07<br />TotalValue:  639.64106<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2022-08<br />TotalValue:  612.04525<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2022-09<br />TotalValue:  599.39630<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2022-10<br />TotalValue:  549.62567<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2022-11<br />TotalValue:  554.19063<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2022-12<br />TotalValue:  540.18993<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2023-01<br />TotalValue:  539.89355<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign","MonthYear: 2023-02<br />TotalValue:  538.81557<br />Indicator: Spend_foreign<br />Indicator: Spend_foreign"],"type":"scatter","mode":"lines","line":{"width":3.7795275590551185,"color":"rgba(255,0,0,1)","dash":"solid"},"hoveron":"points","name":"Spend_foreign","legendgroup":"Spend_foreign","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],"y":[131.32135316727371,136.02666332139043,133.51249820964239,134.36132962023873,132.88231872809854,131.38417235608139,146.72471640716986,146.53771350750841,150.63316177723036,127.47171147447865,128.7522082750539,130.2583695621995,135.58925330249537,133.99439221803053,133.8529690547735,110.26922918936893,107.53286128481498,104.38546637841083,100.93434604610303,101.12605314933316,104.7568463855675,98.858374692932841,101.2787999686085,102.63374246675579,96.866351773427908,95.765718490561412,95.550047964168911,112.54898300395269,78.814061894141787,75.610765056524642,72.087101192362269,70.722496062527327,71.922310192193081,64.83321112594767,68.754355804225185,83.583472767879542,89.076397143803803,89.472961731151926,91.755897090660568,92.912491267488932,90.356612864768024,90.629586896238976,89.945113772821188,90.579952410082555,90.130393150165702,90.310431245934026,91.743832806754909,92.67255758760119,92.663168339327385,89.377648670772302],"text":["MonthYear: 2019-01<br />TotalValue:  131.32135<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2019-02<br />TotalValue:  136.02666<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2019-03<br />TotalValue:  133.51250<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2019-04<br />TotalValue:  134.36133<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2019-05<br />TotalValue:  132.88232<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2019-06<br />TotalValue:  131.38417<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2019-07<br />TotalValue:  146.72472<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2019-08<br />TotalValue:  146.53771<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2019-09<br />TotalValue:  150.63316<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2019-10<br />TotalValue:  127.47171<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2019-11<br />TotalValue:  128.75221<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2019-12<br />TotalValue:  130.25837<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2020-01<br />TotalValue:  135.58925<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2020-02<br />TotalValue:  133.99439<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2020-03<br />TotalValue:  133.85297<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2020-04<br />TotalValue:  110.26923<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2020-05<br />TotalValue:  107.53286<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2020-06<br />TotalValue:  104.38547<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2020-07<br />TotalValue:  100.93435<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2020-08<br />TotalValue:  101.12605<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2020-09<br />TotalValue:  104.75685<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2020-10<br />TotalValue:   98.85837<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2020-11<br />TotalValue:  101.27880<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2020-12<br />TotalValue:  102.63374<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2021-01<br />TotalValue:   96.86635<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2021-02<br />TotalValue:   95.76572<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2021-03<br />TotalValue:   95.55005<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2021-04<br />TotalValue:  112.54898<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2021-05<br />TotalValue:   78.81406<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2021-06<br />TotalValue:   75.61077<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2021-07<br />TotalValue:   72.08710<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2021-08<br />TotalValue:   70.72250<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2021-09<br />TotalValue:   71.92231<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2021-10<br />TotalValue:   64.83321<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2021-11<br />TotalValue:   68.75436<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2021-12<br />TotalValue:   83.58347<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2022-01<br />TotalValue:   89.07640<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2022-02<br />TotalValue:   89.47296<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2022-03<br />TotalValue:   91.75590<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2022-04<br />TotalValue:   92.91249<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2022-05<br />TotalValue:   90.35661<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2022-06<br />TotalValue:   90.62959<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2022-07<br />TotalValue:   89.94511<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2022-08<br />TotalValue:   90.57995<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2022-09<br />TotalValue:   90.13039<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2022-10<br />TotalValue:   90.31043<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2022-11<br />TotalValue:   91.74383<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2022-12<br />TotalValue:   92.67256<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2023-01<br />TotalValue:   92.66317<br />Indicator: Spend_thai<br />Indicator: Spend_thai","MonthYear: 2023-02<br />TotalValue:   89.37765<br />Indicator: Spend_thai<br />Indicator: Spend_thai"],"type":"scatter","mode":"lines","line":{"width":3.7795275590551185,"color":"rgba(0,255,0,1)","dash":"solid"},"hoveron":"points","name":"Spend_thai","legendgroup":"Spend_thai","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],"y":[258.81758914371039,259.09371270746084,258.88773920346091,249.56935226822139,241.11969091931317,244.2828786835064,243.2311423265611,248.16933036020285,246.34861883548828,259.7630388791552,258.66374823052178,286.36999262700931,278.65023391257222,238.14270393222739,189.96307007055674,946.76037173795066,420.03721291260564,117.85062779455794,105.15011820059948,103.92631788071105,107.04410379815582,102.26457323438852,105.14901565361217,105.95878239052547,101.02923171091886,99.177673856401171,98.714289801809571,116.76761254769941,86.311903990467002,82.181681059711039,107.9094473040843,104.34546204148602,93.745596778817216,78.10566377895222,77.179514500218417,96.383834484464032,103.7844027224012,104.00298680881633,109.76230342368464,111.84598455690086,122.76274870346263,135.86393584393855,149.40645261980734,152.32229278181043,150.87256110657088,152.26051940437995,165.88495838928239,167.70192603450221,175.75017092395561,184.47740842206184],"text":["MonthYear: 2019-01<br />TotalValue:  258.81759<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2019-02<br />TotalValue:  259.09371<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2019-03<br />TotalValue:  258.88774<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2019-04<br />TotalValue:  249.56935<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2019-05<br />TotalValue:  241.11969<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2019-06<br />TotalValue:  244.28288<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2019-07<br />TotalValue:  243.23114<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2019-08<br />TotalValue:  248.16933<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2019-09<br />TotalValue:  246.34862<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2019-10<br />TotalValue:  259.76304<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2019-11<br />TotalValue:  258.66375<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2019-12<br />TotalValue:  286.36999<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2020-01<br />TotalValue:  278.65023<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2020-02<br />TotalValue:  238.14270<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2020-03<br />TotalValue:  189.96307<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2020-04<br />TotalValue:  946.76037<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2020-05<br />TotalValue:  420.03721<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2020-06<br />TotalValue:  117.85063<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2020-07<br />TotalValue:  105.15012<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2020-08<br />TotalValue:  103.92632<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2020-09<br />TotalValue:  107.04410<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2020-10<br />TotalValue:  102.26457<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2020-11<br />TotalValue:  105.14902<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2020-12<br />TotalValue:  105.95878<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2021-01<br />TotalValue:  101.02923<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2021-02<br />TotalValue:   99.17767<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2021-03<br />TotalValue:   98.71429<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2021-04<br />TotalValue:  116.76761<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2021-05<br />TotalValue:   86.31190<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2021-06<br />TotalValue:   82.18168<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2021-07<br />TotalValue:  107.90945<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2021-08<br />TotalValue:  104.34546<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2021-09<br />TotalValue:   93.74560<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2021-10<br />TotalValue:   78.10566<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2021-11<br />TotalValue:   77.17951<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2021-12<br />TotalValue:   96.38383<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2022-01<br />TotalValue:  103.78440<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2022-02<br />TotalValue:  104.00299<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2022-03<br />TotalValue:  109.76230<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2022-04<br />TotalValue:  111.84598<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2022-05<br />TotalValue:  122.76275<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2022-06<br />TotalValue:  135.86394<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2022-07<br />TotalValue:  149.40645<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2022-08<br />TotalValue:  152.32229<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2022-09<br />TotalValue:  150.87256<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2022-10<br />TotalValue:  152.26052<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2022-11<br />TotalValue:  165.88496<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2022-12<br />TotalValue:  167.70193<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2023-01<br />TotalValue:  175.75017<br />Indicator: Spend_total<br />Indicator: Spend_total","MonthYear: 2023-02<br />TotalValue:  184.47741<br />Indicator: Spend_total<br />Indicator: Spend_total"],"type":"scatter","mode":"lines","line":{"width":3.7795275590551185,"color":"rgba(0,0,255,1)","dash":"solid"},"hoveron":"points","name":"Spend_total","legendgroup":"Spend_total","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":69.406392694063939,"l":48.949771689497723},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Thailand Average Spend Per Tourist by Month","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,50.600000000000001],"tickmode":"array","ticktext":["2019-01","2019-02","2019-03","2019-04","2019-05","2019-06","2019-07","2019-08","2019-09","2019-10","2019-11","2019-12","2020-01","2020-02","2020-03","2020-04","2020-05","2020-06","2020-07","2020-08","2020-09","2020-10","2020-11","2020-12","2021-01","2021-02","2021-03","2021-04","2021-05","2021-06","2021-07","2021-08","2021-09","2021-10","2021-11","2021-12","2022-01","2022-02","2022-03","2022-04","2022-05","2022-06","2022-07","2022-08","2022-09","2022-10","2022-11","2022-12","2023-01","2023-02"],"tickvals":[1,2,3,3.9999999999999996,5,6,7,8,9,10,11,12,13.000000000000002,14,15,16,17,18,19,20,21,22,23,24,25,26,27,27.999999999999996,29.000000000000004,30.000000000000004,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],"categoryorder":"array","categoryarray":["2019-01","2019-02","2019-03","2019-04","2019-05","2019-06","2019-07","2019-08","2019-09","2019-10","2019-11","2019-12","2020-01","2020-02","2020-03","2020-04","2020-05","2020-06","2020-07","2020-08","2020-09","2020-10","2020-11","2020-12","2021-01","2021-02","2021-03","2021-04","2021-05","2021-06","2021-07","2021-08","2021-09","2021-10","2021-11","2021-12","2022-01","2022-02","2022-03","2022-04","2022-05","2022-06","2022-07","2022-08","2022-09","2022-10","2022-11","2022-12","2023-01","2023-02"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-90,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Month-Year","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-10.58820971838054,1648.6830488568398],"tickmode":"array","ticktext":["0","400","800","1200","1600"],"tickvals":[0,400,800,1200,1600],"categoryorder":"array","categoryarray":["0","400","800","1200","1600"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Average Spend, USD","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Indicator","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"157983ea25d44":{"x":{},"y":{},"colour":{},"type":"scatter"}},"cur_data":"157983ea25d44","visdat":{"157983ea25d44":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>The chart shows that the average spend of foreign tourists are much higher than local ones and appears to be the same before and after Covid. There appears to be a shift in the average spend for all tourists overall which is probably driven by an increase in the contribution for the number of local tourists versus foreign tourists. Local tourists appear to show a step decrease after covid as well in terms of their average spending.</p>
<p>Next, we check the average spending of tourists across provinces using a similar scatterplot as before.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> tourism_period,</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="sc">~</span>PreCovidSpend_total,</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="sc">~</span>PostCovidSpend_total,</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'scatter'</span>,</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">'markers'</span>,</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">text =</span> <span class="sc">~</span>Province,</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">hoverinfo =</span> <span class="st">'text'</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'Monthly Pre- and Post-Covid Average Spend Per Tourist'</span>,</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'PreCovid Average $'</span>),</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'PostCovid Average $'</span>)</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-28cf82553809b695f76c" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-28cf82553809b695f76c">{"x":{"visdat":{"15798dce7dce":["function () ","plotlyVisDat"]},"cur_data":"15798dce7dce","attrs":{"15798dce7dce":{"x":{},"y":{},"mode":"markers","text":{},"hoverinfo":"text","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Monthly Pre- and Post-Covid Average Spend Per Tourist","xaxis":{"domain":[0,1],"automargin":true,"title":"PreCovid Average $"},"yaxis":{"domain":[0,1],"automargin":true,"title":"PostCovid Average $"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[41.430814329903924,35.353427131556785,455.17922120611138,51.677387054028756,58.22301098474221,41.42493915040064,44.309337478847809,35.379815050636417,100.28080220110954,286.60374887907216,223.42288539699376,432.03341278438847,141.83393158185623,46.241598183789904,60.881927615706388,84.788994637811584,93.07107919534738,488.70002885128343,91.223538618215855,40.604288526841465,59.794144326623858,46.955354662351617,138.93286311244557,46.070999373901074,48.94932986122938,72.900012502209606,42.039571975817694,54.88988577058381,71.910273931050085,58.584961672476048,118.66947200735152,82.402640474345347,127.79864439541974,30.753065119402812,58.798268810608306,47.305008630014541,46.015955042477643,106.63394454830664,307.76854320561591,59.330022873467016,60.484058073860218,92.384983235594902,99.494107560779071,49.33280934659296,73.572446168145063,65.603124083252737,58.781312601533294,891.40091864804094,86.63054566334722,168.41018107098813,125.21695792824529,54.317229083451593,133.4993765185468,44.765361307906772,87.278875943279843,52.338083834204419,57.466178237594654,47.221096999663025,43.294312651821329,44.719798080143299,178.95243118443821,43.484698574490707,40.742357293563899,254.39722645701033,73.698095138995612,50.818145355833479,468.35924142506946,64.836910371187798,92.416134595166568,179.519132467536,250.91355457632173,73.153349991216629,81.580380824078702,50.192240688909656,59.372632864020304,138.65796812814173,38.354165173380743],"y":[30.770563234723507,28.978042153338265,263.88793689462761,37.652079015671177,57.737361738007202,32.245911756490855,36.575800441185336,39.926715904159522,96.228552689798093,197.82469013969202,195.14157566690284,197.73485715381372,82.028568742072437,29.144178419154173,48.875594609002469,53.142340262038573,76.25057571426909,258.03058715552714,78.471013354776616,35.521741542455388,53.878720505319095,33.268343329109904,113.41438653872601,34.021718612262177,40.452840908991519,62.004600125598806,36.635712853798168,41.417579730009109,46.92706083992725,67.963249280479417,77.326965924068062,66.240663655882969,59.883362847071517,21.462874940824047,45.351382355162514,36.846393465737393,38.161810352052747,63.419902008906476,131.54270202174771,32.96962547713138,54.742408967988133,85.678768868808632,77.504061130959457,45.886047476175399,68.852693450481496,43.658240807267347,56.561226545752248,984.79450401137319,74.656937836904433,97.805435909062894,66.016277406245152,33.881474209060968,95.850000807994533,36.474615382778481,88.588590386443983,38.112473735757462,41.75613392029824,36.894466453350226,28.588835856532167,44.120693150546472,106.70549614069178,36.002112997726393,33.277731570277012,164.55561826199684,64.362318738306755,34.91425855576572,209.96620857640642,49.485545469829333,84.32752340568733,105.04532959814767,182.56202848588444,40.270427563735417,55.799557995546451,41.405997351635108,39.929611922821486,56.925696917455419,28.127034130311415],"mode":"markers","text":["Amnat Charoen","Ang Thong","Bangkok","Bueng Kan","Buriram","Chachoengsao","Chainat","Chaiyaphum","Chanthaburi","Chiang Mai","Chiang Rai","Chonburi","Chumphon","Kalasin","Kamphaeng Phet","Kanchanaburi","Khon Kaen","Krabi","Lampang","Lamphun","Loei","Lopburi","Mae Hong Son","Maha Sarakham","Mukdahan","Nakhon Nayok","Nakhon Pathom","Nakhon Phanom","Nakhon Ratchasima","Nakhon Sawan","Nakhon Si Thammarat","Nan","Narathiwat","Nong Bua Lamphu","Nong Khai","Nonthaburi","Pathum Thani","Pattani","Phang Nga","Phatthalung","Phayao","Phetchabun","Phetchaburi","Phichit","Phitsanulok","Phra Nakhon Si Ayutthaya","Phrae","Phuket","Prachinburi","Prachuap Khiri Khan","Ranong","Ratchaburi","Rayong","Roi Et","Sa Kaeo","Sakon Nakhon","Samut Prakan","Samut Sakhon","Samut Songkhram","Saraburi","Satun","Sing Buri","Sisaket","Songkhla","Sukhothai","Suphan Buri","Surat Thani","Surin","Tak","Trang","Trat","Ubon Ratchathani","Udon Thani","Uthai Thani","Uttaradit","Yala","Yasothon"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Phuket saw the highest average spend pre- and post-covid. Krabi was second highest pre-Covid but drop to third, as Bangkok rose from fourth to second over that period.</p>
<p>We can do the same for foreign tourists as the earlier chart showed that it was very different from the total. We use the code chunk below tor produce a similar scatterplot but taking the foreign tourist figures.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> tourism_period,</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="sc">~</span>PreCovidSpend_foreign,</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="sc">~</span>PostCovidSpend_foreign,</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'scatter'</span>,</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">'markers'</span>,</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">text =</span> <span class="sc">~</span>Province,</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">hoverinfo =</span> <span class="st">'text'</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'Monthly Pre- and Post-Covid Average Spend Per Foreign Tourist'</span>,</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'PreCovid Average $'</span>),</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'PostCovid Average $'</span>)</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-988252b1f4f7d9d645fb" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-988252b1f4f7d9d645fb">{"x":{"visdat":{"157982a8f1eae":["function () ","plotlyVisDat"]},"cur_data":"157982a8f1eae","attrs":{"157982a8f1eae":{"x":{},"y":{},"mode":"markers","text":{},"hoverinfo":"text","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Monthly Pre- and Post-Covid Average Spend Per Foreign Tourist","xaxis":{"domain":[0,1],"automargin":true,"title":"PreCovid Average $"},"yaxis":{"domain":[0,1],"automargin":true,"title":"PostCovid Average $"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[93.743595764769978,31.943166717775735,777.66931297517203,57.16914180575634,106.05443514870285,51.767837702195266,50.867293622104931,66.498937486589995,167.74555255442826,361.42281856147838,301.72910543279067,641.32137861982119,181.91273830253974,66.184839417986908,64.163185070699058,134.63595202097616,113.42896162883248,508.82893578877861,137.25997502842577,43.121827056000065,91.340325710366628,59.772119326085345,224.17965349048367,49.92972049088209,60.100183137954588,101.8971564620679,58.973214744421973,39.199698192202383,122.7440184094725,53.345075461574076,121.03166367182894,132.02683866421785,142.06296263848427,34.420581489876618,39.661581024872646,73.731924358598832,62.76800162761176,125.84016212305245,379.26575236829694,75.369661696405998,44.738168017368139,100.89658579689014,243.54533379294369,52.007969932458977,106.70809352762603,82.271634387075835,81.371165704492086,1080.4841090678776,125.34403306834987,317.39966819597151,193.6493484869512,66.701816527830474,250.50800515941899,59.876860391955766,73.906903200985752,83.558553842552371,75.732966311764798,51.059500920445466,45.21218631027503,56.540942579578513,143.81553198689147,48.501119395783604,77.026164441571936,327.19651490454305,86.193921511483822,61.465427588011437,629.1857423739051,80.15860729103872,114.01982945072442,252.76077011084243,426.37221589007851,117.72661139166006,112.19942951859221,77.622769746952756,51.770529509808441,147.6589152076175,72.723967639016962],"y":[57.150019365816448,37.836324384862444,591.04443894463816,53.877326484058528,74.302458417706362,27.242067307610874,24.824912295987271,63.935666511563475,62.877491466329538,259.74523338094053,324.40266475174582,396.96679510347059,72.542803867734847,92.094367382430178,55.620338539284944,97.023565644224348,79.094494251969977,171.1276129969925,130.42223278996292,58.325113031606811,95.321120842168966,39.766810342814715,156.14843193771011,77.11558405693512,67.670392809602006,85.450340641171593,72.381258519455741,68.772892374254226,87.91599908870424,93.775082103907167,83.23085068273717,142.78704050025996,78.345423985231704,28.927168206173203,65.875046951299836,39.078610132620248,38.093155460010081,12.708024247301282,204.63094283412372,16.719360618814804,76.329721102434846,97.965707235352866,117.74643475156867,66.595696827864586,82.245291210016006,60.340715725406696,67.280151579292195,1495.1775425877581,101.00339335409369,283.89087172989798,80.53249298599485,70.317523853334137,83.097832075185096,70.918381311960829,68.417788041748025,77.092331937763646,40.336791000997316,57.612810602691013,46.596069936523399,43.395964873477681,108.94935049407786,56.039755240218284,68.831779102936608,174.228613634087,82.068110611599565,43.89078231462004,327.16560709998794,57.365064105624938,131.8825177309605,91.178632764395971,202.6756237600529,69.914872816106993,97.045007027916427,57.617737044171683,67.274921725955153,75.984200725269233,46.913919787856003],"mode":"markers","text":["Amnat Charoen","Ang Thong","Bangkok","Bueng Kan","Buriram","Chachoengsao","Chainat","Chaiyaphum","Chanthaburi","Chiang Mai","Chiang Rai","Chonburi","Chumphon","Kalasin","Kamphaeng Phet","Kanchanaburi","Khon Kaen","Krabi","Lampang","Lamphun","Loei","Lopburi","Mae Hong Son","Maha Sarakham","Mukdahan","Nakhon Nayok","Nakhon Pathom","Nakhon Phanom","Nakhon Ratchasima","Nakhon Sawan","Nakhon Si Thammarat","Nan","Narathiwat","Nong Bua Lamphu","Nong Khai","Nonthaburi","Pathum Thani","Pattani","Phang Nga","Phatthalung","Phayao","Phetchabun","Phetchaburi","Phichit","Phitsanulok","Phra Nakhon Si Ayutthaya","Phrae","Phuket","Prachinburi","Prachuap Khiri Khan","Ranong","Ratchaburi","Rayong","Roi Et","Sa Kaeo","Sakon Nakhon","Samut Prakan","Samut Sakhon","Samut Songkhram","Saraburi","Satun","Sing Buri","Sisaket","Songkhla","Sukhothai","Suphan Buri","Surat Thani","Surin","Tak","Trang","Trat","Ubon Ratchathani","Udon Thani","Uthai Thani","Uttaradit","Yala","Yasothon"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Phuket, Bangkok and Chonburi have been consistent as top 4 highest spend for foreign tourists. From the chart above, we see that Chiang Rai has risen to the number five spot for highest foreign tourist spending post-Covid.</p>
<p>We can also produce a map visualization of the average spend using <strong>tmap</strong> package. We focus on the total tourist population in the visualization below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(thaitourism_sf) <span class="sc">+</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="fu">c</span>(<span class="st">"PreCovidSpend_total"</span>, <span class="st">"PostCovidSpend_total"</span>, <span class="st">"Spend_total_recovery"</span>),</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"quantile"</span>,</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="fu">list</span>(<span class="st">"viridis"</span>, <span class="st">"viridis"</span>, <span class="st">"RdYlGn"</span>),</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="fu">c</span>(<span class="st">"Average Tourist Spending"</span>, <span class="st">"Average Tourist Spending"</span>, <span class="st">"Post vs Pre"</span>)) <span class="sc">+</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">title =</span> <span class="fu">c</span>(<span class="st">"Pre Covid"</span>, <span class="st">"Post Covid"</span>, <span class="st">"Recovery Rate"</span>),</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">title.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"top"</span>),</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>),</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">bg.color =</span> <span class="st">"grey90"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="1440"></p>
</figure>
</div>
</div>
</div>
<p>We again see slow recovery in the southern region, but at the same time, this region has the highest average spending pre- and post-covid. (i.e., top 20%)</p>
</section>
<section id="c.4-occupancy-rate" class="level2">
<h2 class="anchored" data-anchor-id="c.4-occupancy-rate">C.4 Occupancy Rate</h2>
<p>The final single indicator we will look at is the occupancy rate. We have not prepared and included the data for occupancy rate before as this is a ratio measure which be just summed or averaged. In order to be able to aggregate occupancy rate, we not only need the actual occupancy rate from the data, but we also need the number of rooms occupied which is given by the <code>no_tourist_occupied</code> indicator in the data, and also the number of rooms in total– which is not included in the data.</p>
<p>The following code chunk prepares a new dataframe from tourist with the following transformation steps:</p>
<ol type="1">
<li><p>Retain MonthYear, Province, and records for occupany rate and number of rooms occupied</p></li>
<li><p>Keep values for the two indicators as separate columns. We use average just in case a province appears multiple times on the same date (to resolve conflicts)</p></li>
<li><p>We compute the total number of rooms as the number of rooms occupied divided by the occupancy rate</p></li>
<li><p>We add the tags for the period for pre- and post- covid</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>occupancy_df <span class="ot">&lt;-</span> tourism <span class="sc">%&gt;%</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"occupancy_rate"</span>, <span class="st">"no_tourist_occupied"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Date, MonthYear, Province) <span class="sc">%&gt;%</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">occupancy =</span> <span class="fu">mean</span>(Value[Indicator <span class="sc">==</span> <span class="st">"occupancy_rate"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">occupied_rooms =</span> <span class="fu">mean</span>(Value[Indicator <span class="sc">==</span> <span class="st">"no_tourist_occupied"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_rooms =</span> <span class="fu">ifelse</span>(occupancy <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, occupied_rooms <span class="sc">/</span> occupancy <span class="sc">*</span> <span class="dv">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Date', 'MonthYear'. You can override using
the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>occupancy_df<span class="sc">$</span>Period <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(occupancy_df<span class="sc">$</span>Date <span class="sc">&lt;</span> <span class="fu">as.Date</span>(<span class="st">"2020-02-01"</span>), <span class="st">"Pre-Covid"</span>,</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">ifelse</span>(occupancy_df<span class="sc">$</span>Date <span class="sc">&gt;</span> <span class="fu">as.Date</span>(<span class="st">"2021-10-01"</span>), <span class="st">"Post-Covid"</span>, <span class="st">"Covid"</span>))</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(occupancy_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
  Date       MonthYear Province      occupancy occupied_rooms total_rooms Period
  &lt;date&gt;     &lt;chr&gt;     &lt;chr&gt;             &lt;dbl&gt;          &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt; 
1 2019-01-01 2019-01   Amnat Charoen      65.2           8551      13125. Pre-C…
2 2019-01-01 2019-01   Ang Thong          71.2          19140      26878. Pre-C…
3 2019-01-01 2019-01   Bangkok            93.4        3334971    3571780. Pre-C…
4 2019-01-01 2019-01   Bueng Kan          73.0          37974      52055. Pre-C…
5 2019-01-01 2019-01   Buriram            71.3         113655     159493. Pre-C…
6 2019-01-01 2019-01   Chachoengsao       59.4          38687      65130. Pre-C…</code></pre>
</div>
</div>
<p>Before we produce the charts, let us update <code>thaitourism_sf</code> with the aggregated occupancy rates by:</p>
<ol type="1">
<li>Computing Pre- and Post-covid total number of rooms and occupied rooms per province</li>
<li>Computing Pre- and Post-covid occupancy rate per province based on step 1</li>
<li>Add the new columns into <code>thaitourism_sf</code> using <code>left_join()</code></li>
</ol>
<p>The first two steps are accomplished in the first code block while the third step is accomplished in the second.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>occupancy_summary <span class="ot">&lt;-</span> occupancy_df <span class="sc">%&gt;%</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Province) <span class="sc">%&gt;%</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">PreCovid_occupied_rooms =</span> <span class="fu">sum</span>(occupied_rooms[Period <span class="sc">==</span> <span class="st">"Pre-Covid"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">PostCovid_occupied_rooms =</span> <span class="fu">sum</span>(occupied_rooms[Period <span class="sc">==</span> <span class="st">"Post-Covid"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">PreCovid_total_rooms =</span> <span class="fu">sum</span>(total_rooms[Period <span class="sc">==</span> <span class="st">"Pre-Covid"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">PostCovid_total_rooms =</span> <span class="fu">sum</span>(total_rooms[Period <span class="sc">==</span> <span class="st">"Post-Covid"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">PreCovid_occupancy =</span> <span class="fu">ifelse</span>(PreCovid_total_rooms <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, (PreCovid_occupied_rooms <span class="sc">/</span> PreCovid_total_rooms) <span class="sc">*</span> <span class="dv">100</span>),</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">PostCovid_occupancy =</span> <span class="fu">ifelse</span>(PostCovid_total_rooms <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, (PostCovid_occupied_rooms <span class="sc">/</span> PostCovid_total_rooms) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(occupancy_summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
  Province    PreCovid_occupied_ro…¹ PostCovid_occupied_r…² PreCovid_total_rooms
  &lt;chr&gt;                        &lt;dbl&gt;                  &lt;dbl&gt;                &lt;dbl&gt;
1 Amnat Char…                 106667                  91166              189198.
2 Ang Thong                   208960                 116396              324038.
3 Bangkok                   39621389               23666935            47956613.
4 Bueng Kan                   362415                 465507              608851.
5 Buriram                    1319062                1827050             2137721.
6 Chachoengs…                 518580                 372576              917461.
# ℹ abbreviated names: ¹​PreCovid_occupied_rooms, ²​PostCovid_occupied_rooms
# ℹ 3 more variables: PostCovid_total_rooms &lt;dbl&gt;, PreCovid_occupancy &lt;dbl&gt;,
#   PostCovid_occupancy &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>thaitourism_sf <span class="ot">&lt;-</span> <span class="fu">left_join</span>(thaitourism_sf, occupancy_summary, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Province"</span><span class="ot">=</span><span class="st">"Province"</span>))</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(thaitourism_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "sf"         "data.frame"</code></pre>
</div>
</div>
<p>Finally, we add a column for the recovery of the occupancy rate using the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>thaitourism_sf <span class="ot">&lt;-</span> <span class="fu">mutate</span>(thaitourism_sf, <span class="at">Occupancy_recovery =</span> <span class="fu">ifelse</span>(PreCovid_occupancy <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, (PostCovid_occupancy <span class="sc">/</span> PreCovid_occupancy)), <span class="at">.before =</span> <span class="sc">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(thaitourism_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "sf"         "data.frame"</code></pre>
</div>
</div>
<p>For the first visualization, let us plot the occupancy rate at a total level. The code below summarizes based on <code>occupancy_df</code> and computes a national occupancy rate to plot in a line chart.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>aggregated_data <span class="ot">&lt;&lt;-</span> occupancy_df <span class="sc">%&gt;%</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(MonthYear) <span class="sc">%&gt;%</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">occupancy_rate =</span> <span class="fu">sum</span>(occupied_rooms, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sum</span>(total_rooms, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(aggregated_data, <span class="fu">aes</span>(<span class="at">x =</span> MonthYear, <span class="at">y =</span> occupancy_rate, <span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Occupancy Rate Over Time"</span>,</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"MonthYear"</span>,</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Occupancy Rate (%)"</span></span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The chart shows that occupancy rate has picked up after October 2021 and appears to have more or less reached pre-covid levels in the most recent months.</p>
<p>We can also produce a scatterplot to show pre- and post-covid occupancy rates at a province level. We do this using the code chunk below which produces an interactive plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> occupancy_summary,</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="sc">~</span>PreCovid_occupancy,</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="sc">~</span>PostCovid_occupancy,</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'scatter'</span>,</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">'markers'</span>,</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">text =</span> <span class="sc">~</span><span class="fu">paste</span>(<span class="st">'Province:'</span>, Province, <span class="st">'&lt;br&gt;PreCovid Occupancy:'</span>, <span class="fu">round</span>(PreCovid_occupancy), <span class="st">'&lt;br&gt;PostCovid Occupancy:'</span>, <span class="fu">round</span>(PostCovid_occupancy)),</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">hoverinfo =</span> <span class="st">'text'</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'Monthly Pre- and Post-Covid Occupancy Rate (%)'</span>,</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'PreCovid Occupancy'</span>),</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'PostCovid Occupancy'</span>)</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-13a8be463c5fb2457ee4" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-13a8be463c5fb2457ee4">{"x":{"visdat":{"157986fdd31a2":["function () ","plotlyVisDat"]},"cur_data":"157986fdd31a2","attrs":{"157986fdd31a2":{"x":{},"y":{},"mode":"markers","text":{},"hoverinfo":"text","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Monthly Pre- and Post-Covid Occupancy Rate (%)","xaxis":{"domain":[0,1],"automargin":true,"title":"PreCovid Occupancy"},"yaxis":{"domain":[0,1],"automargin":true,"title":"PostCovid Occupancy"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[56.378450927001744,64.486294301515571,82.619240433379687,59.524374151876337,61.704128661138867,56.523389470640581,72.862603537349088,59.22747763961479,60.593892847378015,75.28213446387214,56.868580156632461,80.645887236424841,60.16266284078521,53.363397183308905,48.677618459847437,70.364037686191935,57.662918839023661,69.355554986097459,62.693837696394169,55.440464746630667,62.050409714604982,55.068746145108108,50.458332148698496,49.638232127152897,57.134700978916818,62.290815396393114,69.322365591787374,57.988670558300015,66.965244038174134,53.670989250706334,57.290576274627114,62.232642991123001,62.307090400906404,51.794713447391452,62.554780796415741,64.851795356273655,54.164230224519152,62.695182994968803,65.435278503576129,65.086772135852357,49.398788800474023,57.146535134933906,69.16116923162879,50.638744245207455,58.99716429709774,63.004397594900993,53.775091655664845,77.413165890536234,58.01803860891566,50.723213325341874,57.428496991328792,57.931574110312646,70.014620221163185,49.924200086886131,55.388349156364939,56.652155324578466,62.941854274514434,57.916326628602746,64.699134118683219,57.585878424831591,62.679800946095952,59.059305432588502,58.998547042952374,72.130401311610356,61.64581401937852,79.814130170655147,68.199365659144988,57.899987642145369,65.537492529276363,63.381599869506289,66.505510968576161,62.912593605755575,73.028736277246935,48.202758845017414,54.002491014331234,51.347188831683674,53.999603776050996],"y":[31.96744627152464,31.314679851808581,47.644423258370793,48.258578077495223,60.01477393774222,31.996382390878331,38.659557814191231,35.584566233293899,50.714399230847732,58.049684291707983,68.535649635863209,54.577143206808465,41.92835752160228,41.505839664933525,33.067865116425835,58.965016190009869,49.643376823005944,26.754579191084975,55.380001994977178,52.597874231831931,47.509969150165027,45.133825761556281,45.367371768548786,38.441261450382399,44.943008544363352,54.770572735610948,43.578776631905832,64.408843815878711,52.801920338257368,44.314345695017359,39.751872028609249,73.515713728463567,32.106190873252771,27.492513750844015,49.618111325757077,41.63513770416791,29.286188050657884,32.957779515157718,36.331150788090085,34.876814574791354,61.187303745130464,49.192573549406951,60.329098757318732,41.408633940275635,45.909219693851043,52.180015674234191,61.152003245881325,47.846795040172587,37.227577493298838,60.529381678287244,36.346355369642133,51.384414850649094,53.591211845795868,33.091738234661761,40.938860151004839,44.69697090623027,34.283216022827652,26.911526438463806,45.581110025838896,44.672780793515649,48.882555839945923,36.503627359045893,42.442349854616396,32.797053363291212,32.552448335977182,50.445039230240639,43.560790930463824,39.711733360878995,48.309945180998312,41.77254133646138,40.557646984450017,40.408990508252344,48.73077008737895,38.865969628032012,38.596623225877124,56.279637136185542,36.418838605517756],"mode":"markers","text":["Province: Amnat Charoen <br>PreCovid Occupancy: 56 <br>PostCovid Occupancy: 32","Province: Ang Thong <br>PreCovid Occupancy: 64 <br>PostCovid Occupancy: 31","Province: Bangkok <br>PreCovid Occupancy: 83 <br>PostCovid Occupancy: 48","Province: Bueng Kan <br>PreCovid Occupancy: 60 <br>PostCovid Occupancy: 48","Province: Buriram <br>PreCovid Occupancy: 62 <br>PostCovid Occupancy: 60","Province: Chachoengsao <br>PreCovid Occupancy: 57 <br>PostCovid Occupancy: 32","Province: Chainat <br>PreCovid Occupancy: 73 <br>PostCovid Occupancy: 39","Province: Chaiyaphum <br>PreCovid Occupancy: 59 <br>PostCovid Occupancy: 36","Province: Chanthaburi <br>PreCovid Occupancy: 61 <br>PostCovid Occupancy: 51","Province: Chiang Mai <br>PreCovid Occupancy: 75 <br>PostCovid Occupancy: 58","Province: Chiang Rai <br>PreCovid Occupancy: 57 <br>PostCovid Occupancy: 69","Province: Chonburi <br>PreCovid Occupancy: 81 <br>PostCovid Occupancy: 55","Province: Chumphon <br>PreCovid Occupancy: 60 <br>PostCovid Occupancy: 42","Province: Kalasin <br>PreCovid Occupancy: 53 <br>PostCovid Occupancy: 42","Province: Kamphaeng Phet <br>PreCovid Occupancy: 49 <br>PostCovid Occupancy: 33","Province: Kanchanaburi <br>PreCovid Occupancy: 70 <br>PostCovid Occupancy: 59","Province: Khon Kaen <br>PreCovid Occupancy: 58 <br>PostCovid Occupancy: 50","Province: Krabi <br>PreCovid Occupancy: 69 <br>PostCovid Occupancy: 27","Province: Lampang <br>PreCovid Occupancy: 63 <br>PostCovid Occupancy: 55","Province: Lamphun <br>PreCovid Occupancy: 55 <br>PostCovid Occupancy: 53","Province: Loei <br>PreCovid Occupancy: 62 <br>PostCovid Occupancy: 48","Province: Lopburi <br>PreCovid Occupancy: 55 <br>PostCovid Occupancy: 45","Province: Mae Hong Son <br>PreCovid Occupancy: 50 <br>PostCovid Occupancy: 45","Province: Maha Sarakham <br>PreCovid Occupancy: 50 <br>PostCovid Occupancy: 38","Province: Mukdahan <br>PreCovid Occupancy: 57 <br>PostCovid Occupancy: 45","Province: Nakhon Nayok <br>PreCovid Occupancy: 62 <br>PostCovid Occupancy: 55","Province: Nakhon Pathom <br>PreCovid Occupancy: 69 <br>PostCovid Occupancy: 44","Province: Nakhon Phanom <br>PreCovid Occupancy: 58 <br>PostCovid Occupancy: 64","Province: Nakhon Ratchasima <br>PreCovid Occupancy: 67 <br>PostCovid Occupancy: 53","Province: Nakhon Sawan <br>PreCovid Occupancy: 54 <br>PostCovid Occupancy: 44","Province: Nakhon Si Thammarat <br>PreCovid Occupancy: 57 <br>PostCovid Occupancy: 40","Province: Nan <br>PreCovid Occupancy: 62 <br>PostCovid Occupancy: 74","Province: Narathiwat <br>PreCovid Occupancy: 62 <br>PostCovid Occupancy: 32","Province: Nong Bua Lamphu <br>PreCovid Occupancy: 52 <br>PostCovid Occupancy: 27","Province: Nong Khai <br>PreCovid Occupancy: 63 <br>PostCovid Occupancy: 50","Province: Nonthaburi <br>PreCovid Occupancy: 65 <br>PostCovid Occupancy: 42","Province: Pathum Thani <br>PreCovid Occupancy: 54 <br>PostCovid Occupancy: 29","Province: Pattani <br>PreCovid Occupancy: 63 <br>PostCovid Occupancy: 33","Province: Phang Nga <br>PreCovid Occupancy: 65 <br>PostCovid Occupancy: 36","Province: Phatthalung <br>PreCovid Occupancy: 65 <br>PostCovid Occupancy: 35","Province: Phayao <br>PreCovid Occupancy: 49 <br>PostCovid Occupancy: 61","Province: Phetchabun <br>PreCovid Occupancy: 57 <br>PostCovid Occupancy: 49","Province: Phetchaburi <br>PreCovid Occupancy: 69 <br>PostCovid Occupancy: 60","Province: Phichit <br>PreCovid Occupancy: 51 <br>PostCovid Occupancy: 41","Province: Phitsanulok <br>PreCovid Occupancy: 59 <br>PostCovid Occupancy: 46","Province: Phra Nakhon Si Ayutthaya <br>PreCovid Occupancy: 63 <br>PostCovid Occupancy: 52","Province: Phrae <br>PreCovid Occupancy: 54 <br>PostCovid Occupancy: 61","Province: Phuket <br>PreCovid Occupancy: 77 <br>PostCovid Occupancy: 48","Province: Prachinburi <br>PreCovid Occupancy: 58 <br>PostCovid Occupancy: 37","Province: Prachuap Khiri Khan <br>PreCovid Occupancy: 51 <br>PostCovid Occupancy: 61","Province: Ranong <br>PreCovid Occupancy: 57 <br>PostCovid Occupancy: 36","Province: Ratchaburi <br>PreCovid Occupancy: 58 <br>PostCovid Occupancy: 51","Province: Rayong <br>PreCovid Occupancy: 70 <br>PostCovid Occupancy: 54","Province: Roi Et <br>PreCovid Occupancy: 50 <br>PostCovid Occupancy: 33","Province: Sa Kaeo <br>PreCovid Occupancy: 55 <br>PostCovid Occupancy: 41","Province: Sakon Nakhon <br>PreCovid Occupancy: 57 <br>PostCovid Occupancy: 45","Province: Samut Prakan <br>PreCovid Occupancy: 63 <br>PostCovid Occupancy: 34","Province: Samut Sakhon <br>PreCovid Occupancy: 58 <br>PostCovid Occupancy: 27","Province: Samut Songkhram <br>PreCovid Occupancy: 65 <br>PostCovid Occupancy: 46","Province: Saraburi <br>PreCovid Occupancy: 58 <br>PostCovid Occupancy: 45","Province: Satun <br>PreCovid Occupancy: 63 <br>PostCovid Occupancy: 49","Province: Sing Buri <br>PreCovid Occupancy: 59 <br>PostCovid Occupancy: 37","Province: Sisaket <br>PreCovid Occupancy: 59 <br>PostCovid Occupancy: 42","Province: Songkhla <br>PreCovid Occupancy: 72 <br>PostCovid Occupancy: 33","Province: Sukhothai <br>PreCovid Occupancy: 62 <br>PostCovid Occupancy: 33","Province: Suphan Buri <br>PreCovid Occupancy: 80 <br>PostCovid Occupancy: 50","Province: Surat Thani <br>PreCovid Occupancy: 68 <br>PostCovid Occupancy: 44","Province: Surin <br>PreCovid Occupancy: 58 <br>PostCovid Occupancy: 40","Province: Tak <br>PreCovid Occupancy: 66 <br>PostCovid Occupancy: 48","Province: Trang <br>PreCovid Occupancy: 63 <br>PostCovid Occupancy: 42","Province: Trat <br>PreCovid Occupancy: 67 <br>PostCovid Occupancy: 41","Province: Ubon Ratchathani <br>PreCovid Occupancy: 63 <br>PostCovid Occupancy: 40","Province: Udon Thani <br>PreCovid Occupancy: 73 <br>PostCovid Occupancy: 49","Province: Uthai Thani <br>PreCovid Occupancy: 48 <br>PostCovid Occupancy: 39","Province: Uttaradit <br>PreCovid Occupancy: 54 <br>PostCovid Occupancy: 39","Province: Yala <br>PreCovid Occupancy: 51 <br>PostCovid Occupancy: 56","Province: Yasothon <br>PreCovid Occupancy: 54 <br>PostCovid Occupancy: 36"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>The occupancy rates are showing a dispersed pattern as the overall rankings on occupancy rates have significantly changed pre- and post-covid. Bangkok, Chonburi and Suphan Buri reported the highest occupancy rates before covid, but Nan, Chang Rai and Nakhon Phanom have the highest rates post covid.</p>
<p>The next visualization for this measure is a side-by-side map for the pre- and post-covid occupancy rates as well as the recovery rate for occupancy. We use the code chunk below which uses <strong>tmap</strong> package to produce the maps.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(thaitourism_sf) <span class="sc">+</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="fu">c</span>(<span class="st">"PreCovid_occupancy"</span>, <span class="st">"PostCovid_occupancy"</span>, <span class="st">"Occupancy_recovery"</span>),</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"quantile"</span>,</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="fu">list</span>(<span class="st">"viridis"</span>, <span class="st">"viridis"</span>, <span class="st">"RdYlGn"</span>),</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="fu">c</span>(<span class="st">"Average Occupancy Rate"</span>, <span class="st">"Average Occupancy Rate"</span>, <span class="st">"Post vs Pre"</span>)) <span class="sc">+</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">title =</span> <span class="fu">c</span>(<span class="st">"Pre Covid"</span>, <span class="st">"Post Covid"</span>, <span class="st">"Recovery Rate"</span>),</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">title.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"top"</span>),</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>),</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">bg.color =</span> <span class="st">"grey90"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="1440"></p>
</figure>
</div>
</div>
</div>
<p>Before we leave this section, let us try to understand occupancy rate a bit more. Going back to earlier, we want to understand if high occupancy rate post-Covid is being driven by the number of available rooms. To help us answer this, we create a scatterplot of the available rooms against the occupancy rate post-Covid using the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> occupancy_summary,</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="sc">~</span>PostCovid_total_rooms,</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="sc">~</span>PostCovid_occupancy,</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'scatter'</span>,</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">'markers'</span>,</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">text =</span> <span class="sc">~</span><span class="fu">paste</span>(<span class="st">'Province:'</span>, Province, <span class="st">'&lt;br&gt;Number of Rooms:'</span>, <span class="fu">round</span>(PostCovid_total_rooms), <span class="st">'&lt;br&gt;Occupancy Rate:'</span>, <span class="fu">round</span>(PostCovid_occupancy)),</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">hoverinfo =</span> <span class="st">'text'</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'Post-Covid Number of Rooms and Occupancy Rate (%)'</span>,</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Number of Rooms'</span>),</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Occupancy Rate'</span>)</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-9acb472f3bc023769b12" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-9acb472f3bc023769b12">{"x":{"visdat":{"1579841134227":["function () ","plotlyVisDat"]},"cur_data":"1579841134227","attrs":{"1579841134227":{"x":{},"y":{},"mode":"markers","text":{},"hoverinfo":"text","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Post-Covid Number of Rooms and Occupancy Rate (%)","xaxis":{"domain":[0,1],"automargin":true,"title":"Number of Rooms"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Occupancy Rate"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[285183.86869459489,371697.87636605056,49674092.750911586,964609.85496189597,3044333.7200525571,1164431.6393287499,608157.49918819545,2197958.5050223656,2565930.0311862295,13870838.572588366,7074251.1754976446,24090427.287809763,2699132.6798740588,730309.28285518754,1402848.3494979856,6658980.6188592901,4553376.7939663054,5342304.1707801092,1357462.9341259014,567431.67734215304,2914504.1025462132,1955912.1902578117,2847855.0765325245,881984.58429263462,1246943.669662911,2397982.9576367671,2453164.3213162106,1227514.6597261019,9640096.3589802496,2522851.1951733604,4385843.7628930863,1793431.5442679643,994652.40601320274,399523.30658242543,2120449.5130668832,2261563.3138778838,1422957.4681387686,641053.50271801814,2162565.6852509053,1312837.7851655886,933540.07291988109,4808099.7381128361,7696702.0818236554,1039870.0923605831,4150917.860743423,2218606.0794374994,1081328.4355399043,13830082.024185941,2288639.383407006,10714748.474502372,1271131.576471319,2173271.8047793307,5281886.5304723596,1110733.4325973855,1392654.7976592996,1778062.324776514,2517185.0838771537,1137211.5985311971,2038254.4424068162,2563914.7141837501,2231427.9220004193,553298.43802481517,949615.18714346585,6290275.4620910054,2018133.9149041278,2119106.2913460252,8082500.1676858012,2189733.1755773863,3457648.3035567827,2204670.7490983955,4216105.0434104418,3145361.9207350253,3408335.2202762906,934285.19467092131,1672255.0991643965,1788765.9750967466,427613.85580375238],"y":[31.96744627152464,31.314679851808581,47.644423258370793,48.258578077495223,60.01477393774222,31.996382390878331,38.659557814191231,35.584566233293899,50.714399230847732,58.049684291707983,68.535649635863209,54.577143206808465,41.92835752160228,41.505839664933525,33.067865116425835,58.965016190009869,49.643376823005944,26.754579191084975,55.380001994977178,52.597874231831931,47.509969150165027,45.133825761556281,45.367371768548786,38.441261450382399,44.943008544363352,54.770572735610948,43.578776631905832,64.408843815878711,52.801920338257368,44.314345695017359,39.751872028609249,73.515713728463567,32.106190873252771,27.492513750844015,49.618111325757077,41.63513770416791,29.286188050657884,32.957779515157718,36.331150788090085,34.876814574791354,61.187303745130464,49.192573549406951,60.329098757318732,41.408633940275635,45.909219693851043,52.180015674234191,61.152003245881325,47.846795040172587,37.227577493298838,60.529381678287244,36.346355369642133,51.384414850649094,53.591211845795868,33.091738234661761,40.938860151004839,44.69697090623027,34.283216022827652,26.911526438463806,45.581110025838896,44.672780793515649,48.882555839945923,36.503627359045893,42.442349854616396,32.797053363291212,32.552448335977182,50.445039230240639,43.560790930463824,39.711733360878995,48.309945180998312,41.77254133646138,40.557646984450017,40.408990508252344,48.73077008737895,38.865969628032012,38.596623225877124,56.279637136185542,36.418838605517756],"mode":"markers","text":["Province: Amnat Charoen <br>Number of Rooms: 285184 <br>Occupancy Rate: 32","Province: Ang Thong <br>Number of Rooms: 371698 <br>Occupancy Rate: 31","Province: Bangkok <br>Number of Rooms: 49674093 <br>Occupancy Rate: 48","Province: Bueng Kan <br>Number of Rooms: 964610 <br>Occupancy Rate: 48","Province: Buriram <br>Number of Rooms: 3044334 <br>Occupancy Rate: 60","Province: Chachoengsao <br>Number of Rooms: 1164432 <br>Occupancy Rate: 32","Province: Chainat <br>Number of Rooms: 608157 <br>Occupancy Rate: 39","Province: Chaiyaphum <br>Number of Rooms: 2197959 <br>Occupancy Rate: 36","Province: Chanthaburi <br>Number of Rooms: 2565930 <br>Occupancy Rate: 51","Province: Chiang Mai <br>Number of Rooms: 13870839 <br>Occupancy Rate: 58","Province: Chiang Rai <br>Number of Rooms: 7074251 <br>Occupancy Rate: 69","Province: Chonburi <br>Number of Rooms: 24090427 <br>Occupancy Rate: 55","Province: Chumphon <br>Number of Rooms: 2699133 <br>Occupancy Rate: 42","Province: Kalasin <br>Number of Rooms: 730309 <br>Occupancy Rate: 42","Province: Kamphaeng Phet <br>Number of Rooms: 1402848 <br>Occupancy Rate: 33","Province: Kanchanaburi <br>Number of Rooms: 6658981 <br>Occupancy Rate: 59","Province: Khon Kaen <br>Number of Rooms: 4553377 <br>Occupancy Rate: 50","Province: Krabi <br>Number of Rooms: 5342304 <br>Occupancy Rate: 27","Province: Lampang <br>Number of Rooms: 1357463 <br>Occupancy Rate: 55","Province: Lamphun <br>Number of Rooms: 567432 <br>Occupancy Rate: 53","Province: Loei <br>Number of Rooms: 2914504 <br>Occupancy Rate: 48","Province: Lopburi <br>Number of Rooms: 1955912 <br>Occupancy Rate: 45","Province: Mae Hong Son <br>Number of Rooms: 2847855 <br>Occupancy Rate: 45","Province: Maha Sarakham <br>Number of Rooms: 881985 <br>Occupancy Rate: 38","Province: Mukdahan <br>Number of Rooms: 1246944 <br>Occupancy Rate: 45","Province: Nakhon Nayok <br>Number of Rooms: 2397983 <br>Occupancy Rate: 55","Province: Nakhon Pathom <br>Number of Rooms: 2453164 <br>Occupancy Rate: 44","Province: Nakhon Phanom <br>Number of Rooms: 1227515 <br>Occupancy Rate: 64","Province: Nakhon Ratchasima <br>Number of Rooms: 9640096 <br>Occupancy Rate: 53","Province: Nakhon Sawan <br>Number of Rooms: 2522851 <br>Occupancy Rate: 44","Province: Nakhon Si Thammarat <br>Number of Rooms: 4385844 <br>Occupancy Rate: 40","Province: Nan <br>Number of Rooms: 1793432 <br>Occupancy Rate: 74","Province: Narathiwat <br>Number of Rooms: 994652 <br>Occupancy Rate: 32","Province: Nong Bua Lamphu <br>Number of Rooms: 399523 <br>Occupancy Rate: 27","Province: Nong Khai <br>Number of Rooms: 2120450 <br>Occupancy Rate: 50","Province: Nonthaburi <br>Number of Rooms: 2261563 <br>Occupancy Rate: 42","Province: Pathum Thani <br>Number of Rooms: 1422957 <br>Occupancy Rate: 29","Province: Pattani <br>Number of Rooms: 641054 <br>Occupancy Rate: 33","Province: Phang Nga <br>Number of Rooms: 2162566 <br>Occupancy Rate: 36","Province: Phatthalung <br>Number of Rooms: 1312838 <br>Occupancy Rate: 35","Province: Phayao <br>Number of Rooms: 933540 <br>Occupancy Rate: 61","Province: Phetchabun <br>Number of Rooms: 4808100 <br>Occupancy Rate: 49","Province: Phetchaburi <br>Number of Rooms: 7696702 <br>Occupancy Rate: 60","Province: Phichit <br>Number of Rooms: 1039870 <br>Occupancy Rate: 41","Province: Phitsanulok <br>Number of Rooms: 4150918 <br>Occupancy Rate: 46","Province: Phra Nakhon Si Ayutthaya <br>Number of Rooms: 2218606 <br>Occupancy Rate: 52","Province: Phrae <br>Number of Rooms: 1081328 <br>Occupancy Rate: 61","Province: Phuket <br>Number of Rooms: 13830082 <br>Occupancy Rate: 48","Province: Prachinburi <br>Number of Rooms: 2288639 <br>Occupancy Rate: 37","Province: Prachuap Khiri Khan <br>Number of Rooms: 10714748 <br>Occupancy Rate: 61","Province: Ranong <br>Number of Rooms: 1271132 <br>Occupancy Rate: 36","Province: Ratchaburi <br>Number of Rooms: 2173272 <br>Occupancy Rate: 51","Province: Rayong <br>Number of Rooms: 5281887 <br>Occupancy Rate: 54","Province: Roi Et <br>Number of Rooms: 1110733 <br>Occupancy Rate: 33","Province: Sa Kaeo <br>Number of Rooms: 1392655 <br>Occupancy Rate: 41","Province: Sakon Nakhon <br>Number of Rooms: 1778062 <br>Occupancy Rate: 45","Province: Samut Prakan <br>Number of Rooms: 2517185 <br>Occupancy Rate: 34","Province: Samut Sakhon <br>Number of Rooms: 1137212 <br>Occupancy Rate: 27","Province: Samut Songkhram <br>Number of Rooms: 2038254 <br>Occupancy Rate: 46","Province: Saraburi <br>Number of Rooms: 2563915 <br>Occupancy Rate: 45","Province: Satun <br>Number of Rooms: 2231428 <br>Occupancy Rate: 49","Province: Sing Buri <br>Number of Rooms: 553298 <br>Occupancy Rate: 37","Province: Sisaket <br>Number of Rooms: 949615 <br>Occupancy Rate: 42","Province: Songkhla <br>Number of Rooms: 6290275 <br>Occupancy Rate: 33","Province: Sukhothai <br>Number of Rooms: 2018134 <br>Occupancy Rate: 33","Province: Suphan Buri <br>Number of Rooms: 2119106 <br>Occupancy Rate: 50","Province: Surat Thani <br>Number of Rooms: 8082500 <br>Occupancy Rate: 44","Province: Surin <br>Number of Rooms: 2189733 <br>Occupancy Rate: 40","Province: Tak <br>Number of Rooms: 3457648 <br>Occupancy Rate: 48","Province: Trang <br>Number of Rooms: 2204671 <br>Occupancy Rate: 42","Province: Trat <br>Number of Rooms: 4216105 <br>Occupancy Rate: 41","Province: Ubon Ratchathani <br>Number of Rooms: 3145362 <br>Occupancy Rate: 40","Province: Udon Thani <br>Number of Rooms: 3408335 <br>Occupancy Rate: 49","Province: Uthai Thani <br>Number of Rooms: 934285 <br>Occupancy Rate: 39","Province: Uttaradit <br>Number of Rooms: 1672255 <br>Occupancy Rate: 39","Province: Yala <br>Number of Rooms: 1788766 <br>Occupancy Rate: 56","Province: Yasothon <br>Number of Rooms: 427614 <br>Occupancy Rate: 36"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Below 10M rooms, there appears to be an upward trend in occupancy rate to the number of rooms. Provinces with more than 10M rooms go against the trend and appear to be capped to 60% occupancy.</p>
</section>
</section>
<section id="d.-testing-for-global-spatial-autocorrelation" class="level1">
<h1>D. Testing for Global Spatial Autocorrelation</h1>
<p>Testing for spatial autocorrelation allows us to statistically determine if any of the indicator variables are dependent on space or location. These techniques also are useful for classifying clusters and outliers for particular variables of concern.</p>
<section id="d.1-variable-selection" class="level2">
<h2 class="anchored" data-anchor-id="d.1-variable-selection">D.1 Variable Selection</h2>
<p>We will turn our attention to the first three measures discussed discussed in the previous section: <strong>tourism revenue, number of tourists</strong> and <strong>average tourist spending</strong>. We will not analyse the occupancy rate further as it is highly dependent on the number of rooms.</p>
<p>We will focus on checking signs of spatial autocorrelation or association before and after covid, as well as the recovery rate at the overall level for these three indicators– so we will be looking at 9 variables for our analysis.</p>
</section>
<section id="d.2-deriving-the-contiguity-and-weight-matrix" class="level2">
<h2 class="anchored" data-anchor-id="d.2-deriving-the-contiguity-and-weight-matrix">D.2 Deriving the Contiguity and Weight Matrix</h2>
<p>For the tests for this section, we need to derive a neighbor list as well as a weight matrix for each province to its neighbors. Given the presence of islands, we need to use distance rather than contiguity to define neighbors.</p>
<p>The first step is to understand the distribution of distances between nearest neighbors to find a proper cut-off distance. The code chunk below</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>longitude <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(thaitourism_sf<span class="sc">$</span>geometry, <span class="sc">~</span><span class="fu">st_centroid</span>(.x)[[<span class="dv">1</span>]])</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>latitude <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(thaitourism_sf<span class="sc">$</span>geometry, <span class="sc">~</span><span class="fu">st_centroid</span>(.x)[[<span class="dv">2</span>]])</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">cbind</span>(longitude, latitude)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>k1 <span class="ot">&lt;-</span> <span class="fu">knn2nb</span>(<span class="fu">knearneigh</span>(coords))</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>k1dists <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">nbdists</span>(k1, coords, <span class="at">longlat =</span> <span class="cn">TRUE</span>))</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(k1dists)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  21.55   51.92   64.33   63.24   76.77  110.94 </code></pre>
</div>
</div>
<p>The maximum distance is 110.94 so setting a distance threshold of 111 should ensure that each province should have at least one neighbor. We then produce a nearest neighbor list for each province using <code>dnearneigh()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>wm_d111 <span class="ot">&lt;-</span> <span class="fu">dnearneigh</span>(coords, <span class="dv">0</span>, <span class="dv">111</span>, <span class="at">longlat =</span> <span class="cn">TRUE</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>wm_d111</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Neighbour list object:
Number of regions: 77 
Number of nonzero links: 350 
Percentage nonzero weights: 5.903188 
Average number of links: 4.545455 
2 disjoint connected subgraphs</code></pre>
</div>
</div>
<p>We import this as a new column in our sf object and compute for weights using <code>st_weights()</code> based on this.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>wm_thai <span class="ot">&lt;-</span> thaitourism_sf <span class="sc">%&gt;%</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nb =</span> <span class="fu">I</span>(wm_d111),</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">wt =</span> <span class="fu">st_weights</span>(nb,</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">style=</span><span class="st">"W"</span>),</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">.before=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="d.3-global-morans-i-test" class="level2">
<h2 class="anchored" data-anchor-id="d.3-global-morans-i-test">D.3 Global Moran’s I Test</h2>
<p>Global tests of spatial autocorrelation compares the value of each point/province to the overall value in order to conclude on spatial dependence. For this, we will focus on using Global Moran’s I which will work on the following general hypotheses:</p>
<ul>
<li><p><span class="math inline">\(H_0\)</span> - The value of (variable) is randomly distributed across provinces in Thailand</p></li>
<li><p><span class="math inline">\(H_1\)</span> - The value of (variable) is not randomly distributed across provinces in Thailand</p></li>
</ul>
<p>Further, the value of the test statistic <span class="math inline">\(I\)</span> will also give indication on the underlying pattern:</p>
<ul>
<li><p><span class="math inline">\(I &gt; 0\)</span> - Clustering; observations tend to be similar</p></li>
<li><p><span class="math inline">\(I &lt; 0\)</span> - Dispersed / regular; observations tend to be dissimilar</p></li>
<li><p>Where <span class="math inline">\(I\)</span> close to zero - observations are arranged randomly</p></li>
</ul>
<p>To perform Global Moran’s I test, with permutations, we use <code>global_moran_perm()</code> from <strong>sfdep</strong> package. We will use a 5% significance level for all the testing to be performed, and we will run 100 permutations / simulations for each test.</p>
<section id="d.3.1-global-morans-test-on-tourism-revenue" class="level3">
<h3 class="anchored" data-anchor-id="d.3.1-global-morans-test-on-tourism-revenue">D.3.1 Global Moran’s Test on Tourism Revenue</h3>
<p>The code chunks in the tabs below run the Global Moran’s I permutation test on total tourism revenue (per month) pre-Covid, post-Covid and the recovery rate.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Pre-Covid Revenue</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Post-Covid Revenue</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Revenue Recovery Rate</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">global_moran_perm</span>(wm_thai<span class="sc">$</span>PreCovid_Revenue_total,</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>                  wm_thai<span class="sc">$</span>nb,</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>                  wm_thai<span class="sc">$</span>wt,</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nsim =</span> <span class="dv">99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Moran I

data:  x 
weights: listw  
number of simulations + 1: 100 

statistic = 0.049413, observed rank = 93, p-value = 0.14
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">global_moran_perm</span>(wm_thai<span class="sc">$</span>PostCovid_Revenue_total,</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>                  wm_thai<span class="sc">$</span>nb,</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>                  wm_thai<span class="sc">$</span>wt,</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nsim =</span> <span class="dv">99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Moran I

data:  x 
weights: listw  
number of simulations + 1: 100 

statistic = 0.020361, observed rank = 84, p-value = 0.32
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">global_moran_perm</span>(wm_thai<span class="sc">$</span>Revenue_total_recovery,</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>                  wm_thai<span class="sc">$</span>nb,</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>                  wm_thai<span class="sc">$</span>wt,</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nsim =</span> <span class="dv">99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Moran I

data:  x 
weights: listw  
number of simulations + 1: 100 

statistic = 0.43763, observed rank = 100, p-value &lt; 2.2e-16
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>The results show no evidence to reject spatial independence for the total revenue pre- and post-Covid. However, it shows <strong>signs of clustering for the revenue recovery rate</strong> as the p-value is below 0.05 and the statistic is above 1.</p>
</section>
<section id="d.3.2-global-morans-test-on-number-of-tourists" class="level3">
<h3 class="anchored" data-anchor-id="d.3.2-global-morans-test-on-number-of-tourists">D.3.2 Global Moran’s Test on Number of Tourists</h3>
<p>The code chunks in the tabs below run the Global Moran’s I permutation test on total number of tourists (per month) pre-Covid, post-Covid and the recovery rate.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Pre-Covid Number of Tourists</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Post-Covid Number of Tourists</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Number of Tourists Recovery Rate</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">global_moran_perm</span>(wm_thai<span class="sc">$</span>PreCovid_tourists_total,</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>                  wm_thai<span class="sc">$</span>nb,</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>                  wm_thai<span class="sc">$</span>wt,</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nsim =</span> <span class="dv">99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Moran I

data:  x 
weights: listw  
number of simulations + 1: 100 

statistic = 0.062493, observed rank = 92, p-value = 0.16
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">global_moran_perm</span>(wm_thai<span class="sc">$</span>PostCovid_tourists_total,</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>                  wm_thai<span class="sc">$</span>nb,</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>                  wm_thai<span class="sc">$</span>wt,</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nsim =</span> <span class="dv">99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Moran I

data:  x 
weights: listw  
number of simulations + 1: 100 

statistic = 0.10696, observed rank = 95, p-value = 0.1
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">global_moran_perm</span>(wm_thai<span class="sc">$</span>Tourists_total_recovery,</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>                  wm_thai<span class="sc">$</span>nb,</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>                  wm_thai<span class="sc">$</span>wt,</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nsim =</span> <span class="dv">99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Moran I

data:  x 
weights: listw  
number of simulations + 1: 100 

statistic = 0.27768, observed rank = 100, p-value &lt; 2.2e-16
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>We see similar results here. The results show no evidence to reject spatial independence for the total number of tourists pre- and post-Covid. However, it shows <strong>signs of clustering for the number of tourists recovery rate</strong> as the p-value is below 0.05 and the statistic is above 1.</p>
</section>
<section id="d.3.3-global-morans-test-on-average-tourist-spend" class="level3">
<h3 class="anchored" data-anchor-id="d.3.3-global-morans-test-on-average-tourist-spend">D.3.3 Global Moran’s Test on Average Tourist Spend</h3>
<p>The code chunks in the tabs below run the Global Moran’s I permutation test on average tourist spend pre-Covid, post-Covid and the recovery rate.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Pre-Covid Average Spend</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Post-Covid Average Spend</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">Average Spend Recovery Rate</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">global_moran_perm</span>(wm_thai<span class="sc">$</span>PreCovidSpend_total,</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>                  wm_thai<span class="sc">$</span>nb,</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>                  wm_thai<span class="sc">$</span>wt,</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nsim =</span> <span class="dv">99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Moran I

data:  x 
weights: listw  
number of simulations + 1: 100 

statistic = 0.423, observed rank = 100, p-value &lt; 2.2e-16
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">global_moran_perm</span>(wm_thai<span class="sc">$</span>PostCovidSpend_total,</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>                  wm_thai<span class="sc">$</span>nb,</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>                  wm_thai<span class="sc">$</span>wt,</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nsim =</span> <span class="dv">99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Moran I

data:  x 
weights: listw  
number of simulations + 1: 100 

statistic = 0.20651, observed rank = 100, p-value &lt; 2.2e-16
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">global_moran_perm</span>(wm_thai<span class="sc">$</span>Spend_total_recovery,</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>                  wm_thai<span class="sc">$</span>nb,</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>                  wm_thai<span class="sc">$</span>wt,</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nsim =</span> <span class="dv">99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Moran I

data:  x 
weights: listw  
number of simulations + 1: 100 

statistic = 0.31497, observed rank = 100, p-value &lt; 2.2e-16
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Average tourist spending is showing signs of clustering on all dimensions (pre-Covid, post-Covid and the recovery rate) as the p-value is below 0.05 and the I statistic is above 0 in all cases.</p>
</section>
<section id="d.3.3-global-morans-test-summary" class="level3">
<h3 class="anchored" data-anchor-id="d.3.3-global-morans-test-summary">D.3.3 Global Moran’s Test Summary</h3>
<p>Based on the results of the testing on the total revenue, number of tourists and spend, we see that the following variables are not exhibiting a random distribution, and show signs of clustering:</p>
<ol type="1">
<li><p>Total tourism revenue recovery rate</p></li>
<li><p>Total number of tourists recovery rate</p></li>
<li><p>Pre-Covid Average spend per Tourist</p></li>
<li><p>Post-Covid Average spend per Tourist</p></li>
<li><p>Average spend per tourist recovery rate</p></li>
</ol>
<p>We will conduct tests for local association to identify the clusters and outliers among provinces for each of these variables.</p>
</section>
</section>
</section>
<section id="e.-testing-for-local-spatial-association" class="level1">
<h1>E. Testing for Local Spatial Association</h1>
<p>In this section, we compute for LISA or local indicators of spatial association which allow us to identify clusters or outliers in the data for the five variables mentioned above.</p>
<p>The measure we will be using is Local Moran I using <code>local_moran()</code> which is also included in <strong>sfdep</strong> package. The local version computes for a test statistic and p-value for each observation/province. For each variable, we will perform the following steps:</p>
<ol type="1">
<li><p>Run local Moran I for the variable</p></li>
<li><p>Observe and visualize test statistic (I) and p values (simulated)</p></li>
<li><p>Generate and analyse the LISA map to identify statistically significant clusters and outliers</p></li>
</ol>
<section id="e.1-analysing-lisa-total-tourism-recovery-rate" class="level2">
<h2 class="anchored" data-anchor-id="e.1-analysing-lisa-total-tourism-recovery-rate">E.1 Analysing LISA: Total tourism recovery rate</h2>
<p>We first compute for the LISA for the recovery rate of the total number of tourists using <code>local_moran()</code> function in the code chunk below. The code below uses 100 simulations to produce the test results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>lisa <span class="ot">&lt;-</span> wm_thai <span class="sc">%&gt;%</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">local_moran =</span> <span class="fu">local_moran</span>(</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>    Revenue_total_recovery, nb, wt, <span class="at">nsim =</span> <span class="dv">99</span>),</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(local_moran)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can then visualize the test statistic and p-values for each province in a map using tmap package in the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>tmap mode set to plotting</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(lisa) <span class="sc">+</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="fu">c</span>(<span class="st">"ii"</span>, <span class="st">"p_ii_sim"</span>), <span class="at">title =</span> <span class="fu">c</span>(<span class="st">"Local Moran's I"</span>,<span class="st">"P Value"</span>)) <span class="sc">+</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_view</span>(<span class="at">set.zoom.limits =</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title =</span> <span class="st">"LISA for Total Revenue Recovery Rate"</span>,</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>),</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">bg.color =</span> <span class="st">"grey90"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Variable(s) "ii" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Outliers are generally provinces where the test statistic is negative, and clusters where it is positive– if they are significant. We see some potential outliers. We can produce a different set of plots to allow us to identify these types of provinces.</p>
<p>Using a LISA map, we can show graphically the location of clusters and outliers based on this (tourism revenue recovery rate)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>lisa_sig <span class="ot">&lt;-</span> lisa <span class="sc">%&gt;%</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p_ii_sim <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(lisa) <span class="sc">+</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(lisa_sig) <span class="sc">+</span></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"mean"</span>, <span class="at">title =</span> <span class="st">"LISA Class α=5% "</span>) <span class="sc">+</span></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(<span class="st">"Province"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_layout</span>(</span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title =</span> <span class="st">"Revenue Recovery Rate"</span>,</span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>),</span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">bg.color =</span> <span class="st">"beige"</span>,</span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">asp =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: One tm layer group has duplicated layer types, which are omitted. To
draw multiple layers of the same type, use multiple layer groups (i.e. specify
tm_shape prior to each of them).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can also observe the contents of the object <code>lisa_sig</code> to see the statistics for the identified significant provinces. The code chunk below shows each class separately for easier reference.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>lisa_sig[lisa_sig<span class="sc">$</span>mean <span class="sc">==</span> <span class="st">"Low-Low"</span>, <span class="fu">c</span>(<span class="st">"Province"</span>, <span class="st">"mean"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 7 features and 2 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 97.63083 ymin: 6.422716 xmax: 100.3366 ymax: 10.12626
Geodetic CRS:  WGS 84
# A tibble: 7 × 3
  Province            mean                                              geometry
  &lt;chr&gt;               &lt;fct&gt;                                   &lt;MULTIPOLYGON [°]&gt;
1 Nakhon Si Thammarat Low-Low (((99.77467 9.313729, 99.77478 9.313647, 99.77488…
2 Krabi               Low-Low (((99.11329 7.489274, 99.11337 7.489274, 99.11343…
3 Phang Nga           Low-Low (((98.61471 7.74431, 98.61461 7.74431, 98.61437 7…
4 Phuket              Low-Low (((98.31437 7.478515, 98.31425 7.478502, 98.31417…
5 Surat Thani         Low-Low (((99.96396 9.309907, 99.96376 9.30955, 99.96353 …
6 Satun               Low-Low (((100.0903 6.425736, 100.09 6.425543, 100.0896 6…
7 Trang               Low-Low (((99.47579 6.97262, 99.47565 6.972616, 99.47537 …</code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>lisa_sig[lisa_sig<span class="sc">$</span>mean <span class="sc">==</span> <span class="st">"High-High"</span>, <span class="fu">c</span>(<span class="st">"Province"</span>, <span class="st">"mean"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 2 features and 2 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 98.984 ymin: 14.94191 xmax: 101.3582 ymax: 19.63808
Geodetic CRS:  WGS 84
# A tibble: 2 × 3
  Province    mean                                                      geometry
  &lt;chr&gt;       &lt;fct&gt;                                           &lt;MULTIPOLYGON [°]&gt;
1 Nan         High-High (((100.8948 19.63432, 100.8952 19.63431, 100.8957 19.63…
2 Uthai Thani High-High (((99.13905 15.79655, 99.13918 15.79652, 99.13965 15.79…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>lisa_sig[lisa_sig<span class="sc">$</span>mean <span class="sc">==</span> <span class="st">"High-Low"</span>, <span class="fu">c</span>(<span class="st">"Province"</span>, <span class="st">"mean"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 0 features and 2 fields
Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
Geodetic CRS:  WGS 84
# A tibble: 0 × 3
# ℹ 3 variables: Province &lt;chr&gt;, mean &lt;fct&gt;, geometry &lt;GEOMETRY [°]&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>lisa_sig[lisa_sig<span class="sc">$</span>mean <span class="sc">==</span> <span class="st">"Low-High"</span>, <span class="fu">c</span>(<span class="st">"Province"</span>, <span class="st">"mean"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 0 features and 2 fields
Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
Geodetic CRS:  WGS 84
# A tibble: 0 × 3
# ℹ 3 variables: Province &lt;chr&gt;, mean &lt;fct&gt;, geometry &lt;GEOMETRY [°]&gt;</code></pre>
</div>
</div>
<p>We can summarize the findings from this analysis as:</p>
<ul>
<li><p>There is a cluster of 7 provinces at the south of Thailand that have slower recovery in terms of their average tourism revenue. This includes popular destinations like Phuket and Krabi and their neighboring provinces</p></li>
<li><p>There is a cluster of 3 provinces in the north that have faster recovery on the same metric. This includes Chiang Rai, Nan and Phayao</p></li>
<li><p>The analysis revealed two outliers. Chachoengsao has high recovery while neighboring provinces are low. Nakhon Ratchasima has low recovery while neighboring provinces are high</p></li>
</ul>
<p>reveal the following</p>
</section>
<section id="e.2-analysing-lisa-number-of-tourists-recovery-rate" class="level2">
<h2 class="anchored" data-anchor-id="e.2-analysing-lisa-number-of-tourists-recovery-rate">E.2 Analysing LISA: Number of tourists recovery rate</h2>
<p>We compute for the LISA using <code>local_moran()</code> function for the number of tourist recovery rate in the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>lisa <span class="ot">&lt;-</span> wm_thai <span class="sc">%&gt;%</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">local_moran =</span> <span class="fu">local_moran</span>(</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>    Tourists_total_recovery, nb, wt, <span class="at">nsim =</span> <span class="dv">99</span>),</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(local_moran)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will go straight to producing the LISA map based on the <code>lisa</code> object. Again, we use 0.05 to determine statistical significance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>lisa_sig <span class="ot">&lt;-</span> lisa <span class="sc">%&gt;%</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p_ii_sim <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(lisa) <span class="sc">+</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(lisa_sig) <span class="sc">+</span></span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"mean"</span>, <span class="at">title =</span> <span class="st">"LISA Class α=5% "</span>) <span class="sc">+</span></span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(<span class="st">"Province"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_layout</span>(</span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title =</span> <span class="st">"No of Tourist Recovery Rate"</span>,</span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>),</span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">bg.color =</span> <span class="st">"beige"</span>,</span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">asp =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: One tm layer group has duplicated layer types, which are omitted. To
draw multiple layers of the same type, use multiple layer groups (i.e. specify
tm_shape prior to each of them).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>To aid interpretation, we display results tabularly as before using the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>lisa_sig[lisa_sig<span class="sc">$</span>mean <span class="sc">==</span> <span class="st">"Low-Low"</span>, <span class="fu">c</span>(<span class="st">"Province"</span>, <span class="st">"mean"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 5 features and 2 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 97.63083 ymin: 7.467277 xmax: 100.3366 ymax: 10.12626
Geodetic CRS:  WGS 84
# A tibble: 5 × 3
  Province            mean                                              geometry
  &lt;chr&gt;               &lt;fct&gt;                                   &lt;MULTIPOLYGON [°]&gt;
1 Nakhon Si Thammarat Low-Low (((99.77467 9.313729, 99.77478 9.313647, 99.77488…
2 Krabi               Low-Low (((99.11329 7.489274, 99.11337 7.489274, 99.11343…
3 Phang Nga           Low-Low (((98.61471 7.74431, 98.61461 7.74431, 98.61437 7…
4 Phuket              Low-Low (((98.31437 7.478515, 98.31425 7.478502, 98.31417…
5 Surat Thani         Low-Low (((99.96396 9.309907, 99.96376 9.30955, 99.96353 …</code></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>lisa_sig[lisa_sig<span class="sc">$</span>mean <span class="sc">==</span> <span class="st">"High-High"</span>, <span class="fu">c</span>(<span class="st">"Province"</span>, <span class="st">"mean"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 0 features and 2 fields
Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
Geodetic CRS:  WGS 84
# A tibble: 0 × 3
# ℹ 3 variables: Province &lt;chr&gt;, mean &lt;fct&gt;, geometry &lt;GEOMETRY [°]&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>lisa_sig[lisa_sig<span class="sc">$</span>mean <span class="sc">==</span> <span class="st">"High-Low"</span>, <span class="fu">c</span>(<span class="st">"Province"</span>, <span class="st">"mean"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 2 features and 2 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 99.15364 ymin: 6.422716 xmax: 101.9901 ymax: 13.9767
Geodetic CRS:  WGS 84
# A tibble: 2 × 3
  Province     mean                                                     geometry
  &lt;chr&gt;        &lt;fct&gt;                                          &lt;MULTIPOLYGON [°]&gt;
1 Chachoengsao High-Low (((101.0612 13.97613, 101.0625 13.976, 101.0629 13.9760…
2 Satun        High-Low (((100.0903 6.425736, 100.09 6.425543, 100.0896 6.42572…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>lisa_sig[lisa_sig<span class="sc">$</span>mean <span class="sc">==</span> <span class="st">"Low-High"</span>, <span class="fu">c</span>(<span class="st">"Province"</span>, <span class="st">"mean"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 0 features and 2 fields
Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
Geodetic CRS:  WGS 84
# A tibble: 0 × 3
# ℹ 3 variables: Province &lt;chr&gt;, mean &lt;fct&gt;, geometry &lt;GEOMETRY [°]&gt;</code></pre>
</div>
</div>
<p>The findings can be summarized as:</p>
<ul>
<li><p>There is a cluster at the south of five provinces with slower recovery with regards to the number of tourists– including Phuket and Krabi (similar to previous metric)</p></li>
<li><p>Satun at the southern part has high recovery rate while its neighboring provinces are lower</p></li>
</ul>
</section>
<section id="e.3-analysing-lisa-pre-covid-average-spend" class="level2">
<h2 class="anchored" data-anchor-id="e.3-analysing-lisa-pre-covid-average-spend">E.3 Analysing LISA: Pre-Covid Average Spend</h2>
<p>We compute for the LISA using <code>local_moran()</code> function for the average tourist spending post-Covid in the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>lisa <span class="ot">&lt;-</span> wm_thai <span class="sc">%&gt;%</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">local_moran =</span> <span class="fu">local_moran</span>(</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>    PreCovidSpend_total, nb, wt, <span class="at">nsim =</span> <span class="dv">99</span>),</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(local_moran)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will now produce the LISA map based on the generated <code>lisa</code> object. Again, we use 0.05 to determine statistical significance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>lisa_sig <span class="ot">&lt;-</span> lisa <span class="sc">%&gt;%</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p_ii_sim <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(lisa) <span class="sc">+</span></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(lisa_sig) <span class="sc">+</span></span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"mean"</span>, <span class="at">title =</span> <span class="st">"LISA Class α=5% "</span>) <span class="sc">+</span></span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(<span class="st">"Province"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_layout</span>(</span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title =</span> <span class="st">"Pre-Covid Average Tourist Spend"</span>,</span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>),</span>
<span id="cb119-14"><a href="#cb119-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">bg.color =</span> <span class="st">"beige"</span>,</span>
<span id="cb119-15"><a href="#cb119-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">asp =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: One tm layer group has duplicated layer types, which are omitted. To
draw multiple layers of the same type, use multiple layer groups (i.e. specify
tm_shape prior to each of them).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We display the results tabularly using the code chunk below to make it easier to interpret.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>lisa_sig[lisa_sig<span class="sc">$</span>mean <span class="sc">==</span> <span class="st">"Low-Low"</span>, <span class="fu">c</span>(<span class="st">"Province"</span>, <span class="st">"mean"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 10 features and 2 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 99.08612 ymin: 14.06424 xmax: 105.637 ymax: 18.22037
Geodetic CRS:  WGS 84
# A tibble: 10 × 3
   Province         mean                                                geometry
   &lt;chr&gt;            &lt;fct&gt;                                     &lt;MULTIPOLYGON [°]&gt;
 1 Lopburi          Low-Low (((101.3453 15.75254, 101.3457 15.75224, 101.3466 1…
 2 Sing Buri        Low-Low (((100.3691 15.0894, 100.3697 15.0891, 100.3708 15.…
 3 Chainat          Low-Low (((100.1199 15.41243, 100.121 15.41234, 100.1229 15…
 4 Ubon Ratchathani Low-Low (((105.0633 16.09675, 105.0634 16.09671, 105.0638 1…
 5 Yasothon         Low-Low (((104.3952 16.34843, 104.3983 16.34707, 104.4 16.3…
 6 Khon Kaen        Low-Low (((102.7072 17.08713, 102.708 17.087, 102.7096 17.0…
 7 Loei             Low-Low (((102.095 18.21708, 102.0962 18.21675, 102.0971 18…
 8 Roi Et           Low-Low (((104.314 16.43758, 104.3135 16.43452, 104.3137 16…
 9 Nakhon Sawan     Low-Low (((100.0266 16.189, 100.0267 16.18889, 100.0268 16.…
10 Suphan Buri      Low-Low (((99.37118 15.05073, 99.37454 15.0495, 99.3762 15.…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>lisa_sig[lisa_sig<span class="sc">$</span>mean <span class="sc">==</span> <span class="st">"High-High"</span>, <span class="fu">c</span>(<span class="st">"Province"</span>, <span class="st">"mean"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 3 features and 2 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 97.63083 ymin: 7.467277 xmax: 99.41499 ymax: 9.478956
Geodetic CRS:  WGS 84
# A tibble: 3 × 3
  Province  mean                                                        geometry
  &lt;chr&gt;     &lt;fct&gt;                                             &lt;MULTIPOLYGON [°]&gt;
1 Krabi     High-High (((99.11329 7.489274, 99.11337 7.489274, 99.11343 7.48929…
2 Phang Nga High-High (((98.61471 7.74431, 98.61461 7.74431, 98.61437 7.744467,…
3 Phuket    High-High (((98.31437 7.478515, 98.31425 7.478502, 98.31417 7.47851…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>lisa_sig[lisa_sig<span class="sc">$</span>mean <span class="sc">==</span> <span class="st">"High-Low"</span>, <span class="fu">c</span>(<span class="st">"Province"</span>, <span class="st">"mean"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 0 features and 2 fields
Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
Geodetic CRS:  WGS 84
# A tibble: 0 × 3
# ℹ 3 variables: Province &lt;chr&gt;, mean &lt;fct&gt;, geometry &lt;GEOMETRY [°]&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>lisa_sig[lisa_sig<span class="sc">$</span>mean <span class="sc">==</span> <span class="st">"Low-High"</span>, <span class="fu">c</span>(<span class="st">"Province"</span>, <span class="st">"mean"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 0 features and 2 fields
Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
Geodetic CRS:  WGS 84
# A tibble: 0 × 3
# ℹ 3 variables: Province &lt;chr&gt;, mean &lt;fct&gt;, geometry &lt;GEOMETRY [°]&gt;</code></pre>
</div>
</div>
<p>The findings can be summarized as:</p>
<ul>
<li><p>There are multiple clusters, totaling 10 provinces, in the center of Thailand that have low average spending pre-Covid. These are composed of lesser known tourist destinations</p></li>
<li><p>Phuket and Phang Nga make up a two-province cluster with high average tourist spending</p></li>
<li><p>There are no outliers identified in the analysis</p></li>
</ul>
</section>
<section id="e.4-analysing-lisa-post-covid-average-spend" class="level2">
<h2 class="anchored" data-anchor-id="e.4-analysing-lisa-post-covid-average-spend">E.4 Analysing LISA: Post-Covid Average Spend</h2>
<p>We compute for the LISA using <code>local_moran()</code> function for the average tourist spending post-Covid in the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>lisa <span class="ot">&lt;-</span> wm_thai <span class="sc">%&gt;%</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">local_moran =</span> <span class="fu">local_moran</span>(</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>    PostCovidSpend_total, nb, wt, <span class="at">nsim =</span> <span class="dv">99</span>),</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(local_moran)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will now produce the LISA map based on the generated <code>lisa</code> object. Again, we use 0.05 to determine statistical significance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>lisa_sig <span class="ot">&lt;-</span> lisa <span class="sc">%&gt;%</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p_ii_sim <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(lisa) <span class="sc">+</span></span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(lisa_sig) <span class="sc">+</span></span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"mean"</span>, <span class="at">title =</span> <span class="st">"LISA Class α=5% "</span>) <span class="sc">+</span></span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(<span class="st">"Province"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_layout</span>(</span>
<span id="cb130-12"><a href="#cb130-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title =</span> <span class="st">"Post-Covid Average Tourist Spend"</span>,</span>
<span id="cb130-13"><a href="#cb130-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>),</span>
<span id="cb130-14"><a href="#cb130-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">bg.color =</span> <span class="st">"beige"</span>,</span>
<span id="cb130-15"><a href="#cb130-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">asp =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: One tm layer group has duplicated layer types, which are omitted. To
draw multiple layers of the same type, use multiple layer groups (i.e. specify
tm_shape prior to each of them).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We again display the results tabularly using the code chunk below to make it easier to interpret.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>lisa_sig[lisa_sig<span class="sc">$</span>mean <span class="sc">==</span> <span class="st">"Low-Low"</span>, <span class="fu">c</span>(<span class="st">"Province"</span>, <span class="st">"mean"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 7 features and 2 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 99.08612 ymin: 14.06424 xmax: 105.637 ymax: 18.22037
Geodetic CRS:  WGS 84
# A tibble: 7 × 3
  Province         mean                                                 geometry
  &lt;chr&gt;            &lt;fct&gt;                                      &lt;MULTIPOLYGON [°]&gt;
1 Sing Buri        Low-Low (((100.3691 15.0894, 100.3697 15.0891, 100.3708 15.0…
2 Ubon Ratchathani Low-Low (((105.0633 16.09675, 105.0634 16.09671, 105.0638 16…
3 Loei             Low-Low (((102.095 18.21708, 102.0962 18.21675, 102.0971 18.…
4 Roi Et           Low-Low (((104.314 16.43758, 104.3135 16.43452, 104.3137 16.…
5 Mukdahan         Low-Low (((104.2527 16.89302, 104.2527 16.89274, 104.2527 16…
6 Nakhon Sawan     Low-Low (((100.0266 16.189, 100.0267 16.18889, 100.0268 16.1…
7 Suphan Buri      Low-Low (((99.37118 15.05073, 99.37454 15.0495, 99.3762 15.0…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>lisa_sig[lisa_sig<span class="sc">$</span>mean <span class="sc">==</span> <span class="st">"High-High"</span>, <span class="fu">c</span>(<span class="st">"Province"</span>, <span class="st">"mean"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 3 features and 2 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 97.63083 ymin: 7.467277 xmax: 99.41499 ymax: 9.478956
Geodetic CRS:  WGS 84
# A tibble: 3 × 3
  Province  mean                                                        geometry
  &lt;chr&gt;     &lt;fct&gt;                                             &lt;MULTIPOLYGON [°]&gt;
1 Krabi     High-High (((99.11329 7.489274, 99.11337 7.489274, 99.11343 7.48929…
2 Phang Nga High-High (((98.61471 7.74431, 98.61461 7.74431, 98.61437 7.744467,…
3 Phuket    High-High (((98.31437 7.478515, 98.31425 7.478502, 98.31417 7.47851…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>lisa_sig[lisa_sig<span class="sc">$</span>mean <span class="sc">==</span> <span class="st">"High-Low"</span>, <span class="fu">c</span>(<span class="st">"Province"</span>, <span class="st">"mean"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 0 features and 2 fields
Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
Geodetic CRS:  WGS 84
# A tibble: 0 × 3
# ℹ 3 variables: Province &lt;chr&gt;, mean &lt;fct&gt;, geometry &lt;GEOMETRY [°]&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>lisa_sig[lisa_sig<span class="sc">$</span>mean <span class="sc">==</span> <span class="st">"Low-High"</span>, <span class="fu">c</span>(<span class="st">"Province"</span>, <span class="st">"mean"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 0 features and 2 fields
Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
Geodetic CRS:  WGS 84
# A tibble: 0 × 3
# ℹ 3 variables: Province &lt;chr&gt;, mean &lt;fct&gt;, geometry &lt;GEOMETRY [°]&gt;</code></pre>
</div>
</div>
<p>The results very closely resember the ones for Pre-Covid average spending. One significant change is that the high spend cluster at the south now includes Krabi. (so it now consists of three provinces)</p>
</section>
<section id="e.5-analysing-lisa-average-spend-recovery-rate" class="level2">
<h2 class="anchored" data-anchor-id="e.5-analysing-lisa-average-spend-recovery-rate">E.5 Analysing LISA: Average Spend Recovery Rate</h2>
<p>We compute for the LISA using <code>local_moran()</code> function for the average tourist spending recovery rate in the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>lisa <span class="ot">&lt;-</span> wm_thai <span class="sc">%&gt;%</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">local_moran =</span> <span class="fu">local_moran</span>(</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>    Spend_total_recovery, nb, wt, <span class="at">nsim =</span> <span class="dv">99</span>),</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(local_moran)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will now produce the LISA map based on the generated <code>lisa</code> object. Again, we use 0.05 to determine statistical significance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>lisa_sig <span class="ot">&lt;-</span> lisa <span class="sc">%&gt;%</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p_ii_sim <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(lisa) <span class="sc">+</span></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(lisa_sig) <span class="sc">+</span></span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"mean"</span>, <span class="at">title =</span> <span class="st">"LISA Class α=5% "</span>) <span class="sc">+</span></span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(<span class="st">"Province"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_layout</span>(</span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title =</span> <span class="st">"Average Tourist Spend Recovery Rate"</span>,</span>
<span id="cb141-13"><a href="#cb141-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>),</span>
<span id="cb141-14"><a href="#cb141-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">bg.color =</span> <span class="st">"beige"</span>,</span>
<span id="cb141-15"><a href="#cb141-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">asp =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: One tm layer group has duplicated layer types, which are omitted. To
draw multiple layers of the same type, use multiple layer groups (i.e. specify
tm_shape prior to each of them).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-70-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We again display the results tabularly using the code chunk below to make it easier to interpret.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>lisa_sig[lisa_sig<span class="sc">$</span>mean <span class="sc">==</span> <span class="st">"Low-Low"</span>, <span class="fu">c</span>(<span class="st">"Province"</span>, <span class="st">"mean"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 6 features and 2 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 98.32594 ymin: 5.613038 xmax: 101.7248 ymax: 10.78906
Geodetic CRS:  WGS 84
# A tibble: 6 × 3
  Province            mean                                              geometry
  &lt;chr&gt;               &lt;fct&gt;                                   &lt;MULTIPOLYGON [°]&gt;
1 Nakhon Si Thammarat Low-Low (((99.77467 9.313729, 99.77478 9.313647, 99.77488…
2 Surat Thani         Low-Low (((99.96396 9.309907, 99.96376 9.30955, 99.96353 …
3 Ranong              Low-Low (((98.35294 9.440758, 98.35316 9.440558, 98.3533 …
4 Trang               Low-Low (((99.47579 6.97262, 99.47565 6.972616, 99.47537 …
5 Pattani             Low-Low (((101.2827 6.952051, 101.2839 6.95182, 101.2848 …
6 Yala                Low-Low (((101.2927 6.681118, 101.2937 6.679529, 101.2939…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>lisa_sig[lisa_sig<span class="sc">$</span>mean <span class="sc">==</span> <span class="st">"High-High"</span>, <span class="fu">c</span>(<span class="st">"Province"</span>, <span class="st">"mean"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 2 features and 2 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 99.01629 ymin: 15.3183 xmax: 101.7972 ymax: 17.178
Geodetic CRS:  WGS 84
# A tibble: 2 × 3
  Province       mean                                                   geometry
  &lt;chr&gt;          &lt;fct&gt;                                        &lt;MULTIPOLYGON [°]&gt;
1 Kamphaeng Phet High-High (((99.48875 16.91044, 99.48883 16.91016, 99.48884 16…
2 Phetchabun     High-High (((101.3987 17.17792, 101.399 17.17781, 101.3993 17.…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>lisa_sig[lisa_sig<span class="sc">$</span>mean <span class="sc">==</span> <span class="st">"High-Low"</span>, <span class="fu">c</span>(<span class="st">"Province"</span>, <span class="st">"mean"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 1 feature and 2 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 98.25791 ymin: 7.478502 xmax: 98.48333 ymax: 8.200333
Geodetic CRS:  WGS 84
# A tibble: 1 × 3
  Province mean                                                         geometry
  &lt;chr&gt;    &lt;fct&gt;                                              &lt;MULTIPOLYGON [°]&gt;
1 Phuket   High-Low (((98.31437 7.478515, 98.31425 7.478502, 98.31417 7.478513,…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>lisa_sig[lisa_sig<span class="sc">$</span>mean <span class="sc">==</span> <span class="st">"Low-High"</span>, <span class="fu">c</span>(<span class="st">"Province"</span>, <span class="st">"mean"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 1 feature and 2 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 100.42 ymin: 14.64684 xmax: 101.4044 ymax: 15.75613
Geodetic CRS:  WGS 84
# A tibble: 1 × 3
  Province mean                                                         geometry
  &lt;chr&gt;    &lt;fct&gt;                                              &lt;MULTIPOLYGON [°]&gt;
1 Lopburi  Low-High (((101.3453 15.75254, 101.3457 15.75224, 101.3466 15.75236,…</code></pre>
</div>
</div>
<p>The findings can be summarized as:</p>
<ul>
<li><p>There are two clusters at the south, totaling 5 provinces, that have slow recovery. This includes the provinces Surat Thani, Nakhon Si Thammarat, Trang, Pattani and Yala</p></li>
<li><p>There is a cluster of three provinces at the center that have high recovery rate. This includes Kanpaeng Phet, Phichit and Phetchabun</p></li>
<li><p>Phuket is appearing as an outlier with high tourist spend recovery rate relative to its neighbors.</p></li>
</ul>
</section>
</section>
<section id="f.-emerging-hot-spot-analysis" class="level1">
<h1>F. Emerging Hot Spot Analysis</h1>
<p>Emerging hot-spot analysis or EHSA reveals and describes evolving hot (or cold) spots over time. We will perform this on the main variables (tourism revenue, number of tourists, occupancy) for the total tourist population and on the post-Covid period, as the ongoing period. In addition, we will limit to January 2022 onwards so we minimize the sharp increase coming from the tail end of 2021 as travel restrictions were lifted.</p>
<p>The analysis (for each variable) will consist of four steps:</p>
<ol type="1">
<li><p>Constructing the time series cube</p></li>
<li><p>Calculating the Getis-Ord local <span class="math inline">\(G_i^*\)</span> statistic for each bin with FDR correction</p></li>
<li><p>Evaluating hot and cold spot trends using Mann-Kendall trend test</p></li>
<li><p>Categorising each location by the resulting z-scores and p-valuesxx</p></li>
</ol>
<section id="f.1-ehsa---post-covid-tourism-revenue" class="level2">
<h2 class="anchored" data-anchor-id="f.1-ehsa---post-covid-tourism-revenue">F.1 EHSA - Post-covid tourism revenue</h2>
<p>We perform EHSA on the post-covid (2022 onwards) values for the total tourism revenue.</p>
<p>We create post-Covid versions of our datasets using the code chunk below so it is easier to refer to them later. We also include a column for the year and month as integers as EHSA requires discrete numeric values as a time variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>tourism_postCov <span class="ot">&lt;-</span> <span class="fu">subset</span>(tourism, Date <span class="sc">&gt;</span> <span class="fu">as.Date</span>(<span class="st">"2021-12-31"</span>))</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>tourism_postCov<span class="sc">$</span>YYYYMM <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">format</span>(tourism_postCov<span class="sc">$</span>Date, <span class="st">"%Y%m"</span>))</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>occupancy_postCov <span class="ot">&lt;-</span> <span class="fu">subset</span>(occupancy_df, Date <span class="sc">&gt;</span> <span class="fu">as.Date</span>(<span class="st">"2021-12-31"</span>))</span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>occupancy_postCov<span class="sc">$</span>YYYYMM <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">format</span>(occupancy_postCov<span class="sc">$</span>Date, <span class="st">"%Y%m"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="f.1.1-creating-spacetime-cube" class="level3">
<h3 class="anchored" data-anchor-id="f.1.1-creating-spacetime-cube">F.1.1 Creating spacetime cube</h3>
<p>We then create the space-time cube using <code>spacetime()</code> for just the post-covid tourism revenue. We use <code>filter()</code> to only select the rows for the measure of interest, and then <code>select()</code> to limit the original dataframe to only the date, province and variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>stcube <span class="ot">&lt;-</span> <span class="fu">spacetime</span>(<span class="fu">select</span>(<span class="fu">filter</span>(tourism_postCov, tourism_postCov<span class="sc">$</span>Indicator <span class="sc">==</span> <span class="st">"revenue_all"</span>),</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>                           YYYYMM, Province, Value),</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>                    thai_sf,</span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">.loc_col =</span> <span class="st">"Province"</span>,</span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">.time_col =</span> <span class="st">"YYYYMM"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To check that the object is in the correct format, we can use <code>is_spacetime_cube()</code> and confirm that it returns <code>TRUE</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is_spacetime_cube</span>(stcube)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</section>
<section id="f.1.2-calculating-g_i-statistics" class="level3">
<h3 class="anchored" data-anchor-id="f.1.2-calculating-g_i-statistics">F.1.2 Calculating <span class="math inline">\(G_i^*\)</span> statistics</h3>
<p>Before computing for the <span class="math inline">\(G_i^*\)</span> statistics, we need to derive the spatial weights. We use the code chunk below to identify the neighbors and to derive inverse distance weights. The <code>alpha</code> argument of <code>st_inverse_distance()</code> determines the level of distance decay.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>stcube_nb <span class="ot">&lt;-</span> stcube <span class="sc">%&gt;%</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(<span class="st">"geometry"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nb =</span> <span class="fu">include_self</span>(</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_contiguity</span>(geometry)),</span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">wt=</span><span class="fu">st_inverse_distance</span>(nb,</span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>                  geometry,</span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">scale =</span> <span class="dv">1</span>,</span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">alpha =</span> <span class="dv">1</span>),</span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_nbs</span>(<span class="st">"nb"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb155-11"><a href="#cb155-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_wts</span>(<span class="st">"wt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>! Polygon provided. Using point on surface.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There was 1 warning in `stopifnot()`.
ℹ In argument: `wt = st_inverse_distance(nb, geometry, scale = 1, alpha = 1)`.
Caused by warning in `st_point_on_surface.sfc()`:
! st_point_on_surface may not give correct results for longitude/latitude data</code></pre>
</div>
</div>
<p>We then use the following chunk to calculate the local <span class="math inline">\(G_i^*\)</span> for each location. We do this using <code>local_gstar_perm()</code> of <strong>sfdep</strong> package. We then use <code>unnest()</code> to unnest the <code>gi_star</code> column of the newly created data frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>gi_stars <span class="ot">&lt;-</span> stcube_nb <span class="sc">%&gt;%</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YYYYMM) <span class="sc">%&gt;%</span></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gi_star =</span> <span class="fu">local_gstar_perm</span>(</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>    Value, nb, wt)) <span class="sc">%&gt;%</span></span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unnest</span>(gi_star)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="f.1.3-identifying-hot--and-cold-spots-using-mann-kendall-test" class="level3">
<h3 class="anchored" data-anchor-id="f.1.3-identifying-hot--and-cold-spots-using-mann-kendall-test">F.1.3 Identifying Hot- and Cold-spots using Mann Kendall test</h3>
<p>The Mann Kendall test checks for signs of monotonicity for a the local <span class="math inline">\(G_i^*\)</span> statistic. Where the results are significant, the test infers that there are signs of monotonicity for that province / observation.</p>
<p>The code chunk below runs the Mann Kendall test (without permutations) on each province for the selected variable using <code>MannKendall()</code>. Provinces where the tau value is positive are showing an increasing trend, while negative tau values show decreasing trend.</p>
<p>We display the records with significant test results, and show negative and positive tau values as separate tables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>ehsa <span class="ot">&lt;-</span> gi_stars <span class="sc">%&gt;%</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Province) <span class="sc">%&gt;%</span></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mk =</span> <span class="fu">list</span>(</span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unclass</span>(</span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>      Kendall<span class="sc">::</span><span class="fu">MannKendall</span>(gi_star)))) <span class="sc">%&gt;%</span></span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unnest_wider</span>(mk)</span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(ehsa, sl <span class="sc">&lt;</span> <span class="fl">0.05</span>, tau <span class="sc">&gt;</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 33 × 6
   Province         tau         sl     S     D  varS
   &lt;chr&gt;          &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 Amnat Charoen  0.956 0.00000250    87  91.0  334.
 2 Bangkok        0.473 0.0215        43  91.0  334.
 3 Bueng Kan      0.626 0.00217       57  91.0  334.
 4 Buriram        0.758 0.000197      69  91.0  334.
 5 Chaiyaphum     0.780 0.000127      71  91.0  334.
 6 Chanthaburi    0.626 0.00217       57  91.0  334.
 7 Kalasin        0.802 0.0000809     73  91.0  334.
 8 Kamphaeng Phet 0.890 0.0000119     81  91.0  334.
 9 Lampang        0.626 0.00217       57  91.0  334.
10 Lamphun        0.956 0.00000250    87  91.0  334.
# ℹ 23 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(ehsa, sl <span class="sc">&lt;</span> <span class="fl">0.05</span>, tau <span class="sc">&lt;</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 21 × 6
   Province        tau        sl     S     D  varS
   &lt;chr&gt;         &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 Ang Thong    -0.582 0.00442     -53  91.0  334.
 2 Chachoengsao -0.802 0.0000809   -73  91.0  334.
 3 Chainat      -0.626 0.00217     -57  91.0  334.
 4 Chiang Rai   -0.429 0.0375      -39  91.0  334.
 5 Chumphon     -0.890 0.0000119   -81  91.0  334.
 6 Kanchanaburi -0.890 0.0000119   -81  91.0  334.
 7 Mae Hong Son -0.429 0.0375      -39  91.0  334.
 8 Mukdahan     -0.473 0.0215      -43  91.0  334.
 9 Phetchabun   -0.824 0.0000510   -75  91.0  334.
10 Phetchaburi  -0.802 0.0000809   -73  91.0  334.
# ℹ 11 more rows</code></pre>
</div>
</div>
<p>The results show that 33 of the 77 provinces are showing significant positive trend– which might be expected as provinces are recovering post-Covid. However, there are 21 provinces which are showing a significant negative trend which might be a concern if any of these are expected to be major tourist destinations.</p>
</section>
<section id="f.1.4-emerging-hot-spot-analysis" class="level3">
<h3 class="anchored" data-anchor-id="f.1.4-emerging-hot-spot-analysis">F.1.4 Emerging Hot Spot Analysis</h3>
<p>We can use <code>emerging_hot_spot_analysis()</code> to perform EHSA, including the previous hypothesis testing, and classify provinces based on the test results.</p>
<p>The code chunk below uses <code>emerging_hot_spot_analysis()</code> directly on the spacetime cube to run the test with 100 permutations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>ehsa <span class="ot">&lt;-</span> <span class="fu">emerging_hotspot_analysis</span>(</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> stcube,</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">.var =</span> <span class="st">"Value"</span>,</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">k =</span> <span class="dv">1</span>,</span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsim =</span> <span class="dv">99</span></span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can visualize the number of provinces per category using the code chunk below which utilizes <code>ggplot()</code> to build a bar chart.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ehsa,</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> classification)) <span class="sc">+</span></span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"EHSA Classification - PostCovid Tourism Revenue"</span>,</span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of Provinces"</span>, <span class="at">x=</span><span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">stat =</span> <span class="st">'count'</span>, <span class="fu">aes</span>(<span class="at">label =</span> ..count..), <span class="at">vjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb164-8"><a href="#cb164-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The dot-dot notation (`..count..`) was deprecated in ggplot2 3.4.0.
ℹ Please use `after_stat(count)` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-81-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can also visualize the hot- and coldspot classifications visually. First, we need to combine the <code>ehsa</code> object with the sf dataframe with the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>thai_ehsa <span class="ot">&lt;-</span> thai_sf <span class="sc">%&gt;%</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(ehsa,</span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">join_by</span>(Province <span class="sc">==</span> location))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we use tmap package to create a choropleth map based on the EHSA classification. We only include provinces that have significant test results and a pattern detected.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>ehsa_sig <span class="ot">&lt;-</span> <span class="fu">filter</span>(thai_ehsa, <span class="sc">!</span>(classification <span class="sc">==</span> <span class="st">"no pattern detected"</span>), p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>tmap mode set to plotting</code></pre>
</div>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(thai_ehsa) <span class="sc">+</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(ehsa_sig) <span class="sc">+</span></span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"classification"</span>, <span class="at">title =</span> <span class="st">"EHSA Classification"</span>) <span class="sc">+</span></span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(<span class="st">"Province"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb169-7"><a href="#cb169-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb169-8"><a href="#cb169-8" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_layout</span>(</span>
<span id="cb169-9"><a href="#cb169-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title =</span> <span class="st">"Post Covid Tourism Revenue"</span>,</span>
<span id="cb169-10"><a href="#cb169-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>),</span>
<span id="cb169-11"><a href="#cb169-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">bg.color =</span> <span class="st">"beige"</span>,</span>
<span id="cb169-12"><a href="#cb169-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">asp =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: One tm layer group has duplicated layer types, which are omitted. To
draw multiple layers of the same type, use multiple layer groups (i.e. specify
tm_shape prior to each of them).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-83-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can display the same provinces tabularly using the code chunk below</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">unique</span>(ehsa_sig<span class="sc">$</span>classification)){</span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">as.matrix</span>(ehsa_sig[ehsa_sig<span class="sc">$</span>classification <span class="sc">==</span> i, <span class="fu">c</span>(<span class="st">"Province"</span>, <span class="st">"classification"</span>)]))</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Province  classification         geometry                      
1 "Bangkok" "intensifying hotspot" MULTIPOLYGON (((100.6139 13...
   Province        classification        geometry                      
2  "Nonthaburi"    "consecutive hotspot" MULTIPOLYGON (((100.3415 14...
8  "Khon Kaen"     "consecutive hotspot" MULTIPOLYGON (((102.7072 17...
10 "Sakon Nakhon"  "consecutive hotspot" MULTIPOLYGON (((103.5404 18...
11 "Nakhon Phanom" "consecutive hotspot" MULTIPOLYGON (((104.192 18....
15 "Kanchanaburi"  "consecutive hotspot" MULTIPOLYGON (((98.58631 15...
   Province                   classification     
3  "Phra Nakhon Si Ayutthaya" "sporadic coldspot"
4  "Sing Buri"                "sporadic coldspot"
5  "Trat"                     "sporadic coldspot"
6  "Chachoengsao"             "sporadic coldspot"
7  "Buri Ram"                 "sporadic coldspot"
9  "Nong Khai"                "sporadic coldspot"
12 "Mukdahan"                 "sporadic coldspot"
13 "Lamphun"                  "sporadic coldspot"
14 "Lampang"                  "sporadic coldspot"
16 "Prachuap Khiri Khan"      "sporadic coldspot"
17 "Ranong"                   "sporadic coldspot"
18 "Phatthalung"              "sporadic coldspot"
19 "Pattani"                  "sporadic coldspot"
   geometry                      
3  MULTIPOLYGON (((100.5131 14...
4  MULTIPOLYGON (((100.3691 15...
5  MULTIPOLYGON (((102.5216 11...
6  MULTIPOLYGON (((101.0612 13...
7  MULTIPOLYGON (((102.9303 15...
9  MULTIPOLYGON (((103.2985 18...
12 MULTIPOLYGON (((104.2527 16...
13 MULTIPOLYGON (((99.18821 18...
14 MULTIPOLYGON (((99.58445 19...
16 MULTIPOLYGON (((99.56326 11...
17 MULTIPOLYGON (((98.35294 9....
18 MULTIPOLYGON (((99.96416 7....
19 MULTIPOLYGON (((101.2827 6....</code></pre>
</div>
</div>
<p>The results identifies Bangkok as an intensifying hotspot, and six others as consecutive hotspots.</p>
<p>There are 13 provinces identified as sporadic coldspots which are locations that are cold spots for less than 90% of the time, but never identified as significant hotspots.</p>
</section>
</section>
<section id="f.2-ehsa---post-covid-number-of-tourists" class="level2">
<h2 class="anchored" data-anchor-id="f.2-ehsa---post-covid-number-of-tourists">F.2 EHSA - Post-covid number of tourists</h2>
<p>We perform EHSA on the post-covid (2022 onwards) values for the total number of tourists.</p>
<section id="f.2.1-creating-spacetime-cube" class="level3">
<h3 class="anchored" data-anchor-id="f.2.1-creating-spacetime-cube">F.2.1 Creating spacetime cube</h3>
<p>We then create the space-time cube using <code>spacetime()</code> for just the post-covid number of tourists. We use <code>filter()</code> to only select the rows for the measure of interest, and then <code>select()</code> to limit the original dataframe to only the date, province and variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>stcube <span class="ot">&lt;-</span> <span class="fu">spacetime</span>(<span class="fu">select</span>(<span class="fu">filter</span>(tourism_postCov, tourism_postCov<span class="sc">$</span>Indicator <span class="sc">==</span> <span class="st">"no_tourist_all"</span>),</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>                           YYYYMM, Province, Value),</span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>                    thai_sf,</span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">.loc_col =</span> <span class="st">"Province"</span>,</span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">.time_col =</span> <span class="st">"YYYYMM"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To check that the object is in the correct format, we can use <code>is_spacetime_cube()</code> and confirm that it returns <code>TRUE</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is_spacetime_cube</span>(stcube)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</section>
<section id="f.2.2-calculating-g_i-statistics" class="level3">
<h3 class="anchored" data-anchor-id="f.2.2-calculating-g_i-statistics">F.2.2 Calculating <span class="math inline">\(G_i^*\)</span> statistics</h3>
<p>Before computing for the <span class="math inline">\(G_i^*\)</span> statistics, we need to derive the spatial weights. We use the code chunk below to identify the neighbors and to derive inverse distance weights. The <code>alpha</code> argument of <code>st_inverse_distance()</code> determines the level of distance decay.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>stcube_nb <span class="ot">&lt;-</span> stcube <span class="sc">%&gt;%</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(<span class="st">"geometry"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nb =</span> <span class="fu">include_self</span>(</span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_contiguity</span>(geometry)),</span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">wt=</span><span class="fu">st_inverse_distance</span>(nb,</span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a>                  geometry,</span>
<span id="cb176-7"><a href="#cb176-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">scale =</span> <span class="dv">1</span>,</span>
<span id="cb176-8"><a href="#cb176-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">alpha =</span> <span class="dv">1</span>),</span>
<span id="cb176-9"><a href="#cb176-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb176-10"><a href="#cb176-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_nbs</span>(<span class="st">"nb"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb176-11"><a href="#cb176-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_wts</span>(<span class="st">"wt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We then use the following chunk to calculate the local <span class="math inline">\(G_i^*\)</span> for each location. We do this using <code>local_gstar_perm()</code> of <strong>sfdep</strong> package. We then use <code>unnest()</code> to unnest the <code>gi_star</code> column of the newly created data frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>gi_stars <span class="ot">&lt;-</span> stcube_nb <span class="sc">%&gt;%</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YYYYMM) <span class="sc">%&gt;%</span></span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gi_star =</span> <span class="fu">local_gstar_perm</span>(</span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a>    Value, nb, wt)) <span class="sc">%&gt;%</span></span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unnest</span>(gi_star)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="f.2.3-identifying-hot--and-cold-spots-using-mann-kendall-test" class="level3">
<h3 class="anchored" data-anchor-id="f.2.3-identifying-hot--and-cold-spots-using-mann-kendall-test">F.2.3 Identifying Hot- and Cold-spots using Mann Kendall test</h3>
<p>The code chunk below runs the Mann Kendall test (without permutations) on each province using <code>MannKendall()</code>. Provinces where the tau value is positive are showing an increasing trend, while negative tau values show decreasing trend.</p>
<p>We display the records with significant test results, and show negative and positive tau values as separate tables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>ehsa <span class="ot">&lt;-</span> gi_stars <span class="sc">%&gt;%</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Province) <span class="sc">%&gt;%</span></span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mk =</span> <span class="fu">list</span>(</span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unclass</span>(</span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a>      Kendall<span class="sc">::</span><span class="fu">MannKendall</span>(gi_star)))) <span class="sc">%&gt;%</span></span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unnest_wider</span>(mk)</span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-8"><a href="#cb178-8" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(ehsa, sl <span class="sc">&lt;</span> <span class="fl">0.05</span>, tau <span class="sc">&gt;</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14 × 6
   Province                   tau        sl     S     D  varS
   &lt;chr&gt;                    &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 Bangkok                  0.648 0.00150      59  91.0  334.
 2 Krabi                    0.714 0.000459     65  91.0  334.
 3 Nakhon Si Thammarat      0.890 0.0000119    81  91.0  334.
 4 Nonthaburi               0.626 0.00217      57  91.0  334.
 5 Pattani                  0.648 0.00150      59  91.0  334.
 6 Phatthalung              0.780 0.000127     71  91.0  334.
 7 Phra Nakhon Si Ayutthaya 0.604 0.00311      55  91.0  334.
 8 Phuket                   0.670 0.00102      61  91.0  334.
 9 Prachuap Khiri Khan      0.648 0.00150      59  91.0  334.
10 Ratchaburi               0.429 0.0375       39  91.0  334.
11 Samut Prakan             0.473 0.0215       43  91.0  334.
12 Surat Thani              0.648 0.00150      59  91.0  334.
13 Tak                      0.692 0.000688     63  91.0  334.
14 Trang                    0.451 0.0285       41  91.0  334.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(ehsa, sl <span class="sc">&lt;</span> <span class="fl">0.05</span>, tau <span class="sc">&lt;</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 18 × 6
   Province            tau        sl     S     D  varS
   &lt;chr&gt;             &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 Chachoengsao     -0.758 0.000197    -69  91.0  334.
 2 Kanchanaburi     -0.692 0.000688    -63  91.0  334.
 3 Khon Kaen        -0.604 0.00311     -55  91.0  334.
 4 Loei             -0.516 0.0118      -47  91.0  334.
 5 Mukdahan         -0.648 0.00150     -59  91.0  334.
 6 Nakhon Nayok     -0.824 0.0000510   -75  91.0  334.
 7 Nakhon Pathom    -0.495 0.0160      -45  91.0  334.
 8 Nong Khai        -0.648 0.00150     -59  91.0  334.
 9 Phetchabun       -0.560 0.00620     -51  91.0  334.
10 Phetchaburi      -0.780 0.000127    -71  91.0  334.
11 Samut Sakhon     -0.802 0.0000809   -73  91.0  334.
12 Samut Songkhram  -0.780 0.000127    -71  91.0  334.
13 Sing Buri        -0.626 0.00217     -57  91.0  334.
14 Surin            -0.560 0.00620     -51  91.0  334.
15 Trat             -0.780 0.000127    -71  91.0  334.
16 Ubon Ratchathani -0.495 0.0160      -45  91.0  334.
17 Udon Thani       -0.407 0.0487      -37  91.0  334.
18 Yasothon         -0.758 0.000197    -69  91.0  334.</code></pre>
</div>
</div>
<p>The results show that 14 of the 77 provinces are showing significant positive trend. However, there are 18 provinces (more) which are showing a significant negative trend.</p>
</section>
<section id="f.2.4-emerging-hot-spot-analysis" class="level3">
<h3 class="anchored" data-anchor-id="f.2.4-emerging-hot-spot-analysis">F.2.4 Emerging Hot Spot Analysis</h3>
<p>We can use <code>emerging_hot_spot_analysis()</code> to perform EHSA, including the previous hypothesis testing, and classify provinces based on the test results.</p>
<p>The code chunk below uses <code>emerging_hot_spot_analysis()</code> directly on the spacetime cube to run the test with 100 permutations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>ehsa <span class="ot">&lt;-</span> <span class="fu">emerging_hotspot_analysis</span>(</span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> stcube,</span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">.var =</span> <span class="st">"Value"</span>,</span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">k =</span> <span class="dv">1</span>,</span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsim =</span> <span class="dv">99</span></span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can visualize the number of provinces per category using the code chunk below which utilizes <code>ggplot()</code> to build a bar chart.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ehsa,</span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> classification)) <span class="sc">+</span></span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"EHSA Classification - PostCovid Tourism Revenue"</span>,</span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of Provinces"</span>, <span class="at">x=</span><span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">stat =</span> <span class="st">'count'</span>, <span class="fu">aes</span>(<span class="at">label =</span> ..count..), <span class="at">vjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb183-8"><a href="#cb183-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-95-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can also visualize the hot- and coldspot classifications visually. First, we need to combine the <code>ehsa</code> object with the sf dataframe with the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>thai_ehsa <span class="ot">&lt;-</span> thai_sf <span class="sc">%&gt;%</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(ehsa,</span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">join_by</span>(Province <span class="sc">==</span> location))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we use tmap package to create a choropleth map based on the EHSA classification. We only include provinces that have significant test results and a pattern detected.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>ehsa_sig <span class="ot">&lt;-</span> <span class="fu">filter</span>(thai_ehsa, <span class="sc">!</span>(classification <span class="sc">==</span> <span class="st">"no pattern detected"</span>), p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>tmap mode set to plotting</code></pre>
</div>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(thai_ehsa) <span class="sc">+</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(ehsa_sig) <span class="sc">+</span></span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"classification"</span>, <span class="at">title =</span> <span class="st">"EHSA Classification"</span>) <span class="sc">+</span></span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(<span class="st">"Province"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb187-7"><a href="#cb187-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb187-8"><a href="#cb187-8" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_layout</span>(</span>
<span id="cb187-9"><a href="#cb187-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title =</span> <span class="st">"Post Covid Number of Tourists"</span>,</span>
<span id="cb187-10"><a href="#cb187-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>),</span>
<span id="cb187-11"><a href="#cb187-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">bg.color =</span> <span class="st">"beige"</span>,</span>
<span id="cb187-12"><a href="#cb187-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">asp =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: One tm layer group has duplicated layer types, which are omitted. To
draw multiple layers of the same type, use multiple layer groups (i.e. specify
tm_shape prior to each of them).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-97-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can display the same provinces tabularly using the code chunk below</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">unique</span>(ehsa_sig<span class="sc">$</span>classification)){</span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">as.matrix</span>(ehsa_sig[ehsa_sig<span class="sc">$</span>classification <span class="sc">==</span> i, <span class="fu">c</span>(<span class="st">"Province"</span>, <span class="st">"classification"</span>)]))</span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Province       classification     geometry                      
1 "Nonthaburi"   "sporadic hotspot" MULTIPOLYGON (((100.3415 14...
2 "Sakon Nakhon" "sporadic hotspot" MULTIPOLYGON (((103.5404 18...
  Province  classification      geometry                      
3 "Lamphun" "sporadic coldspot" MULTIPOLYGON (((99.18821 18...
6 "Ranong"  "sporadic coldspot" MULTIPOLYGON (((98.35294 9....
7 "Yala"    "sporadic coldspot" MULTIPOLYGON (((101.2927 6....
  Province       classification        geometry                      
4 "Nakhon Sawan" "consecutive hotspot" MULTIPOLYGON (((100.0266 16...
5 "Phuket"       "consecutive hotspot" MULTIPOLYGON (((98.31437 7....</code></pre>
</div>
</div>
<p>The results identifies Phuket and Nakhon Sawan as consecutive hotspots which means they had a single uninterrupted run of being significant hotspots, but have been significant hotspot for less than 90% of the time.</p>
<p>Nonthaburi and Sakon Nakhon are sporadic hotspots, while Lamphun, Ranong and Yala are sporadic coldspots which mean that they have been on-and-off as hot and coldspots for the number of tourists.</p>
</section>
</section>
<section id="f.3-ehsa---occupancy-rate" class="level2">
<h2 class="anchored" data-anchor-id="f.3-ehsa---occupancy-rate">F.3 EHSA - Occupancy Rate</h2>
<p>We perform EHSA on the post-covid (2022 onwards) values for the tourist occupancy rates.</p>
<section id="f.3.1-creating-spacetime-cube" class="level3">
<h3 class="anchored" data-anchor-id="f.3.1-creating-spacetime-cube">F.3.1 Creating spacetime cube</h3>
<p>We then create the space-time cube using <code>spacetime()</code> for just the occupancy rates. We use <code>select()</code> to limit the original dataframe to only the date, province and variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>stcube <span class="ot">&lt;-</span> <span class="fu">spacetime</span>(<span class="fu">select</span>(occupancy_postCov,</span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>                           YYYYMM, Province, occupancy),</span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>                    thai_sf,</span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">.loc_col =</span> <span class="st">"Province"</span>,</span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">.time_col =</span> <span class="st">"YYYYMM"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To check that the object is in the correct format, we can use <code>is_spacetime_cube()</code> and confirm that it returns <code>TRUE</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is_spacetime_cube</span>(stcube)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</section>
<section id="f.3.2-calculating-g_i-statistics" class="level3">
<h3 class="anchored" data-anchor-id="f.3.2-calculating-g_i-statistics">F.3.2 Calculating <span class="math inline">\(G_i^*\)</span> statistics</h3>
<p>Before computing for the <span class="math inline">\(G_i^*\)</span> statistics, we need to derive the spatial weights. We use the code chunk below to identify the neighbors and to derive inverse distance weights. The <code>alpha</code> argument of <code>st_inverse_distance()</code> determines the level of distance decay.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>stcube_nb <span class="ot">&lt;-</span> stcube <span class="sc">%&gt;%</span></span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(<span class="st">"geometry"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nb =</span> <span class="fu">include_self</span>(</span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_contiguity</span>(geometry)),</span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">wt=</span><span class="fu">st_inverse_distance</span>(nb,</span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true" tabindex="-1"></a>                  geometry,</span>
<span id="cb194-7"><a href="#cb194-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">scale =</span> <span class="dv">1</span>,</span>
<span id="cb194-8"><a href="#cb194-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">alpha =</span> <span class="dv">1</span>),</span>
<span id="cb194-9"><a href="#cb194-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb194-10"><a href="#cb194-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_nbs</span>(<span class="st">"nb"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb194-11"><a href="#cb194-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_wts</span>(<span class="st">"wt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We then use the following chunk to calculate the local <span class="math inline">\(G_i^*\)</span> for each location. We do this using <code>local_gstar_perm()</code> of <strong>sfdep</strong> package. We then use <code>unnest()</code> to unnest the <code>gi_star</code> column of the newly created data frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>gi_stars <span class="ot">&lt;-</span> stcube_nb <span class="sc">%&gt;%</span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YYYYMM) <span class="sc">%&gt;%</span></span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gi_star =</span> <span class="fu">local_gstar_perm</span>(</span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a>    occupancy, nb, wt)) <span class="sc">%&gt;%</span></span>
<span id="cb195-5"><a href="#cb195-5" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unnest</span>(gi_star)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="f.3.3-identifying-hot--and-cold-spots-using-mann-kendall-test" class="level3">
<h3 class="anchored" data-anchor-id="f.3.3-identifying-hot--and-cold-spots-using-mann-kendall-test">F.3.3 Identifying Hot- and Cold-spots using Mann Kendall test</h3>
<p>The code chunk below runs the Mann Kendall test (without permutations) on each province using <code>MannKendall()</code>. Provinces where the tau value is positive are showing an increasing trend, while negative tau values show decreasing trend.</p>
<p>We display the records with significant test results, and show negative and positive tau values as separate tables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>ehsa <span class="ot">&lt;-</span> gi_stars <span class="sc">%&gt;%</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Province) <span class="sc">%&gt;%</span></span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mk =</span> <span class="fu">list</span>(</span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unclass</span>(</span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a>      Kendall<span class="sc">::</span><span class="fu">MannKendall</span>(gi_star)))) <span class="sc">%&gt;%</span></span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unnest_wider</span>(mk)</span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-8"><a href="#cb196-8" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(ehsa, sl <span class="sc">&lt;</span> <span class="fl">0.05</span>, tau <span class="sc">&gt;</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 17 × 6
   Province              tau         sl     S     D  varS
   &lt;chr&gt;               &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 Bangkok             0.934 0.00000429    85  91.0  334.
 2 Buriram             0.604 0.00311       55  91.0  334.
 3 Chumphon            0.670 0.00102       61  91.0  334.
 4 Krabi               0.714 0.000459      65  91.0  334.
 5 Nakhon Si Thammarat 0.824 0.0000510     75  91.0  334.
 6 Narathiwat          0.626 0.00217       57  91.0  334.
 7 Nonthaburi          0.714 0.000459      65  91.0  334.
 8 Phatthalung         0.692 0.000688      63  91.0  334.
 9 Phuket              0.890 0.0000119     81  91.0  334.
10 Prachuap Khiri Khan 0.934 0.00000429    85  91.0  334.
11 Ranong              0.560 0.00620       51  91.0  334.
12 Ratchaburi          0.604 0.00311       55  91.0  334.
13 Rayong              0.626 0.00217       57  91.0  334.
14 Samut Prakan        0.736 0.000302      67  91.0  334.
15 Songkhla            0.648 0.00150       59  91.0  334.
16 Surat Thani         0.912 0.00000715    83  91.0  334.
17 Yala                0.495 0.0160        45  91.0  334.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(ehsa, sl <span class="sc">&lt;</span> <span class="fl">0.05</span>, tau <span class="sc">&lt;</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 23 × 6
   Province         tau       sl     S     D  varS
   &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 Amnat Charoen -0.780 0.000127   -71  91.0  334.
 2 Chachoengsao  -0.582 0.00442    -53  91.0  334.
 3 Chainat       -0.473 0.0215     -43  91.0  334.
 4 Chaiyaphum    -0.736 0.000302   -67  91.0  334.
 5 Chanthaburi   -0.429 0.0375     -39  91.0  334.
 6 Kanchanaburi  -0.582 0.00442    -53  91.0  334.
 7 Lopburi       -0.451 0.0285     -41  91.0  334.
 8 Nakhon Nayok  -0.604 0.00311    -55  91.0  334.
 9 Nakhon Pathom -0.648 0.00150    -59  91.0  334.
10 Nakhon Sawan  -0.451 0.0285     -41  91.0  334.
# ℹ 13 more rows</code></pre>
</div>
</div>
<p>The results show that 17 of the 77 provinces are showing significant positive trend. However, there are 23 provinces (more) which are showing a significant negative trend.</p>
</section>
<section id="f.3.4-emerging-hot-spot-analysis" class="level3">
<h3 class="anchored" data-anchor-id="f.3.4-emerging-hot-spot-analysis">F.3.4 Emerging Hot Spot Analysis</h3>
<p>We can use <code>emerging_hot_spot_analysis()</code> to perform EHSA, including the previous hypothesis testing, and classify provinces based on the test results.</p>
<p>The code chunk below uses <code>emerging_hot_spot_analysis()</code> directly on the spacetime cube to run the test with 100 permutations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>ehsa <span class="ot">&lt;-</span> <span class="fu">emerging_hotspot_analysis</span>(</span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> stcube,</span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">.var =</span> <span class="st">"occupancy"</span>,</span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">k =</span> <span class="dv">1</span>,</span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsim =</span> <span class="dv">99</span></span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can visualize the number of provinces per category using the code chunk below which utilizes <code>ggplot()</code> to build a bar chart.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ehsa,</span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> classification)) <span class="sc">+</span></span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"EHSA Classification - PostCovid Tourism Revenue"</span>,</span>
<span id="cb201-5"><a href="#cb201-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of Provinces"</span>, <span class="at">x=</span><span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb201-6"><a href="#cb201-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb201-7"><a href="#cb201-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">stat =</span> <span class="st">'count'</span>, <span class="fu">aes</span>(<span class="at">label =</span> ..count..), <span class="at">vjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb201-8"><a href="#cb201-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-109-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can also visualize the hot- and coldspot classifications visually. First, we need to combine the <code>ehsa</code> object with the sf dataframe with the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>thai_ehsa <span class="ot">&lt;-</span> thai_sf <span class="sc">%&gt;%</span></span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(ehsa,</span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">join_by</span>(Province <span class="sc">==</span> location))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we use tmap package to create a choropleth map based on the EHSA classification. We only include provinces that have significant test results and a pattern detected.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>ehsa_sig <span class="ot">&lt;-</span> <span class="fu">filter</span>(thai_ehsa, <span class="sc">!</span>(classification <span class="sc">==</span> <span class="st">"no pattern detected"</span>), p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>tmap mode set to plotting</code></pre>
</div>
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(thai_ehsa) <span class="sc">+</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(ehsa_sig) <span class="sc">+</span></span>
<span id="cb205-5"><a href="#cb205-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"classification"</span>, <span class="at">title =</span> <span class="st">"EHSA Classification"</span>) <span class="sc">+</span></span>
<span id="cb205-6"><a href="#cb205-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(<span class="st">"Province"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb205-7"><a href="#cb205-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb205-8"><a href="#cb205-8" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_layout</span>(</span>
<span id="cb205-9"><a href="#cb205-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title =</span> <span class="st">"Post Covid Tourist Occupancy Rate"</span>,</span>
<span id="cb205-10"><a href="#cb205-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>),</span>
<span id="cb205-11"><a href="#cb205-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">bg.color =</span> <span class="st">"beige"</span>,</span>
<span id="cb205-12"><a href="#cb205-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">asp =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: One tm layer group has duplicated layer types, which are omitted. To
draw multiple layers of the same type, use multiple layer groups (i.e. specify
tm_shape prior to each of them).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-111-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can display the same provinces tabularly using the code chunk below</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">unique</span>(ehsa_sig<span class="sc">$</span>classification)){</span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">as.matrix</span>(ehsa_sig[ehsa_sig<span class="sc">$</span>classification <span class="sc">==</span> i, <span class="fu">c</span>(<span class="st">"Province"</span>, <span class="st">"classification"</span>)]))</span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Province                   classification      
1  "Nonthaburi"               "oscilating hotspot"
2  "Phra Nakhon Si Ayutthaya" "oscilating hotspot"
5  "Chanthaburi"              "oscilating hotspot"
7  "Sa Kaeo"                  "oscilating hotspot"
8  "Loei"                     "oscilating hotspot"
9  "Maha Sarakham"            "oscilating hotspot"
11 "Sakon Nakhon"             "oscilating hotspot"
13 "Lamphun"                  "oscilating hotspot"
16 "Nakhon Sawan"             "oscilating hotspot"
18 "Kamphaeng Phet"           "oscilating hotspot"
19 "Tak"                      "oscilating hotspot"
20 "Sukhothai"                "oscilating hotspot"
21 "Kanchanaburi"             "oscilating hotspot"
25 "Nakhon Si Thammarat"      "oscilating hotspot"
26 "Phuket"                   "oscilating hotspot"
   geometry                      
1  MULTIPOLYGON (((100.3415 14...
2  MULTIPOLYGON (((100.5131 14...
5  MULTIPOLYGON (((102.2517 12...
7  MULTIPOLYGON (((102.1877 14...
8  MULTIPOLYGON (((102.095 18....
9  MULTIPOLYGON (((103.1562 16...
11 MULTIPOLYGON (((103.5404 18...
13 MULTIPOLYGON (((99.18821 18...
16 MULTIPOLYGON (((100.0266 16...
18 MULTIPOLYGON (((99.48875 16...
19 MULTIPOLYGON (((97.97318 17...
20 MULTIPOLYGON (((99.60051 17...
21 MULTIPOLYGON (((98.58631 15...
25 MULTIPOLYGON (((99.77467 9....
26 MULTIPOLYGON (((98.31437 7....
   Province          classification      geometry                      
3  "Sing Buri"       "sporadic coldspot" MULTIPOLYGON (((100.3691 15...
4  "Chai Nat"        "sporadic coldspot" MULTIPOLYGON (((100.1199 15...
10 "Roi Et"          "sporadic coldspot" MULTIPOLYGON (((104.314 16....
12 "Chiang Mai"      "sporadic coldspot" MULTIPOLYGON (((99.52512 20...
15 "Phrae"           "sporadic coldspot" MULTIPOLYGON (((100.1597 18...
17 "Uthai Thani"     "sporadic coldspot" MULTIPOLYGON (((99.13905 15...
23 "Samut Songkhram" "sporadic coldspot" MULTIPOLYGON (((100.0116 13...
27 "Surat Thani"     "sporadic coldspot" MULTIPOLYGON (((99.96396 9....
28 "Songkhla"        "sporadic coldspot" MULTIPOLYGON (((100.5973 7....
29 "Satun"           "sporadic coldspot" MULTIPOLYGON (((100.0903 6....
31 "Narathiwat"      "sporadic coldspot" MULTIPOLYGON (((101.6323 6....
   Province       classification         geometry                      
6  "Prachin Buri" "consecutive coldspot" MULTIPOLYGON (((101.4881 14...
24 "Phetchaburi"  "consecutive coldspot" MULTIPOLYGON (((99.75869 13...
   Province        classification        geometry                      
14 "Uttaradit"     "consecutive hotspot" MULTIPOLYGON (((101.0924 18...
22 "Nakhon Pathom" "consecutive hotspot" MULTIPOLYGON (((100.2231 14...
30 "Yala"          "consecutive hotspot" MULTIPOLYGON (((101.2927 6....</code></pre>
</div>
</div>
<p>The results identify a number of cold and hotspots. If we focus on the coldspots:</p>
<ul>
<li><p>we see that Prachin Buri and Phetchaburi are consecutive coldspots</p></li>
<li><p>A list of 11 provinces, including Chiang Mai, are sporadic coldspots</p></li>
</ul>
</section>
</section>
</section>
<section id="g.-conclusion" class="level1">
<h1>G. Conclusion</h1>
<p>We have conducted various analyses on the tourism indicators across provinces in Thailand. Among the results, policy makers may want to their attention on provinces that are performing worse than the rest of the country, or their neighbors, in terms of performance or recovery.</p>
<ul>
<li><p>A cluster in the Southern part of Thailand including Phuket and Krabi is exhibiting slower recovery across revenue, number of tourists, and consequently, the spend per tourist</p></li>
<li><p>A number of coldspots have been identified specifically for the post-Covid period, and key provinces for tourism among these here need to be identified (e.g., Chiang Mai is appearing as a sporadic coldspot for the occupancy rate)</p></li>
</ul>
<p>Further study is needed to understand if there are underlying factors that result to such provinces to be performing or recovering worse than others, and the types of interventions that will address such factors.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>